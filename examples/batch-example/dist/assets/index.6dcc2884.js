const Ru=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const f of a)if(f.type==="childList")for(const o of f.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const f={};return a.integrity&&(f.integrity=a.integrity),a.referrerpolicy&&(f.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?f.credentials="include":a.crossorigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function n(a){if(a.ep)return;a.ep=!0;const f=t(a);fetch(a.href,f)}};Ru();var us=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Lu(e){if(e.__esModule)return e;var r=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}),r}var vs={exports:{}};(function(e,r){(function(t,n){e.exports=n()})(us,function(){var t=function(i){return i instanceof Uint8Array||i instanceof Uint16Array||i instanceof Uint32Array||i instanceof Int8Array||i instanceof Int16Array||i instanceof Int32Array||i instanceof Float32Array||i instanceof Float64Array||i instanceof Uint8ClampedArray},n=function(i,d){for(var x=Object.keys(d),$=0;$<x.length;++$)i[x[$]]=d[x[$]];return i},a=`
`;function f(i){return typeof atob!="undefined"?atob(i):"base64:"+i}function o(i){var d=new Error("(regl) "+i);throw console.error(d),d}function c(i,d){i||o(d)}function l(i){return i?": "+i:""}function h(i,d,x){i in d||o("unknown parameter ("+i+")"+l(x)+". possible values: "+Object.keys(d).join())}function E(i,d){t(i)||o("invalid parameter type"+l(d)+". must be a typed array")}function O(i,d){switch(d){case"number":return typeof i=="number";case"object":return typeof i=="object";case"string":return typeof i=="string";case"boolean":return typeof i=="boolean";case"function":return typeof i=="function";case"undefined":return typeof i=="undefined";case"symbol":return typeof i=="symbol"}}function T(i,d,x){O(i,d)||o("invalid parameter type"+l(x)+". expected "+d+", got "+typeof i)}function w(i,d){i>=0&&(i|0)===i||o("invalid parameter type, ("+i+")"+l(d)+". must be a nonnegative integer")}function U(i,d,x){d.indexOf(i)<0&&o("invalid value"+l(x)+". must be one of: "+d)}var H=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function F(i){Object.keys(i).forEach(function(d){H.indexOf(d)<0&&o('invalid regl constructor argument "'+d+'". must be one of '+H)})}function re(i,d){for(i=i+"";i.length<d;)i=" "+i;return i}function Te(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Se(i,d){this.number=i,this.line=d,this.errors=[]}function Re(i,d,x){this.file=i,this.line=d,this.message=x}function Me(){var i=new Error,d=(i.stack||i).toString(),x=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(d);if(x)return x[1];var $=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(d);return $?$[1]:"unknown"}function Le(){var i=new Error,d=(i.stack||i).toString(),x=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(d);if(x)return x[1];var $=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(d);return $?$[1]:"unknown"}function Ke(i,d){var x=i.split(`
`),$=1,q=0,N={unknown:new Te,0:new Te};N.unknown.name=N[0].name=d||Me(),N.unknown.lines.push(new Se(0,""));for(var z=0;z<x.length;++z){var J=x[z],Z=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(J);if(Z)switch(Z[1]){case"line":var ie=/(\d+)(\s+\d+)?/.exec(Z[2]);ie&&($=ie[1]|0,ie[2]&&(q=ie[2]|0,q in N||(N[q]=new Te)));break;case"define":var se=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Z[2]);se&&(N[q].name=se[1]?f(se[2]):se[2]);break}N[q].lines.push(new Se($++,J))}return Object.keys(N).forEach(function(fe){var oe=N[fe];oe.lines.forEach(function(ee){oe.index[ee.number]=ee})}),N}function Ze(i){var d=[];return i.split(`
`).forEach(function(x){if(!(x.length<5)){var $=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(x);$?d.push(new Re($[1]|0,$[2]|0,$[3].trim())):x.length>0&&d.push(new Re("unknown",0,x))}}),d}function er(i,d){d.forEach(function(x){var $=i[x.file];if($){var q=$.index[x.line];if(q){q.errors.push(x),$.hasErrors=!0;return}}i.unknown.hasErrors=!0,i.unknown.lines[0].errors.push(x)})}function We(i,d,x,$,q){if(!i.getShaderParameter(d,i.COMPILE_STATUS)){var N=i.getShaderInfoLog(d),z=$===i.FRAGMENT_SHADER?"fragment":"vertex";Ar(x,"string",z+" shader source must be a string",q);var J=Ke(x,q),Z=Ze(N);er(J,Z),Object.keys(J).forEach(function(ie){var se=J[ie];if(!se.hasErrors)return;var fe=[""],oe=[""];function ee(ae,C){fe.push(ae),oe.push(C||"")}ee("file number "+ie+": "+se.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),se.lines.forEach(function(ae){if(ae.errors.length>0){ee(re(ae.number,4)+"|  ","background-color:yellow; font-weight:bold"),ee(ae.line+a,"color:red; background-color:yellow; font-weight:bold");var C=0;ae.errors.forEach(function(k){var ne=k.message,ye=/^\s*'(.*)'\s*:\s*(.*)$/.exec(ne);if(ye){var K=ye[1];switch(ne=ye[2],K){case"assign":K="=";break}C=Math.max(ae.line.indexOf(K,C),0)}else C=0;ee(re("| ",6)),ee(re("^^^",C+3)+a,"font-weight:bold"),ee(re("| ",6)),ee(ne+a,"font-weight:bold")}),ee(re("| ",6)+a)}else ee(re(ae.number,4)+"|  "),ee(ae.line+a,"color:red")}),typeof document!="undefined"&&!window.chrome?(oe[0]=fe.join("%c"),console.log.apply(console,oe)):console.log(fe.join(""))}),c.raise("Error compiling "+z+" shader, "+J[0].name)}}function tr(i,d,x,$,q){if(!i.getProgramParameter(d,i.LINK_STATUS)){var N=i.getProgramInfoLog(d),z=Ke(x,q),J=Ke($,q),Z='Error linking program with vertex shader, "'+J[0].name+'", and fragment shader "'+z[0].name+'"';typeof document!="undefined"?console.log("%c"+Z+a+"%c"+N,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Z+a+N),c.raise(Z)}}function Je(i){i._commandRef=Me()}function nr(i,d,x,$){Je(i);function q(Z){return Z?$.id(Z):0}i._fragId=q(i.static.frag),i._vertId=q(i.static.vert);function N(Z,ie){Object.keys(ie).forEach(function(se){Z[$.id(se)]=!0})}var z=i._uniformSet={};N(z,d.static),N(z,d.dynamic);var J=i._attributeSet={};N(J,x.static),N(J,x.dynamic),i._hasCount="count"in i.static||"count"in i.dynamic||"elements"in i.static||"elements"in i.dynamic}function Ie(i,d){var x=Le();o(i+" in command "+(d||Me())+(x==="unknown"?"":" called from "+x))}function Tr(i,d,x){i||Ie(d,x||Me())}function Gr(i,d,x,$){i in d||Ie("unknown parameter ("+i+")"+l(x)+". possible values: "+Object.keys(d).join(),$||Me())}function Ar(i,d,x,$){O(i,d)||Ie("invalid parameter type"+l(x)+". expected "+d+", got "+typeof i,$||Me())}function et(i){i()}function bt(i,d,x){i.texture?U(i.texture._texture.internalformat,d,"unsupported texture format for attachment"):U(i.renderbuffer._renderbuffer.format,x,"unsupported renderbuffer format for attachment")}var _t=33071,Et=9728,Br=9984,Kn=9985,Zn=9986,sn=9987,cn=5120,rt=5121,on=5122,Jn=5123,ea=5124,ra=5125,ln=5126,xt=32819,Tt=32820,Bt=33635,tt=34042,un=36193,gr={};gr[cn]=gr[rt]=1,gr[on]=gr[Jn]=gr[un]=gr[Bt]=gr[xt]=gr[Tt]=2,gr[ea]=gr[ra]=gr[ln]=gr[tt]=4;function vn(i,d){return i===Tt||i===xt||i===Bt?2:i===tt?4:gr[i]*d}function gt(i){return!(i&i-1)&&!!i}function v(i,d,x){var $,q=d.width,N=d.height,z=d.channels;c(q>0&&q<=x.maxTextureSize&&N>0&&N<=x.maxTextureSize,"invalid texture shape"),(i.wrapS!==_t||i.wrapT!==_t)&&c(gt(q)&&gt(N),"incompatible wrap mode for texture, both width and height must be power of 2"),d.mipmask===1?q!==1&&N!==1&&c(i.minFilter!==Br&&i.minFilter!==Zn&&i.minFilter!==Kn&&i.minFilter!==sn,"min filter requires mipmap"):(c(gt(q)&&gt(N),"texture must be a square power of 2 to support mipmapping"),c(d.mipmask===(q<<1)-1,"missing or incomplete mipmap data")),d.type===ln&&(x.extensions.indexOf("oes_texture_float_linear")<0&&c(i.minFilter===Et&&i.magFilter===Et,"filter not supported, must enable oes_texture_float_linear"),c(!i.genMipmaps,"mipmap generation not supported with float textures"));var J=d.images;for($=0;$<16;++$)if(J[$]){var Z=q>>$,ie=N>>$;c(d.mipmask&1<<$,"missing mipmap data");var se=J[$];if(c(se.width===Z&&se.height===ie,"invalid shape for mip images"),c(se.format===d.format&&se.internalformat===d.internalformat&&se.type===d.type,"incompatible type for mip image"),!se.compressed)if(se.data){var fe=Math.ceil(vn(se.type,z)*Z/se.unpackAlignment)*se.unpackAlignment;c(se.data.byteLength===fe*ie,"invalid data for image, buffer size is inconsistent with image format")}else se.element||se.copy}else i.genMipmaps||c((d.mipmask&1<<$)===0,"extra mipmap data");d.compressed&&c(!i.genMipmaps,"mipmap generation for compressed images not supported")}function g(i,d,x,$){var q=i.width,N=i.height,z=i.channels;c(q>0&&q<=$.maxTextureSize&&N>0&&N<=$.maxTextureSize,"invalid texture shape"),c(q===N,"cube map must be square"),c(d.wrapS===_t&&d.wrapT===_t,"wrap mode not supported by cube map");for(var J=0;J<x.length;++J){var Z=x[J];c(Z.width===q&&Z.height===N,"inconsistent cube map face shape"),d.genMipmaps&&(c(!Z.compressed,"can not generate mipmap for compressed textures"),c(Z.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var ie=Z.images,se=0;se<16;++se){var fe=ie[se];if(fe){var oe=q>>se,ee=N>>se;c(Z.mipmask&1<<se,"missing mipmap data"),c(fe.width===oe&&fe.height===ee,"invalid shape for mip images"),c(fe.format===i.format&&fe.internalformat===i.internalformat&&fe.type===i.type,"incompatible type for mip image"),fe.compressed||(fe.data?c(fe.data.byteLength===oe*ee*Math.max(vn(fe.type,z),fe.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):fe.element||fe.copy)}}}}var s=n(c,{optional:et,raise:o,commandRaise:Ie,command:Tr,parameter:h,commandParameter:Gr,constructor:F,type:T,commandType:Ar,isTypedArray:E,nni:w,oneOf:U,shaderError:We,linkError:tr,callSite:Le,saveCommandRef:Je,saveDrawInfo:nr,framebufferFormat:bt,guessCommand:Me,texture2D:v,textureCube:g}),Ee=0,ze=0,fr=5,Dr=6;function Sr(i,d){this.id=Ee++,this.type=i,this.data=d}function dn(i){return i.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function kt(i){if(i.length===0)return[];var d=i.charAt(0),x=i.charAt(i.length-1);if(i.length>1&&d===x&&(d==='"'||d==="'"))return['"'+dn(i.substr(1,i.length-2))+'"'];var $=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(i);if($)return kt(i.substr(0,$.index)).concat(kt($[1])).concat(kt(i.substr($.index+$[0].length)));var q=i.split(".");if(q.length===1)return['"'+dn(i)+'"'];for(var N=[],z=0;z<q.length;++z)N=N.concat(kt(q[z]));return N}function ui(i){return"["+kt(i).join("][")+"]"}function bc(i,d){return new Sr(i,ui(d+""))}function _c(i){return typeof i=="function"&&!i._reglType||i instanceof Sr}function vi(i,d){if(typeof i=="function")return new Sr(ze,i);if(typeof i=="number"||typeof i=="boolean")return new Sr(fr,i);if(Array.isArray(i))return new Sr(Dr,i.map(function(x,$){return vi(x,d+"["+$+"]")}));if(i instanceof Sr)return i;s(!1,"invalid option type in uniform "+d)}var Or={DynamicVariable:Sr,define:bc,isDynamic:_c,unbox:vi,accessor:ui},ta={next:typeof requestAnimationFrame=="function"?function(i){return requestAnimationFrame(i)}:function(i){return setTimeout(i,16)},cancel:typeof cancelAnimationFrame=="function"?function(i){return cancelAnimationFrame(i)}:clearTimeout},di=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Ec(){var i={"":0},d=[""];return{id:function(x){var $=i[x];return $||($=i[x]=d.length,d.push(x),$)},str:function(x){return d[x]}}}function xc(i,d,x){var $=document.createElement("canvas");n($.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),i.appendChild($),i===document.body&&($.style.position="absolute",n(i.style,{margin:0,padding:0}));function q(){var J=window.innerWidth,Z=window.innerHeight;if(i!==document.body){var ie=$.getBoundingClientRect();J=ie.right-ie.left,Z=ie.bottom-ie.top}$.width=x*J,$.height=x*Z}var N;i!==document.body&&typeof ResizeObserver=="function"?(N=new ResizeObserver(function(){setTimeout(q)}),N.observe(i)):window.addEventListener("resize",q,!1);function z(){N?N.disconnect():window.removeEventListener("resize",q),i.removeChild($)}return q(),{canvas:$,onDestroy:z}}function Tc(i,d){function x($){try{return i.getContext($,d)}catch{return null}}return x("webgl")||x("experimental-webgl")||x("webgl-experimental")}function gc(i){return typeof i.nodeName=="string"&&typeof i.appendChild=="function"&&typeof i.getBoundingClientRect=="function"}function Ac(i){return typeof i.drawArrays=="function"||typeof i.drawElements=="function"}function hi(i){return typeof i=="string"?i.split():(s(Array.isArray(i),"invalid extension array"),i)}function mi(i){return typeof i=="string"?(s(typeof document!="undefined","not supported outside of DOM"),document.querySelector(i)):i}function Sc(i){var d=i||{},x,$,q,N,z={},J=[],Z=[],ie=typeof window=="undefined"?1:window.devicePixelRatio,se=!1,fe=function(ae){ae&&s.raise(ae)},oe=function(){};if(typeof d=="string"?(s(typeof document!="undefined","selector queries only supported in DOM enviroments"),x=document.querySelector(d),s(x,"invalid query string for element")):typeof d=="object"?gc(d)?x=d:Ac(d)?(N=d,q=N.canvas):(s.constructor(d),"gl"in d?N=d.gl:"canvas"in d?q=mi(d.canvas):"container"in d&&($=mi(d.container)),"attributes"in d&&(z=d.attributes,s.type(z,"object","invalid context attributes")),"extensions"in d&&(J=hi(d.extensions)),"optionalExtensions"in d&&(Z=hi(d.optionalExtensions)),"onDone"in d&&(s.type(d.onDone,"function","invalid or missing onDone callback"),fe=d.onDone),"profile"in d&&(se=!!d.profile),"pixelRatio"in d&&(ie=+d.pixelRatio,s(ie>0,"invalid pixel ratio"))):s.raise("invalid arguments to regl"),x&&(x.nodeName.toLowerCase()==="canvas"?q=x:$=x),!N){if(!q){s(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var ee=xc($||document.body,fe,ie);if(!ee)return null;q=ee.canvas,oe=ee.onDestroy}z.premultipliedAlpha===void 0&&(z.premultipliedAlpha=!0),N=Tc(q,z)}return N?{gl:N,canvas:q,container:$,extensions:J,optionalExtensions:Z,pixelRatio:ie,profile:se,onDone:fe,onDestroy:oe}:(oe(),fe("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Mc(i,d){var x={};function $(z){s.type(z,"string","extension name must be string");var J=z.toLowerCase(),Z;try{Z=x[J]=i.getExtension(J)}catch{}return!!Z}for(var q=0;q<d.extensions.length;++q){var N=d.extensions[q];if(!$(N))return d.onDestroy(),d.onDone('"'+N+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return d.optionalExtensions.forEach($),{extensions:x,restore:function(){Object.keys(x).forEach(function(z){if(x[z]&&!$(z))throw new Error("(regl): error restoring extension "+z)})}}}function Rr(i,d){for(var x=Array(i),$=0;$<i;++$)x[$]=d($);return x}var wc=5120,Oc=5121,Rc=5122,Lc=5123,Cc=5124,Pc=5125,Fc=5126;function Gc(i){for(var d=16;d<=1<<28;d*=16)if(i<=d)return d;return 0}function pi(i){var d,x;return d=(i>65535)<<4,i>>>=d,x=(i>255)<<3,i>>>=x,d|=x,x=(i>15)<<2,i>>>=x,d|=x,x=(i>3)<<1,i>>>=x,d|=x,d|i>>1}function yi(){var i=Rr(8,function(){return[]});function d(N){var z=Gc(N),J=i[pi(z)>>2];return J.length>0?J.pop():new ArrayBuffer(z)}function x(N){i[pi(N.byteLength)>>2].push(N)}function $(N,z){var J=null;switch(N){case wc:J=new Int8Array(d(z),0,z);break;case Oc:J=new Uint8Array(d(z),0,z);break;case Rc:J=new Int16Array(d(2*z),0,z);break;case Lc:J=new Uint16Array(d(2*z),0,z);break;case Cc:J=new Int32Array(d(4*z),0,z);break;case Pc:J=new Uint32Array(d(4*z),0,z);break;case Fc:J=new Float32Array(d(4*z),0,z);break;default:return null}return J.length!==z?J.subarray(0,z):J}function q(N){x(N.buffer)}return{alloc:d,free:x,allocType:$,freeType:q}}var lr=yi();lr.zero=yi();var Dc=3408,Ic=3410,Nc=3411,$c=3412,Bc=3413,kc=3414,zc=3415,Uc=33901,jc=33902,Vc=3379,Xc=3386,qc=34921,Hc=36347,Yc=36348,Wc=35661,Qc=35660,Kc=34930,Zc=36349,Jc=34076,eo=34024,ro=7936,to=7937,no=7938,ao=35724,io=34047,fo=36063,so=34852,hn=3553,bi=34067,co=34069,oo=33984,zt=6408,na=5126,_i=5121,aa=36160,lo=36053,uo=36064,vo=16384,ho=function(i,d){var x=1;d.ext_texture_filter_anisotropic&&(x=i.getParameter(io));var $=1,q=1;d.webgl_draw_buffers&&($=i.getParameter(so),q=i.getParameter(fo));var N=!!d.oes_texture_float;if(N){var z=i.createTexture();i.bindTexture(hn,z),i.texImage2D(hn,0,zt,1,1,0,zt,na,null);var J=i.createFramebuffer();if(i.bindFramebuffer(aa,J),i.framebufferTexture2D(aa,uo,hn,z,0),i.bindTexture(hn,null),i.checkFramebufferStatus(aa)!==lo)N=!1;else{i.viewport(0,0,1,1),i.clearColor(1,0,0,1),i.clear(vo);var Z=lr.allocType(na,4);i.readPixels(0,0,1,1,zt,na,Z),i.getError()?N=!1:(i.deleteFramebuffer(J),i.deleteTexture(z),N=Z[0]===1),lr.freeType(Z)}}var ie=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),se=!0;if(!ie){var fe=i.createTexture(),oe=lr.allocType(_i,36);i.activeTexture(oo),i.bindTexture(bi,fe),i.texImage2D(co,0,zt,3,3,0,zt,_i,oe),lr.freeType(oe),i.bindTexture(bi,null),i.deleteTexture(fe),se=!i.getError()}return{colorBits:[i.getParameter(Ic),i.getParameter(Nc),i.getParameter($c),i.getParameter(Bc)],depthBits:i.getParameter(kc),stencilBits:i.getParameter(zc),subpixelBits:i.getParameter(Dc),extensions:Object.keys(d).filter(function(ee){return!!d[ee]}),maxAnisotropic:x,maxDrawbuffers:$,maxColorAttachments:q,pointSizeDims:i.getParameter(Uc),lineWidthDims:i.getParameter(jc),maxViewportDims:i.getParameter(Xc),maxCombinedTextureUnits:i.getParameter(Wc),maxCubeMapSize:i.getParameter(Jc),maxRenderbufferSize:i.getParameter(eo),maxTextureUnits:i.getParameter(Kc),maxTextureSize:i.getParameter(Vc),maxAttributes:i.getParameter(qc),maxVertexUniforms:i.getParameter(Hc),maxVertexTextureUnits:i.getParameter(Qc),maxVaryingVectors:i.getParameter(Yc),maxFragmentUniforms:i.getParameter(Zc),glsl:i.getParameter(ao),renderer:i.getParameter(to),vendor:i.getParameter(ro),version:i.getParameter(no),readFloat:N,npotTextureCube:se}};function Ir(i){return!!i&&typeof i=="object"&&Array.isArray(i.shape)&&Array.isArray(i.stride)&&typeof i.offset=="number"&&i.shape.length===i.stride.length&&(Array.isArray(i.data)||t(i.data))}var Lr=function(i){return Object.keys(i).map(function(d){return i[d]})},mn={shape:bo,flatten:yo};function mo(i,d,x){for(var $=0;$<d;++$)x[$]=i[$]}function po(i,d,x,$){for(var q=0,N=0;N<d;++N)for(var z=i[N],J=0;J<x;++J)$[q++]=z[J]}function Ei(i,d,x,$,q,N){for(var z=N,J=0;J<d;++J)for(var Z=i[J],ie=0;ie<x;++ie)for(var se=Z[ie],fe=0;fe<$;++fe)q[z++]=se[fe]}function xi(i,d,x,$,q){for(var N=1,z=x+1;z<d.length;++z)N*=d[z];var J=d[x];if(d.length-x===4){var Z=d[x+1],ie=d[x+2],se=d[x+3];for(z=0;z<J;++z)Ei(i[z],Z,ie,se,$,q),q+=N}else for(z=0;z<J;++z)xi(i[z],d,x+1,$,q),q+=N}function yo(i,d,x,$){var q=1;if(d.length)for(var N=0;N<d.length;++N)q*=d[N];else q=0;var z=$||lr.allocType(x,q);switch(d.length){case 0:break;case 1:mo(i,d[0],z);break;case 2:po(i,d[0],d[1],z);break;case 3:Ei(i,d[0],d[1],d[2],z,0);break;default:xi(i,d,0,z,0)}return z}function bo(i){for(var d=[],x=i;x.length;x=x[0])d.push(x.length);return d}var ia={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},_o=5120,Eo=5122,xo=5124,To=5121,go=5123,Ao=5125,So=5126,Mo=5126,nt={int8:_o,int16:Eo,int32:xo,uint8:To,uint16:go,uint32:Ao,float:So,float32:Mo},wo=35048,Oo=35040,pn={dynamic:wo,stream:Oo,static:35044},fa=mn.flatten,Ti=mn.shape,gi=35044,Ro=35040,sa=5121,ca=5126,Hr=[];Hr[5120]=1,Hr[5122]=2,Hr[5124]=4,Hr[5121]=1,Hr[5123]=2,Hr[5125]=4,Hr[5126]=4;function yn(i){return ia[Object.prototype.toString.call(i)]|0}function Ai(i,d){for(var x=0;x<d.length;++x)i[x]=d[x]}function Si(i,d,x,$,q,N,z){for(var J=0,Z=0;Z<x;++Z)for(var ie=0;ie<$;++ie)i[J++]=d[q*Z+N*ie+z]}function Lo(i,d,x,$){var q=0,N={};function z(C){this.id=q++,this.buffer=i.createBuffer(),this.type=C,this.usage=gi,this.byteLength=0,this.dimension=1,this.dtype=sa,this.persistentData=null,x.profile&&(this.stats={size:0})}z.prototype.bind=function(){i.bindBuffer(this.type,this.buffer)},z.prototype.destroy=function(){oe(this)};var J=[];function Z(C,k){var ne=J.pop();return ne||(ne=new z(C)),ne.bind(),fe(ne,k,Ro,0,1,!1),ne}function ie(C){J.push(C)}function se(C,k,ne){C.byteLength=k.byteLength,i.bufferData(C.type,k,ne)}function fe(C,k,ne,ye,K,me){var de;if(C.usage=ne,Array.isArray(k)){if(C.dtype=ye||ca,k.length>0){var Oe;if(Array.isArray(k[0])){de=Ti(k);for(var Y=1,X=1;X<de.length;++X)Y*=de[X];C.dimension=Y,Oe=fa(k,de,C.dtype),se(C,Oe,ne),me?C.persistentData=Oe:lr.freeType(Oe)}else if(typeof k[0]=="number"){C.dimension=K;var xe=lr.allocType(C.dtype,k.length);Ai(xe,k),se(C,xe,ne),me?C.persistentData=xe:lr.freeType(xe)}else t(k[0])?(C.dimension=k[0].length,C.dtype=ye||yn(k[0])||ca,Oe=fa(k,[k.length,k[0].length],C.dtype),se(C,Oe,ne),me?C.persistentData=Oe:lr.freeType(Oe)):s.raise("invalid buffer data")}}else if(t(k))C.dtype=ye||yn(k),C.dimension=K,se(C,k,ne),me&&(C.persistentData=new Uint8Array(new Uint8Array(k.buffer)));else if(Ir(k)){de=k.shape;var le=k.stride,te=k.offset,ue=0,ve=0,$e=0,Ne=0;de.length===1?(ue=de[0],ve=1,$e=le[0],Ne=0):de.length===2?(ue=de[0],ve=de[1],$e=le[0],Ne=le[1]):s.raise("invalid shape"),C.dtype=ye||yn(k.data)||ca,C.dimension=ve;var he=lr.allocType(C.dtype,ue*ve);Si(he,k.data,ue,ve,$e,Ne,te),se(C,he,ne),me?C.persistentData=he:lr.freeType(he)}else k instanceof ArrayBuffer?(C.dtype=sa,C.dimension=K,se(C,k,ne),me&&(C.persistentData=new Uint8Array(new Uint8Array(k)))):s.raise("invalid buffer data")}function oe(C){d.bufferCount--,$(C);var k=C.buffer;s(k,"buffer must not be deleted already"),i.deleteBuffer(k),C.buffer=null,delete N[C.id]}function ee(C,k,ne,ye){d.bufferCount++;var K=new z(k);N[K.id]=K;function me(Y){var X=gi,xe=null,le=0,te=0,ue=1;return Array.isArray(Y)||t(Y)||Ir(Y)||Y instanceof ArrayBuffer?xe=Y:typeof Y=="number"?le=Y|0:Y&&(s.type(Y,"object","buffer arguments must be an object, a number or an array"),"data"in Y&&(s(xe===null||Array.isArray(xe)||t(xe)||Ir(xe),"invalid data for buffer"),xe=Y.data),"usage"in Y&&(s.parameter(Y.usage,pn,"invalid buffer usage"),X=pn[Y.usage]),"type"in Y&&(s.parameter(Y.type,nt,"invalid buffer type"),te=nt[Y.type]),"dimension"in Y&&(s.type(Y.dimension,"number","invalid dimension"),ue=Y.dimension|0),"length"in Y&&(s.nni(le,"buffer length must be a nonnegative integer"),le=Y.length|0)),K.bind(),xe?fe(K,xe,X,te,ue,ye):(le&&i.bufferData(K.type,le,X),K.dtype=te||sa,K.usage=X,K.dimension=ue,K.byteLength=le),x.profile&&(K.stats.size=K.byteLength*Hr[K.dtype]),me}function de(Y,X){s(X+Y.byteLength<=K.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Y.byteLength+" starting from offset "+X+" to a buffer of size "+K.byteLength),i.bufferSubData(K.type,X,Y)}function Oe(Y,X){var xe=(X||0)|0,le;if(K.bind(),t(Y)||Y instanceof ArrayBuffer)de(Y,xe);else if(Array.isArray(Y)){if(Y.length>0)if(typeof Y[0]=="number"){var te=lr.allocType(K.dtype,Y.length);Ai(te,Y),de(te,xe),lr.freeType(te)}else if(Array.isArray(Y[0])||t(Y[0])){le=Ti(Y);var ue=fa(Y,le,K.dtype);de(ue,xe),lr.freeType(ue)}else s.raise("invalid buffer data")}else if(Ir(Y)){le=Y.shape;var ve=Y.stride,$e=0,Ne=0,he=0,pe=0;le.length===1?($e=le[0],Ne=1,he=ve[0],pe=0):le.length===2?($e=le[0],Ne=le[1],he=ve[0],pe=ve[1]):s.raise("invalid shape");var Fe=Array.isArray(Y.data)?K.dtype:yn(Y.data),Be=lr.allocType(Fe,$e*Ne);Si(Be,Y.data,$e,Ne,he,pe,Y.offset),de(Be,xe),lr.freeType(Be)}else s.raise("invalid data for buffer subdata");return me}return ne||me(C),me._reglType="buffer",me._buffer=K,me.subdata=Oe,x.profile&&(me.stats=K.stats),me.destroy=function(){oe(K)},me}function ae(){Lr(N).forEach(function(C){C.buffer=i.createBuffer(),i.bindBuffer(C.type,C.buffer),i.bufferData(C.type,C.persistentData||C.byteLength,C.usage)})}return x.profile&&(d.getTotalBufferSize=function(){var C=0;return Object.keys(N).forEach(function(k){C+=N[k].stats.size}),C}),{create:ee,createStream:Z,destroyStream:ie,clear:function(){Lr(N).forEach(oe),J.forEach(oe)},getBuffer:function(C){return C&&C._buffer instanceof z?C._buffer:null},restore:ae,_initBuffer:fe}}var Co=0,Po=0,Fo=1,Go=1,Do=4,Io=4,Yr={points:Co,point:Po,lines:Fo,line:Go,triangles:Do,triangle:Io,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},No=0,$o=1,Ut=4,Bo=5120,At=5121,Mi=5122,St=5123,wi=5124,at=5125,oa=34963,ko=35040,zo=35044;function Uo(i,d,x,$){var q={},N=0,z={uint8:At,uint16:St};d.oes_element_index_uint&&(z.uint32=at);function J(ae){this.id=N++,q[this.id]=this,this.buffer=ae,this.primType=Ut,this.vertCount=0,this.type=0}J.prototype.bind=function(){this.buffer.bind()};var Z=[];function ie(ae){var C=Z.pop();return C||(C=new J(x.create(null,oa,!0,!1)._buffer)),fe(C,ae,ko,-1,-1,0,0),C}function se(ae){Z.push(ae)}function fe(ae,C,k,ne,ye,K,me){ae.buffer.bind();var de;if(C){var Oe=me;!me&&(!t(C)||Ir(C)&&!t(C.data))&&(Oe=d.oes_element_index_uint?at:St),x._initBuffer(ae.buffer,C,k,Oe,3)}else i.bufferData(oa,K,k),ae.buffer.dtype=de||At,ae.buffer.usage=k,ae.buffer.dimension=3,ae.buffer.byteLength=K;if(de=me,!me){switch(ae.buffer.dtype){case At:case Bo:de=At;break;case St:case Mi:de=St;break;case at:case wi:de=at;break;default:s.raise("unsupported type for element array")}ae.buffer.dtype=de}ae.type=de,s(de!==at||!!d.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Y=ye;Y<0&&(Y=ae.buffer.byteLength,de===St?Y>>=1:de===at&&(Y>>=2)),ae.vertCount=Y;var X=ne;if(ne<0){X=Ut;var xe=ae.buffer.dimension;xe===1&&(X=No),xe===2&&(X=$o),xe===3&&(X=Ut)}ae.primType=X}function oe(ae){$.elementsCount--,s(ae.buffer!==null,"must not double destroy elements"),delete q[ae.id],ae.buffer.destroy(),ae.buffer=null}function ee(ae,C){var k=x.create(null,oa,!0),ne=new J(k._buffer);$.elementsCount++;function ye(K){if(!K)k(),ne.primType=Ut,ne.vertCount=0,ne.type=At;else if(typeof K=="number")k(K),ne.primType=Ut,ne.vertCount=K|0,ne.type=At;else{var me=null,de=zo,Oe=-1,Y=-1,X=0,xe=0;Array.isArray(K)||t(K)||Ir(K)?me=K:(s.type(K,"object","invalid arguments for elements"),"data"in K&&(me=K.data,s(Array.isArray(me)||t(me)||Ir(me),"invalid data for element buffer")),"usage"in K&&(s.parameter(K.usage,pn,"invalid element buffer usage"),de=pn[K.usage]),"primitive"in K&&(s.parameter(K.primitive,Yr,"invalid element buffer primitive"),Oe=Yr[K.primitive]),"count"in K&&(s(typeof K.count=="number"&&K.count>=0,"invalid vertex count for elements"),Y=K.count|0),"type"in K&&(s.parameter(K.type,z,"invalid buffer type"),xe=z[K.type]),"length"in K?X=K.length|0:(X=Y,xe===St||xe===Mi?X*=2:(xe===at||xe===wi)&&(X*=4))),fe(ne,me,de,Oe,Y,X,xe)}return ye}return ye(ae),ye._reglType="elements",ye._elements=ne,ye.subdata=function(K,me){return k.subdata(K,me),ye},ye.destroy=function(){oe(ne)},ye}return{create:ee,createStream:ie,destroyStream:se,getElements:function(ae){return typeof ae=="function"&&ae._elements instanceof J?ae._elements:null},clear:function(){Lr(q).forEach(oe)}}}var Oi=new Float32Array(1),jo=new Uint32Array(Oi.buffer),Vo=5123;function Ri(i){for(var d=lr.allocType(Vo,i.length),x=0;x<i.length;++x)if(isNaN(i[x]))d[x]=65535;else if(i[x]===1/0)d[x]=31744;else if(i[x]===-1/0)d[x]=64512;else{Oi[0]=i[x];var $=jo[0],q=$>>>31<<15,N=($<<1>>>24)-127,z=$>>13&(1<<10)-1;if(N<-24)d[x]=q;else if(N<-14){var J=-14-N;d[x]=q+(z+(1<<10)>>J)}else N>15?d[x]=q+31744:d[x]=q+(N+15<<10)+z}return d}function ar(i){return Array.isArray(i)||t(i)}var Li=function(i){return!(i&i-1)&&!!i},Xo=34467,kr=3553,la=34067,bn=34069,it=6408,ua=6406,_n=6407,jt=6409,En=6410,Ci=32854,va=32855,Pi=36194,qo=32819,Ho=32820,Yo=33635,Wo=34042,da=6402,xn=34041,ha=35904,ma=35906,Mt=36193,pa=33776,ya=33777,ba=33778,_a=33779,Fi=35986,Gi=35987,Di=34798,Ii=35840,Ni=35841,$i=35842,Bi=35843,ki=36196,wt=5121,Ea=5123,xa=5125,Vt=5126,Qo=10242,Ko=10243,Zo=10497,Ta=33071,Jo=33648,el=10240,rl=10241,ga=9728,tl=9729,Aa=9984,zi=9985,Ui=9986,Sa=9987,nl=33170,Tn=4352,al=4353,il=4354,fl=34046,sl=3317,cl=37440,ol=37441,ll=37443,ji=37444,Xt=33984,ul=[Aa,Ui,zi,Sa],gn=[0,jt,En,_n,it],Pr={};Pr[jt]=Pr[ua]=Pr[da]=1,Pr[xn]=Pr[En]=2,Pr[_n]=Pr[ha]=3,Pr[it]=Pr[ma]=4;function Ot(i){return"[object "+i+"]"}var Vi=Ot("HTMLCanvasElement"),Xi=Ot("OffscreenCanvas"),qi=Ot("CanvasRenderingContext2D"),Hi=Ot("ImageBitmap"),Yi=Ot("HTMLImageElement"),Wi=Ot("HTMLVideoElement"),vl=Object.keys(ia).concat([Vi,Xi,qi,Hi,Yi,Wi]),Rt=[];Rt[wt]=1,Rt[Vt]=4,Rt[Mt]=2,Rt[Ea]=2,Rt[xa]=4;var br=[];br[Ci]=2,br[va]=2,br[Pi]=2,br[xn]=4,br[pa]=.5,br[ya]=.5,br[ba]=1,br[_a]=1,br[Fi]=.5,br[Gi]=1,br[Di]=1,br[Ii]=.5,br[Ni]=.25,br[$i]=.5,br[Bi]=.25,br[ki]=.5;function Qi(i){return Array.isArray(i)&&(i.length===0||typeof i[0]=="number")}function Ki(i){if(!Array.isArray(i))return!1;var d=i.length;return!(d===0||!ar(i[0]))}function ft(i){return Object.prototype.toString.call(i)}function Zi(i){return ft(i)===Vi}function Ji(i){return ft(i)===Xi}function dl(i){return ft(i)===qi}function hl(i){return ft(i)===Hi}function ml(i){return ft(i)===Yi}function pl(i){return ft(i)===Wi}function Ma(i){if(!i)return!1;var d=ft(i);return vl.indexOf(d)>=0?!0:Qi(i)||Ki(i)||Ir(i)}function ef(i){return ia[Object.prototype.toString.call(i)]|0}function yl(i,d){var x=d.length;switch(i.type){case wt:case Ea:case xa:case Vt:var $=lr.allocType(i.type,x);$.set(d),i.data=$;break;case Mt:i.data=Ri(d);break;default:s.raise("unsupported texture type, must specify a typed array")}}function rf(i,d){return lr.allocType(i.type===Mt?Vt:i.type,d)}function tf(i,d){i.type===Mt?(i.data=Ri(d),lr.freeType(d)):i.data=d}function bl(i,d,x,$,q,N){for(var z=i.width,J=i.height,Z=i.channels,ie=z*J*Z,se=rf(i,ie),fe=0,oe=0;oe<J;++oe)for(var ee=0;ee<z;++ee)for(var ae=0;ae<Z;++ae)se[fe++]=d[x*ee+$*oe+q*ae+N];tf(i,se)}function An(i,d,x,$,q,N){var z;if(typeof br[i]!="undefined"?z=br[i]:z=Pr[i]*Rt[d],N&&(z*=6),q){for(var J=0,Z=x;Z>=1;)J+=z*Z*Z,Z/=2;return J}else return z*x*$}function _l(i,d,x,$,q,N,z){var J={"don't care":Tn,"dont care":Tn,nice:il,fast:al},Z={repeat:Zo,clamp:Ta,mirror:Jo},ie={nearest:ga,linear:tl},se=n({mipmap:Sa,"nearest mipmap nearest":Aa,"linear mipmap nearest":zi,"nearest mipmap linear":Ui,"linear mipmap linear":Sa},ie),fe={none:0,browser:ji},oe={uint8:wt,rgba4:qo,rgb565:Yo,"rgb5 a1":Ho},ee={alpha:ua,luminance:jt,"luminance alpha":En,rgb:_n,rgba:it,rgba4:Ci,"rgb5 a1":va,rgb565:Pi},ae={};d.ext_srgb&&(ee.srgb=ha,ee.srgba=ma),d.oes_texture_float&&(oe.float32=oe.float=Vt),d.oes_texture_half_float&&(oe.float16=oe["half float"]=Mt),d.webgl_depth_texture&&(n(ee,{depth:da,"depth stencil":xn}),n(oe,{uint16:Ea,uint32:xa,"depth stencil":Wo})),d.webgl_compressed_texture_s3tc&&n(ae,{"rgb s3tc dxt1":pa,"rgba s3tc dxt1":ya,"rgba s3tc dxt3":ba,"rgba s3tc dxt5":_a}),d.webgl_compressed_texture_atc&&n(ae,{"rgb atc":Fi,"rgba atc explicit alpha":Gi,"rgba atc interpolated alpha":Di}),d.webgl_compressed_texture_pvrtc&&n(ae,{"rgb pvrtc 4bppv1":Ii,"rgb pvrtc 2bppv1":Ni,"rgba pvrtc 4bppv1":$i,"rgba pvrtc 2bppv1":Bi}),d.webgl_compressed_texture_etc1&&(ae["rgb etc1"]=ki);var C=Array.prototype.slice.call(i.getParameter(Xo));Object.keys(ae).forEach(function(b){var B=ae[b];C.indexOf(B)>=0&&(ee[b]=B)});var k=Object.keys(ee);x.textureFormats=k;var ne=[];Object.keys(ee).forEach(function(b){var B=ee[b];ne[B]=b});var ye=[];Object.keys(oe).forEach(function(b){var B=oe[b];ye[B]=b});var K=[];Object.keys(ie).forEach(function(b){var B=ie[b];K[B]=b});var me=[];Object.keys(se).forEach(function(b){var B=se[b];me[B]=b});var de=[];Object.keys(Z).forEach(function(b){var B=Z[b];de[B]=b});var Oe=k.reduce(function(b,B){var I=ee[B];return I===jt||I===ua||I===jt||I===En||I===da||I===xn||d.ext_srgb&&(I===ha||I===ma)?b[I]=I:I===va||B.indexOf("rgba")>=0?b[I]=it:b[I]=_n,b},{});function Y(){this.internalformat=it,this.format=it,this.type=wt,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=ji,this.width=0,this.height=0,this.channels=0}function X(b,B){b.internalformat=B.internalformat,b.format=B.format,b.type=B.type,b.compressed=B.compressed,b.premultiplyAlpha=B.premultiplyAlpha,b.flipY=B.flipY,b.unpackAlignment=B.unpackAlignment,b.colorSpace=B.colorSpace,b.width=B.width,b.height=B.height,b.channels=B.channels}function xe(b,B){if(!(typeof B!="object"||!B)){if("premultiplyAlpha"in B&&(s.type(B.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),b.premultiplyAlpha=B.premultiplyAlpha),"flipY"in B&&(s.type(B.flipY,"boolean","invalid texture flip"),b.flipY=B.flipY),"alignment"in B&&(s.oneOf(B.alignment,[1,2,4,8],"invalid texture unpack alignment"),b.unpackAlignment=B.alignment),"colorSpace"in B&&(s.parameter(B.colorSpace,fe,"invalid colorSpace"),b.colorSpace=fe[B.colorSpace]),"type"in B){var I=B.type;s(d.oes_texture_float||!(I==="float"||I==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),s(d.oes_texture_half_float||!(I==="half float"||I==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),s(d.webgl_depth_texture||!(I==="uint16"||I==="uint32"||I==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),s.parameter(I,oe,"invalid texture type"),b.type=oe[I]}var _e=b.width,Ue=b.height,m=b.channels,u=!1;"shape"in B?(s(Array.isArray(B.shape)&&B.shape.length>=2,"shape must be an array"),_e=B.shape[0],Ue=B.shape[1],B.shape.length===3&&(m=B.shape[2],s(m>0&&m<=4,"invalid number of channels"),u=!0),s(_e>=0&&_e<=x.maxTextureSize,"invalid width"),s(Ue>=0&&Ue<=x.maxTextureSize,"invalid height")):("radius"in B&&(_e=Ue=B.radius,s(_e>=0&&_e<=x.maxTextureSize,"invalid radius")),"width"in B&&(_e=B.width,s(_e>=0&&_e<=x.maxTextureSize,"invalid width")),"height"in B&&(Ue=B.height,s(Ue>=0&&Ue<=x.maxTextureSize,"invalid height")),"channels"in B&&(m=B.channels,s(m>0&&m<=4,"invalid number of channels"),u=!0)),b.width=_e|0,b.height=Ue|0,b.channels=m|0;var A=!1;if("format"in B){var L=B.format;s(d.webgl_depth_texture||!(L==="depth"||L==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),s.parameter(L,ee,"invalid texture format");var P=b.internalformat=ee[L];b.format=Oe[P],L in oe&&("type"in B||(b.type=oe[L])),L in ae&&(b.compressed=!0),A=!0}!u&&A?b.channels=Pr[b.format]:u&&!A?b.channels!==gn[b.format]&&(b.format=b.internalformat=gn[b.channels]):A&&u&&s(b.channels===Pr[b.format],"number of channels inconsistent with specified format")}}function le(b){i.pixelStorei(cl,b.flipY),i.pixelStorei(ol,b.premultiplyAlpha),i.pixelStorei(ll,b.colorSpace),i.pixelStorei(sl,b.unpackAlignment)}function te(){Y.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function ue(b,B){var I=null;if(Ma(B)?I=B:B&&(s.type(B,"object","invalid pixel data type"),xe(b,B),"x"in B&&(b.xOffset=B.x|0),"y"in B&&(b.yOffset=B.y|0),Ma(B.data)&&(I=B.data)),s(!b.compressed||I instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),B.copy){s(!I,"can not specify copy and data field for the same texture");var _e=q.viewportWidth,Ue=q.viewportHeight;b.width=b.width||_e-b.xOffset,b.height=b.height||Ue-b.yOffset,b.needsCopy=!0,s(b.xOffset>=0&&b.xOffset<_e&&b.yOffset>=0&&b.yOffset<Ue&&b.width>0&&b.width<=_e&&b.height>0&&b.height<=Ue,"copy texture read out of bounds")}else if(!I)b.width=b.width||1,b.height=b.height||1,b.channels=b.channels||4;else if(t(I))b.channels=b.channels||4,b.data=I,!("type"in B)&&b.type===wt&&(b.type=ef(I));else if(Qi(I))b.channels=b.channels||4,yl(b,I),b.alignment=1,b.needsFree=!0;else if(Ir(I)){var m=I.data;!Array.isArray(m)&&b.type===wt&&(b.type=ef(m));var u=I.shape,A=I.stride,L,P,M,S,R,p;u.length===3?(M=u[2],p=A[2]):(s(u.length===2,"invalid ndarray pixel data, must be 2 or 3D"),M=1,p=1),L=u[0],P=u[1],S=A[0],R=A[1],b.alignment=1,b.width=L,b.height=P,b.channels=M,b.format=b.internalformat=gn[M],b.needsFree=!0,bl(b,m,S,R,p,I.offset)}else if(Zi(I)||Ji(I)||dl(I))Zi(I)||Ji(I)?b.element=I:b.element=I.canvas,b.width=b.element.width,b.height=b.element.height,b.channels=4;else if(hl(I))b.element=I,b.width=I.width,b.height=I.height,b.channels=4;else if(ml(I))b.element=I,b.width=I.naturalWidth,b.height=I.naturalHeight,b.channels=4;else if(pl(I))b.element=I,b.width=I.videoWidth,b.height=I.videoHeight,b.channels=4;else if(Ki(I)){var _=b.width||I[0].length,y=b.height||I.length,D=b.channels;ar(I[0][0])?D=D||I[0][0].length:D=D||1;for(var G=mn.shape(I),V=1,W=0;W<G.length;++W)V*=G[W];var ce=rf(b,V);mn.flatten(I,G,"",ce),tf(b,ce),b.alignment=1,b.width=_,b.height=y,b.channels=D,b.format=b.internalformat=gn[D],b.needsFree=!0}b.type===Vt?s(x.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):b.type===Mt&&s(x.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function ve(b,B,I){var _e=b.element,Ue=b.data,m=b.internalformat,u=b.format,A=b.type,L=b.width,P=b.height;le(b),_e?i.texImage2D(B,I,u,u,A,_e):b.compressed?i.compressedTexImage2D(B,I,m,L,P,0,Ue):b.needsCopy?($(),i.copyTexImage2D(B,I,u,b.xOffset,b.yOffset,L,P,0)):i.texImage2D(B,I,u,L,P,0,u,A,Ue||null)}function $e(b,B,I,_e,Ue){var m=b.element,u=b.data,A=b.internalformat,L=b.format,P=b.type,M=b.width,S=b.height;le(b),m?i.texSubImage2D(B,Ue,I,_e,L,P,m):b.compressed?i.compressedTexSubImage2D(B,Ue,I,_e,A,M,S,u):b.needsCopy?($(),i.copyTexSubImage2D(B,Ue,I,_e,b.xOffset,b.yOffset,M,S)):i.texSubImage2D(B,Ue,I,_e,M,S,L,P,u)}var Ne=[];function he(){return Ne.pop()||new te}function pe(b){b.needsFree&&lr.freeType(b.data),te.call(b),Ne.push(b)}function Fe(){Y.call(this),this.genMipmaps=!1,this.mipmapHint=Tn,this.mipmask=0,this.images=Array(16)}function Be(b,B,I){var _e=b.images[0]=he();b.mipmask=1,_e.width=b.width=B,_e.height=b.height=I,_e.channels=b.channels=4}function je(b,B){var I=null;if(Ma(B))I=b.images[0]=he(),X(I,b),ue(I,B),b.mipmask=1;else if(xe(b,B),Array.isArray(B.mipmap))for(var _e=B.mipmap,Ue=0;Ue<_e.length;++Ue)I=b.images[Ue]=he(),X(I,b),I.width>>=Ue,I.height>>=Ue,ue(I,_e[Ue]),b.mipmask|=1<<Ue;else I=b.images[0]=he(),X(I,b),ue(I,B),b.mipmask=1;X(b,b.images[0]),b.compressed&&(b.internalformat===pa||b.internalformat===ya||b.internalformat===ba||b.internalformat===_a)&&s(b.width%4===0&&b.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function ir(b,B){for(var I=b.images,_e=0;_e<I.length;++_e){if(!I[_e])return;ve(I[_e],B,_e)}}var sr=[];function Xe(){var b=sr.pop()||new Fe;Y.call(b),b.mipmask=0;for(var B=0;B<16;++B)b.images[B]=null;return b}function dr(b){for(var B=b.images,I=0;I<B.length;++I)B[I]&&pe(B[I]),B[I]=null;sr.push(b)}function rr(){this.minFilter=ga,this.magFilter=ga,this.wrapS=Ta,this.wrapT=Ta,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Tn}function vr(b,B){if("min"in B){var I=B.min;s.parameter(I,se),b.minFilter=se[I],ul.indexOf(b.minFilter)>=0&&!("faces"in B)&&(b.genMipmaps=!0)}if("mag"in B){var _e=B.mag;s.parameter(_e,ie),b.magFilter=ie[_e]}var Ue=b.wrapS,m=b.wrapT;if("wrap"in B){var u=B.wrap;typeof u=="string"?(s.parameter(u,Z),Ue=m=Z[u]):Array.isArray(u)&&(s.parameter(u[0],Z),s.parameter(u[1],Z),Ue=Z[u[0]],m=Z[u[1]])}else{if("wrapS"in B){var A=B.wrapS;s.parameter(A,Z),Ue=Z[A]}if("wrapT"in B){var L=B.wrapT;s.parameter(L,Z),m=Z[L]}}if(b.wrapS=Ue,b.wrapT=m,"anisotropic"in B){var P=B.anisotropic;s(typeof P=="number"&&P>=1&&P<=x.maxAnisotropic,"aniso samples must be between 1 and "),b.anisotropic=B.anisotropic}if("mipmap"in B){var M=!1;switch(typeof B.mipmap){case"string":s.parameter(B.mipmap,J,"invalid mipmap hint"),b.mipmapHint=J[B.mipmap],b.genMipmaps=!0,M=!0;break;case"boolean":M=b.genMipmaps=B.mipmap;break;case"object":s(Array.isArray(B.mipmap),"invalid mipmap type"),b.genMipmaps=!1,M=!0;break;default:s.raise("invalid mipmap type")}M&&!("min"in B)&&(b.minFilter=Aa)}}function hr(b,B){i.texParameteri(B,rl,b.minFilter),i.texParameteri(B,el,b.magFilter),i.texParameteri(B,Qo,b.wrapS),i.texParameteri(B,Ko,b.wrapT),d.ext_texture_filter_anisotropic&&i.texParameteri(B,fl,b.anisotropic),b.genMipmaps&&(i.hint(nl,b.mipmapHint),i.generateMipmap(B))}var mr=0,yr={},_r=x.maxTextureUnits,cr=Array(_r).map(function(){return null});function ke(b){Y.call(this),this.mipmask=0,this.internalformat=it,this.id=mr++,this.refCount=1,this.target=b,this.texture=i.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new rr,z.profile&&(this.stats={size:0})}function Er(b){i.activeTexture(Xt),i.bindTexture(b.target,b.texture)}function Ye(){var b=cr[0];b?i.bindTexture(b.target,b.texture):i.bindTexture(kr,null)}function Ce(b){var B=b.texture;s(B,"must not double destroy texture");var I=b.unit,_e=b.target;I>=0&&(i.activeTexture(Xt+I),i.bindTexture(_e,null),cr[I]=null),i.deleteTexture(B),b.texture=null,b.params=null,b.pixels=null,b.refCount=0,delete yr[b.id],N.textureCount--}n(ke.prototype,{bind:function(){var b=this;b.bindCount+=1;var B=b.unit;if(B<0){for(var I=0;I<_r;++I){var _e=cr[I];if(_e){if(_e.bindCount>0)continue;_e.unit=-1}cr[I]=b,B=I;break}B>=_r&&s.raise("insufficient number of texture units"),z.profile&&N.maxTextureUnits<B+1&&(N.maxTextureUnits=B+1),b.unit=B,i.activeTexture(Xt+B),i.bindTexture(b.target,b.texture)}return B},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Ce(this)}});function Ve(b,B){var I=new ke(kr);yr[I.id]=I,N.textureCount++;function _e(u,A){var L=I.texInfo;rr.call(L);var P=Xe();return typeof u=="number"?typeof A=="number"?Be(P,u|0,A|0):Be(P,u|0,u|0):u?(s.type(u,"object","invalid arguments to regl.texture"),vr(L,u),je(P,u)):Be(P,1,1),L.genMipmaps&&(P.mipmask=(P.width<<1)-1),I.mipmask=P.mipmask,X(I,P),s.texture2D(L,P,x),I.internalformat=P.internalformat,_e.width=P.width,_e.height=P.height,Er(I),ir(P,kr),hr(L,kr),Ye(),dr(P),z.profile&&(I.stats.size=An(I.internalformat,I.type,P.width,P.height,L.genMipmaps,!1)),_e.format=ne[I.internalformat],_e.type=ye[I.type],_e.mag=K[L.magFilter],_e.min=me[L.minFilter],_e.wrapS=de[L.wrapS],_e.wrapT=de[L.wrapT],_e}function Ue(u,A,L,P){s(!!u,"must specify image data");var M=A|0,S=L|0,R=P|0,p=he();return X(p,I),p.width=0,p.height=0,ue(p,u),p.width=p.width||(I.width>>R)-M,p.height=p.height||(I.height>>R)-S,s(I.type===p.type&&I.format===p.format&&I.internalformat===p.internalformat,"incompatible format for texture.subimage"),s(M>=0&&S>=0&&M+p.width<=I.width&&S+p.height<=I.height,"texture.subimage write out of bounds"),s(I.mipmask&1<<R,"missing mipmap data"),s(p.data||p.element||p.needsCopy,"missing image data"),Er(I),$e(p,kr,M,S,R),Ye(),pe(p),_e}function m(u,A){var L=u|0,P=A|0||L;if(L===I.width&&P===I.height)return _e;_e.width=I.width=L,_e.height=I.height=P,Er(I);for(var M=0;I.mipmask>>M;++M){var S=L>>M,R=P>>M;if(!S||!R)break;i.texImage2D(kr,M,I.format,S,R,0,I.format,I.type,null)}return Ye(),z.profile&&(I.stats.size=An(I.internalformat,I.type,L,P,!1,!1)),_e}return _e(b,B),_e.subimage=Ue,_e.resize=m,_e._reglType="texture2d",_e._texture=I,z.profile&&(_e.stats=I.stats),_e.destroy=function(){I.decRef()},_e}function qe(b,B,I,_e,Ue,m){var u=new ke(la);yr[u.id]=u,N.cubeCount++;var A=new Array(6);function L(S,R,p,_,y,D){var G,V=u.texInfo;for(rr.call(V),G=0;G<6;++G)A[G]=Xe();if(typeof S=="number"||!S){var W=S|0||1;for(G=0;G<6;++G)Be(A[G],W,W)}else if(typeof S=="object")if(R)je(A[0],S),je(A[1],R),je(A[2],p),je(A[3],_),je(A[4],y),je(A[5],D);else if(vr(V,S),xe(u,S),"faces"in S){var ce=S.faces;for(s(Array.isArray(ce)&&ce.length===6,"cube faces must be a length 6 array"),G=0;G<6;++G)s(typeof ce[G]=="object"&&!!ce[G],"invalid input for cube map face"),X(A[G],u),je(A[G],ce[G])}else for(G=0;G<6;++G)je(A[G],S);else s.raise("invalid arguments to cube map");for(X(u,A[0]),s.optional(function(){x.npotTextureCube||s(Li(u.width)&&Li(u.height),"your browser does not support non power or two texture dimensions")}),V.genMipmaps?u.mipmask=(A[0].width<<1)-1:u.mipmask=A[0].mipmask,s.textureCube(u,V,A,x),u.internalformat=A[0].internalformat,L.width=A[0].width,L.height=A[0].height,Er(u),G=0;G<6;++G)ir(A[G],bn+G);for(hr(V,la),Ye(),z.profile&&(u.stats.size=An(u.internalformat,u.type,L.width,L.height,V.genMipmaps,!0)),L.format=ne[u.internalformat],L.type=ye[u.type],L.mag=K[V.magFilter],L.min=me[V.minFilter],L.wrapS=de[V.wrapS],L.wrapT=de[V.wrapT],G=0;G<6;++G)dr(A[G]);return L}function P(S,R,p,_,y){s(!!R,"must specify image data"),s(typeof S=="number"&&S===(S|0)&&S>=0&&S<6,"invalid face");var D=p|0,G=_|0,V=y|0,W=he();return X(W,u),W.width=0,W.height=0,ue(W,R),W.width=W.width||(u.width>>V)-D,W.height=W.height||(u.height>>V)-G,s(u.type===W.type&&u.format===W.format&&u.internalformat===W.internalformat,"incompatible format for texture.subimage"),s(D>=0&&G>=0&&D+W.width<=u.width&&G+W.height<=u.height,"texture.subimage write out of bounds"),s(u.mipmask&1<<V,"missing mipmap data"),s(W.data||W.element||W.needsCopy,"missing image data"),Er(u),$e(W,bn+S,D,G,V),Ye(),pe(W),L}function M(S){var R=S|0;if(R!==u.width){L.width=u.width=R,L.height=u.height=R,Er(u);for(var p=0;p<6;++p)for(var _=0;u.mipmask>>_;++_)i.texImage2D(bn+p,_,u.format,R>>_,R>>_,0,u.format,u.type,null);return Ye(),z.profile&&(u.stats.size=An(u.internalformat,u.type,L.width,L.height,!1,!0)),L}}return L(b,B,I,_e,Ue,m),L.subimage=P,L.resize=M,L._reglType="textureCube",L._texture=u,z.profile&&(L.stats=u.stats),L.destroy=function(){u.decRef()},L}function or(){for(var b=0;b<_r;++b)i.activeTexture(Xt+b),i.bindTexture(kr,null),cr[b]=null;Lr(yr).forEach(Ce),N.cubeCount=0,N.textureCount=0}z.profile&&(N.getTotalTextureSize=function(){var b=0;return Object.keys(yr).forEach(function(B){b+=yr[B].stats.size}),b});function Ur(){for(var b=0;b<_r;++b){var B=cr[b];B&&(B.bindCount=0,B.unit=-1,cr[b]=null)}Lr(yr).forEach(function(I){I.texture=i.createTexture(),i.bindTexture(I.target,I.texture);for(var _e=0;_e<32;++_e)if((I.mipmask&1<<_e)!==0)if(I.target===kr)i.texImage2D(kr,_e,I.internalformat,I.width>>_e,I.height>>_e,0,I.internalformat,I.type,null);else for(var Ue=0;Ue<6;++Ue)i.texImage2D(bn+Ue,_e,I.internalformat,I.width>>_e,I.height>>_e,0,I.internalformat,I.type,null);hr(I.texInfo,I.target)})}function dt(){for(var b=0;b<_r;++b){var B=cr[b];B&&(B.bindCount=0,B.unit=-1,cr[b]=null),i.activeTexture(Xt+b),i.bindTexture(kr,null),i.bindTexture(la,null)}}return{create2D:Ve,createCube:qe,clear:or,getTexture:function(b){return null},restore:Ur,refresh:dt}}var Wr=36161,Sn=32854,nf=32855,af=36194,ff=33189,sf=36168,cf=34041,of=35907,lf=34836,uf=34842,vf=34843,Nr=[];Nr[Sn]=2,Nr[nf]=2,Nr[af]=2,Nr[ff]=2,Nr[sf]=1,Nr[cf]=4,Nr[of]=4,Nr[lf]=16,Nr[uf]=8,Nr[vf]=6;function df(i,d,x){return Nr[i]*d*x}var El=function(i,d,x,$,q){var N={rgba4:Sn,rgb565:af,"rgb5 a1":nf,depth:ff,stencil:sf,"depth stencil":cf};d.ext_srgb&&(N.srgba=of),d.ext_color_buffer_half_float&&(N.rgba16f=uf,N.rgb16f=vf),d.webgl_color_buffer_float&&(N.rgba32f=lf);var z=[];Object.keys(N).forEach(function(ee){var ae=N[ee];z[ae]=ee});var J=0,Z={};function ie(ee){this.id=J++,this.refCount=1,this.renderbuffer=ee,this.format=Sn,this.width=0,this.height=0,q.profile&&(this.stats={size:0})}ie.prototype.decRef=function(){--this.refCount<=0&&se(this)};function se(ee){var ae=ee.renderbuffer;s(ae,"must not double destroy renderbuffer"),i.bindRenderbuffer(Wr,null),i.deleteRenderbuffer(ae),ee.renderbuffer=null,ee.refCount=0,delete Z[ee.id],$.renderbufferCount--}function fe(ee,ae){var C=new ie(i.createRenderbuffer());Z[C.id]=C,$.renderbufferCount++;function k(ye,K){var me=0,de=0,Oe=Sn;if(typeof ye=="object"&&ye){var Y=ye;if("shape"in Y){var X=Y.shape;s(Array.isArray(X)&&X.length>=2,"invalid renderbuffer shape"),me=X[0]|0,de=X[1]|0}else"radius"in Y&&(me=de=Y.radius|0),"width"in Y&&(me=Y.width|0),"height"in Y&&(de=Y.height|0);"format"in Y&&(s.parameter(Y.format,N,"invalid renderbuffer format"),Oe=N[Y.format])}else typeof ye=="number"?(me=ye|0,typeof K=="number"?de=K|0:de=me):ye?s.raise("invalid arguments to renderbuffer constructor"):me=de=1;if(s(me>0&&de>0&&me<=x.maxRenderbufferSize&&de<=x.maxRenderbufferSize,"invalid renderbuffer size"),!(me===C.width&&de===C.height&&Oe===C.format))return k.width=C.width=me,k.height=C.height=de,C.format=Oe,i.bindRenderbuffer(Wr,C.renderbuffer),i.renderbufferStorage(Wr,Oe,me,de),s(i.getError()===0,"invalid render buffer format"),q.profile&&(C.stats.size=df(C.format,C.width,C.height)),k.format=z[C.format],k}function ne(ye,K){var me=ye|0,de=K|0||me;return me===C.width&&de===C.height||(s(me>0&&de>0&&me<=x.maxRenderbufferSize&&de<=x.maxRenderbufferSize,"invalid renderbuffer size"),k.width=C.width=me,k.height=C.height=de,i.bindRenderbuffer(Wr,C.renderbuffer),i.renderbufferStorage(Wr,C.format,me,de),s(i.getError()===0,"invalid render buffer format"),q.profile&&(C.stats.size=df(C.format,C.width,C.height))),k}return k(ee,ae),k.resize=ne,k._reglType="renderbuffer",k._renderbuffer=C,q.profile&&(k.stats=C.stats),k.destroy=function(){C.decRef()},k}q.profile&&($.getTotalRenderbufferSize=function(){var ee=0;return Object.keys(Z).forEach(function(ae){ee+=Z[ae].stats.size}),ee});function oe(){Lr(Z).forEach(function(ee){ee.renderbuffer=i.createRenderbuffer(),i.bindRenderbuffer(Wr,ee.renderbuffer),i.renderbufferStorage(Wr,ee.format,ee.width,ee.height)}),i.bindRenderbuffer(Wr,null)}return{create:fe,clear:function(){Lr(Z).forEach(se)},restore:oe}},Vr=36160,wa=36161,st=3553,Mn=34069,hf=36064,mf=36096,pf=36128,yf=33306,bf=36053,xl=36054,Tl=36055,gl=36057,Al=36061,Sl=36193,Ml=5121,wl=5126,_f=6407,Ef=6408,Ol=6402,Rl=[_f,Ef],Oa=[];Oa[Ef]=4,Oa[_f]=3;var wn=[];wn[Ml]=1,wn[wl]=4,wn[Sl]=2;var Ll=32854,Cl=32855,Pl=36194,Fl=33189,Gl=36168,xf=34041,Dl=35907,Il=34836,Nl=34842,$l=34843,Bl=[Ll,Cl,Pl,Dl,Nl,$l,Il],Lt={};Lt[bf]="complete",Lt[xl]="incomplete attachment",Lt[gl]="incomplete dimensions",Lt[Tl]="incomplete, missing attachment",Lt[Al]="unsupported";function kl(i,d,x,$,q,N){var z={cur:null,next:null,dirty:!1,setFBO:null},J=["rgba"],Z=["rgba4","rgb565","rgb5 a1"];d.ext_srgb&&Z.push("srgba"),d.ext_color_buffer_half_float&&Z.push("rgba16f","rgb16f"),d.webgl_color_buffer_float&&Z.push("rgba32f");var ie=["uint8"];d.oes_texture_half_float&&ie.push("half float","float16"),d.oes_texture_float&&ie.push("float","float32");function se(te,ue,ve){this.target=te,this.texture=ue,this.renderbuffer=ve;var $e=0,Ne=0;ue?($e=ue.width,Ne=ue.height):ve&&($e=ve.width,Ne=ve.height),this.width=$e,this.height=Ne}function fe(te){te&&(te.texture&&te.texture._texture.decRef(),te.renderbuffer&&te.renderbuffer._renderbuffer.decRef())}function oe(te,ue,ve){if(!!te)if(te.texture){var $e=te.texture._texture,Ne=Math.max(1,$e.width),he=Math.max(1,$e.height);s(Ne===ue&&he===ve,"inconsistent width/height for supplied texture"),$e.refCount+=1}else{var pe=te.renderbuffer._renderbuffer;s(pe.width===ue&&pe.height===ve,"inconsistent width/height for renderbuffer"),pe.refCount+=1}}function ee(te,ue){ue&&(ue.texture?i.framebufferTexture2D(Vr,te,ue.target,ue.texture._texture.texture,0):i.framebufferRenderbuffer(Vr,te,wa,ue.renderbuffer._renderbuffer.renderbuffer))}function ae(te){var ue=st,ve=null,$e=null,Ne=te;typeof te=="object"&&(Ne=te.data,"target"in te&&(ue=te.target|0)),s.type(Ne,"function","invalid attachment data");var he=Ne._reglType;return he==="texture2d"?(ve=Ne,s(ue===st)):he==="textureCube"?(ve=Ne,s(ue>=Mn&&ue<Mn+6,"invalid cube map target")):he==="renderbuffer"?($e=Ne,ue=wa):s.raise("invalid regl object for attachment"),new se(ue,ve,$e)}function C(te,ue,ve,$e,Ne){if(ve){var he=$.create2D({width:te,height:ue,format:$e,type:Ne});return he._texture.refCount=0,new se(st,he,null)}else{var pe=q.create({width:te,height:ue,format:$e});return pe._renderbuffer.refCount=0,new se(wa,null,pe)}}function k(te){return te&&(te.texture||te.renderbuffer)}function ne(te,ue,ve){te&&(te.texture?te.texture.resize(ue,ve):te.renderbuffer&&te.renderbuffer.resize(ue,ve),te.width=ue,te.height=ve)}var ye=0,K={};function me(){this.id=ye++,K[this.id]=this,this.framebuffer=i.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function de(te){te.colorAttachments.forEach(fe),fe(te.depthAttachment),fe(te.stencilAttachment),fe(te.depthStencilAttachment)}function Oe(te){var ue=te.framebuffer;s(ue,"must not double destroy framebuffer"),i.deleteFramebuffer(ue),te.framebuffer=null,N.framebufferCount--,delete K[te.id]}function Y(te){var ue;i.bindFramebuffer(Vr,te.framebuffer);var ve=te.colorAttachments;for(ue=0;ue<ve.length;++ue)ee(hf+ue,ve[ue]);for(ue=ve.length;ue<x.maxColorAttachments;++ue)i.framebufferTexture2D(Vr,hf+ue,st,null,0);i.framebufferTexture2D(Vr,yf,st,null,0),i.framebufferTexture2D(Vr,mf,st,null,0),i.framebufferTexture2D(Vr,pf,st,null,0),ee(mf,te.depthAttachment),ee(pf,te.stencilAttachment),ee(yf,te.depthStencilAttachment);var $e=i.checkFramebufferStatus(Vr);!i.isContextLost()&&$e!==bf&&s.raise("framebuffer configuration not supported, status = "+Lt[$e]),i.bindFramebuffer(Vr,z.next?z.next.framebuffer:null),z.cur=z.next,i.getError()}function X(te,ue){var ve=new me;N.framebufferCount++;function $e(he,pe){var Fe;s(z.next!==ve,"can not update framebuffer which is currently in use");var Be=0,je=0,ir=!0,sr=!0,Xe=null,dr=!0,rr="rgba",vr="uint8",hr=1,mr=null,yr=null,_r=null,cr=!1;if(typeof he=="number")Be=he|0,je=pe|0||Be;else if(!he)Be=je=1;else{s.type(he,"object","invalid arguments for framebuffer");var ke=he;if("shape"in ke){var Er=ke.shape;s(Array.isArray(Er)&&Er.length>=2,"invalid shape for framebuffer"),Be=Er[0],je=Er[1]}else"radius"in ke&&(Be=je=ke.radius),"width"in ke&&(Be=ke.width),"height"in ke&&(je=ke.height);("color"in ke||"colors"in ke)&&(Xe=ke.color||ke.colors,Array.isArray(Xe)&&s(Xe.length===1||d.webgl_draw_buffers,"multiple render targets not supported")),Xe||("colorCount"in ke&&(hr=ke.colorCount|0,s(hr>0,"invalid color buffer count")),"colorTexture"in ke&&(dr=!!ke.colorTexture,rr="rgba4"),"colorType"in ke&&(vr=ke.colorType,dr?(s(d.oes_texture_float||!(vr==="float"||vr==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),s(d.oes_texture_half_float||!(vr==="half float"||vr==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):vr==="half float"||vr==="float16"?(s(d.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),rr="rgba16f"):(vr==="float"||vr==="float32")&&(s(d.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),rr="rgba32f"),s.oneOf(vr,ie,"invalid color type")),"colorFormat"in ke&&(rr=ke.colorFormat,J.indexOf(rr)>=0?dr=!0:Z.indexOf(rr)>=0?dr=!1:s.optional(function(){dr?s.oneOf(ke.colorFormat,J,"invalid color format for texture"):s.oneOf(ke.colorFormat,Z,"invalid color format for renderbuffer")}))),("depthTexture"in ke||"depthStencilTexture"in ke)&&(cr=!!(ke.depthTexture||ke.depthStencilTexture),s(!cr||d.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in ke&&(typeof ke.depth=="boolean"?ir=ke.depth:(mr=ke.depth,sr=!1)),"stencil"in ke&&(typeof ke.stencil=="boolean"?sr=ke.stencil:(yr=ke.stencil,ir=!1)),"depthStencil"in ke&&(typeof ke.depthStencil=="boolean"?ir=sr=ke.depthStencil:(_r=ke.depthStencil,ir=!1,sr=!1))}var Ye=null,Ce=null,Ve=null,qe=null;if(Array.isArray(Xe))Ye=Xe.map(ae);else if(Xe)Ye=[ae(Xe)];else for(Ye=new Array(hr),Fe=0;Fe<hr;++Fe)Ye[Fe]=C(Be,je,dr,rr,vr);s(d.webgl_draw_buffers||Ye.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),s(Ye.length<=x.maxColorAttachments,"too many color attachments, not supported"),Be=Be||Ye[0].width,je=je||Ye[0].height,mr?Ce=ae(mr):ir&&!sr&&(Ce=C(Be,je,cr,"depth","uint32")),yr?Ve=ae(yr):sr&&!ir&&(Ve=C(Be,je,!1,"stencil","uint8")),_r?qe=ae(_r):!mr&&!yr&&sr&&ir&&(qe=C(Be,je,cr,"depth stencil","depth stencil")),s(!!mr+!!yr+!!_r<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var or=null;for(Fe=0;Fe<Ye.length;++Fe)if(oe(Ye[Fe],Be,je),s(!Ye[Fe]||Ye[Fe].texture&&Rl.indexOf(Ye[Fe].texture._texture.format)>=0||Ye[Fe].renderbuffer&&Bl.indexOf(Ye[Fe].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Fe+" is invalid"),Ye[Fe]&&Ye[Fe].texture){var Ur=Oa[Ye[Fe].texture._texture.format]*wn[Ye[Fe].texture._texture.type];or===null?or=Ur:s(or===Ur,"all color attachments much have the same number of bits per pixel.")}return oe(Ce,Be,je),s(!Ce||Ce.texture&&Ce.texture._texture.format===Ol||Ce.renderbuffer&&Ce.renderbuffer._renderbuffer.format===Fl,"invalid depth attachment for framebuffer object"),oe(Ve,Be,je),s(!Ve||Ve.renderbuffer&&Ve.renderbuffer._renderbuffer.format===Gl,"invalid stencil attachment for framebuffer object"),oe(qe,Be,je),s(!qe||qe.texture&&qe.texture._texture.format===xf||qe.renderbuffer&&qe.renderbuffer._renderbuffer.format===xf,"invalid depth-stencil attachment for framebuffer object"),de(ve),ve.width=Be,ve.height=je,ve.colorAttachments=Ye,ve.depthAttachment=Ce,ve.stencilAttachment=Ve,ve.depthStencilAttachment=qe,$e.color=Ye.map(k),$e.depth=k(Ce),$e.stencil=k(Ve),$e.depthStencil=k(qe),$e.width=ve.width,$e.height=ve.height,Y(ve),$e}function Ne(he,pe){s(z.next!==ve,"can not resize a framebuffer which is currently in use");var Fe=Math.max(he|0,1),Be=Math.max(pe|0||Fe,1);if(Fe===ve.width&&Be===ve.height)return $e;for(var je=ve.colorAttachments,ir=0;ir<je.length;++ir)ne(je[ir],Fe,Be);return ne(ve.depthAttachment,Fe,Be),ne(ve.stencilAttachment,Fe,Be),ne(ve.depthStencilAttachment,Fe,Be),ve.width=$e.width=Fe,ve.height=$e.height=Be,Y(ve),$e}return $e(te,ue),n($e,{resize:Ne,_reglType:"framebuffer",_framebuffer:ve,destroy:function(){Oe(ve),de(ve)},use:function(he){z.setFBO({framebuffer:$e},he)}})}function xe(te){var ue=Array(6);function ve(Ne){var he;s(ue.indexOf(z.next)<0,"can not update framebuffer which is currently in use");var pe={color:null},Fe=0,Be=null,je="rgba",ir="uint8",sr=1;if(typeof Ne=="number")Fe=Ne|0;else if(!Ne)Fe=1;else{s.type(Ne,"object","invalid arguments for framebuffer");var Xe=Ne;if("shape"in Xe){var dr=Xe.shape;s(Array.isArray(dr)&&dr.length>=2,"invalid shape for framebuffer"),s(dr[0]===dr[1],"cube framebuffer must be square"),Fe=dr[0]}else"radius"in Xe&&(Fe=Xe.radius|0),"width"in Xe?(Fe=Xe.width|0,"height"in Xe&&s(Xe.height===Fe,"must be square")):"height"in Xe&&(Fe=Xe.height|0);("color"in Xe||"colors"in Xe)&&(Be=Xe.color||Xe.colors,Array.isArray(Be)&&s(Be.length===1||d.webgl_draw_buffers,"multiple render targets not supported")),Be||("colorCount"in Xe&&(sr=Xe.colorCount|0,s(sr>0,"invalid color buffer count")),"colorType"in Xe&&(s.oneOf(Xe.colorType,ie,"invalid color type"),ir=Xe.colorType),"colorFormat"in Xe&&(je=Xe.colorFormat,s.oneOf(Xe.colorFormat,J,"invalid color format for texture"))),"depth"in Xe&&(pe.depth=Xe.depth),"stencil"in Xe&&(pe.stencil=Xe.stencil),"depthStencil"in Xe&&(pe.depthStencil=Xe.depthStencil)}var rr;if(Be)if(Array.isArray(Be))for(rr=[],he=0;he<Be.length;++he)rr[he]=Be[he];else rr=[Be];else{rr=Array(sr);var vr={radius:Fe,format:je,type:ir};for(he=0;he<sr;++he)rr[he]=$.createCube(vr)}for(pe.color=Array(rr.length),he=0;he<rr.length;++he){var hr=rr[he];s(typeof hr=="function"&&hr._reglType==="textureCube","invalid cube map"),Fe=Fe||hr.width,s(hr.width===Fe&&hr.height===Fe,"invalid cube map shape"),pe.color[he]={target:Mn,data:rr[he]}}for(he=0;he<6;++he){for(var mr=0;mr<rr.length;++mr)pe.color[mr].target=Mn+he;he>0&&(pe.depth=ue[0].depth,pe.stencil=ue[0].stencil,pe.depthStencil=ue[0].depthStencil),ue[he]?ue[he](pe):ue[he]=X(pe)}return n(ve,{width:Fe,height:Fe,color:rr})}function $e(Ne){var he,pe=Ne|0;if(s(pe>0&&pe<=x.maxCubeMapSize,"invalid radius for cube fbo"),pe===ve.width)return ve;var Fe=ve.color;for(he=0;he<Fe.length;++he)Fe[he].resize(pe);for(he=0;he<6;++he)ue[he].resize(pe);return ve.width=ve.height=pe,ve}return ve(te),n(ve,{faces:ue,resize:$e,_reglType:"framebufferCube",destroy:function(){ue.forEach(function(Ne){Ne.destroy()})}})}function le(){z.cur=null,z.next=null,z.dirty=!0,Lr(K).forEach(function(te){te.framebuffer=i.createFramebuffer(),Y(te)})}return n(z,{getFramebuffer:function(te){if(typeof te=="function"&&te._reglType==="framebuffer"){var ue=te._framebuffer;if(ue instanceof me)return ue}return null},create:X,createCube:xe,clear:function(){Lr(K).forEach(Oe)},restore:le})}var zl=5126,Tf=34962,On=34963,gf=["attributes","elements","offset","count","primitive","instances"];function Ra(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=zl,this.offset=0,this.stride=0,this.divisor=0}function Ul(i,d,x,$,q,N,z){for(var J=x.maxAttributes,Z=new Array(J),ie=0;ie<J;++ie)Z[ie]=new Ra;var se=0,fe={},oe={Record:Ra,scope:{},state:Z,currentVAO:null,targetVAO:null,restore:ae()?de:function(){},createVAO:Oe,getVAO:k,destroyBuffer:ee,setVAO:ae()?ne:ye,clear:ae()?K:function(){}};function ee(Y){for(var X=0;X<Z.length;++X){var xe=Z[X];xe.buffer===Y&&(i.disableVertexAttribArray(X),xe.buffer=null)}}function ae(){return d.oes_vertex_array_object}function C(){return d.angle_instanced_arrays}function k(Y){return typeof Y=="function"&&Y._vao?Y._vao:null}function ne(Y){if(Y!==oe.currentVAO){var X=ae();Y?X.bindVertexArrayOES(Y.vao):X.bindVertexArrayOES(null),oe.currentVAO=Y}}function ye(Y){if(Y!==oe.currentVAO){if(Y)Y.bindAttrs();else{for(var X=C(),xe=0;xe<Z.length;++xe){var le=Z[xe];le.buffer?(i.enableVertexAttribArray(xe),le.buffer.bind(),i.vertexAttribPointer(xe,le.size,le.type,le.normalized,le.stride,le.offfset),X&&le.divisor&&X.vertexAttribDivisorANGLE(xe,le.divisor)):(i.disableVertexAttribArray(xe),i.vertexAttrib4f(xe,le.x,le.y,le.z,le.w))}z.elements?i.bindBuffer(On,z.elements.buffer.buffer):i.bindBuffer(On,null)}oe.currentVAO=Y}}function K(){Lr(fe).forEach(function(Y){Y.destroy()})}function me(){this.id=++se,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var Y=ae();Y?this.vao=Y.createVertexArrayOES():this.vao=null,fe[this.id]=this,this.buffers=[]}me.prototype.bindAttrs=function(){for(var Y=C(),X=this.attributes,xe=0;xe<X.length;++xe){var le=X[xe];le.buffer?(i.enableVertexAttribArray(xe),i.bindBuffer(Tf,le.buffer.buffer),i.vertexAttribPointer(xe,le.size,le.type,le.normalized,le.stride,le.offset),Y&&le.divisor&&Y.vertexAttribDivisorANGLE(xe,le.divisor)):(i.disableVertexAttribArray(xe),i.vertexAttrib4f(xe,le.x,le.y,le.z,le.w))}for(var te=X.length;te<J;++te)i.disableVertexAttribArray(te);var ue=N.getElements(this.elements);ue?i.bindBuffer(On,ue.buffer.buffer):i.bindBuffer(On,null)},me.prototype.refresh=function(){var Y=ae();Y&&(Y.bindVertexArrayOES(this.vao),this.bindAttrs(),oe.currentVAO=null,Y.bindVertexArrayOES(null))},me.prototype.destroy=function(){if(this.vao){var Y=ae();this===oe.currentVAO&&(oe.currentVAO=null,Y.bindVertexArrayOES(null)),Y.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),fe[this.id]&&(delete fe[this.id],$.vaoCount-=1)};function de(){var Y=ae();Y&&Lr(fe).forEach(function(X){X.refresh()})}function Oe(Y){var X=new me;$.vaoCount+=1;function xe(le){var te;if(Array.isArray(le))te=le,X.elements&&X.ownsElements&&X.elements.destroy(),X.elements=null,X.ownsElements=!1,X.offset=0,X.count=0,X.instances=-1,X.primitive=4;else{if(s(typeof le=="object","invalid arguments for create vao"),s("attributes"in le,"must specify attributes for vao"),le.elements){var ue=le.elements;X.ownsElements?typeof ue=="function"&&ue._reglType==="elements"?(X.elements.destroy(),X.ownsElements=!1):(X.elements(ue),X.ownsElements=!1):N.getElements(le.elements)?(X.elements=le.elements,X.ownsElements=!1):(X.elements=N.create(le.elements),X.ownsElements=!0)}else X.elements=null,X.ownsElements=!1;te=le.attributes,X.offset=0,X.count=-1,X.instances=-1,X.primitive=4,X.elements&&(X.count=X.elements._elements.vertCount,X.primitive=X.elements._elements.primType),"offset"in le&&(X.offset=le.offset|0),"count"in le&&(X.count=le.count|0),"instances"in le&&(X.instances=le.instances|0),"primitive"in le&&(s(le.primitive in Yr,"bad primitive type: "+le.primitive),X.primitive=Yr[le.primitive]),s.optional(()=>{for(var ir=Object.keys(le),sr=0;sr<ir.length;++sr)s(gf.indexOf(ir[sr])>=0,'invalid option for vao: "'+ir[sr]+'" valid options are '+gf)}),s(Array.isArray(te),"attributes must be an array")}s(te.length<J,"too many attributes"),s(te.length>0,"must specify at least one attribute");var ve={},$e=X.attributes;$e.length=te.length;for(var Ne=0;Ne<te.length;++Ne){var he=te[Ne],pe=$e[Ne]=new Ra,Fe=he.data||he;if(Array.isArray(Fe)||t(Fe)||Ir(Fe)){var Be;X.buffers[Ne]&&(Be=X.buffers[Ne],t(Fe)&&Be._buffer.byteLength>=Fe.byteLength?Be.subdata(Fe):(Be.destroy(),X.buffers[Ne]=null)),X.buffers[Ne]||(Be=X.buffers[Ne]=q.create(he,Tf,!1,!0)),pe.buffer=q.getBuffer(Be),pe.size=pe.buffer.dimension|0,pe.normalized=!1,pe.type=pe.buffer.dtype,pe.offset=0,pe.stride=0,pe.divisor=0,pe.state=1,ve[Ne]=1}else q.getBuffer(he)?(pe.buffer=q.getBuffer(he),pe.size=pe.buffer.dimension|0,pe.normalized=!1,pe.type=pe.buffer.dtype,pe.offset=0,pe.stride=0,pe.divisor=0,pe.state=1):q.getBuffer(he.buffer)?(pe.buffer=q.getBuffer(he.buffer),pe.size=(+he.size||pe.buffer.dimension)|0,pe.normalized=!!he.normalized||!1,"type"in he?(s.parameter(he.type,nt,"invalid buffer type"),pe.type=nt[he.type]):pe.type=pe.buffer.dtype,pe.offset=(he.offset||0)|0,pe.stride=(he.stride||0)|0,pe.divisor=(he.divisor||0)|0,pe.state=1,s(pe.size>=1&&pe.size<=4,"size must be between 1 and 4"),s(pe.offset>=0,"invalid offset"),s(pe.stride>=0&&pe.stride<=255,"stride must be between 0 and 255"),s(pe.divisor>=0,"divisor must be positive"),s(!pe.divisor||!!d.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in he?(s(Ne>0,"first attribute must not be a constant"),pe.x=+he.x||0,pe.y=+he.y||0,pe.z=+he.z||0,pe.w=+he.w||0,pe.state=2):s(!1,"invalid attribute spec for location "+Ne)}for(var je=0;je<X.buffers.length;++je)!ve[je]&&X.buffers[je]&&(X.buffers[je].destroy(),X.buffers[je]=null);return X.refresh(),xe}return xe.destroy=function(){for(var le=0;le<X.buffers.length;++le)X.buffers[le]&&X.buffers[le].destroy();X.buffers.length=0,X.ownsElements&&(X.elements.destroy(),X.elements=null,X.ownsElements=!1),X.destroy()},xe._vao=X,xe._reglType="vao",xe(Y)}return oe}var Af=35632,jl=35633,Vl=35718,Xl=35721;function ql(i,d,x,$){var q={},N={};function z(C,k,ne,ye){this.name=C,this.id=k,this.location=ne,this.info=ye}function J(C,k){for(var ne=0;ne<C.length;++ne)if(C[ne].id===k.id){C[ne].location=k.location;return}C.push(k)}function Z(C,k,ne){var ye=C===Af?q:N,K=ye[k];if(!K){var me=d.str(k);K=i.createShader(C),i.shaderSource(K,me),i.compileShader(K),s.shaderError(i,K,me,C,ne),ye[k]=K}return K}var ie={},se=[],fe=0;function oe(C,k){this.id=fe++,this.fragId=C,this.vertId=k,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,$.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function ee(C,k,ne){var ye,K,me=Z(Af,C.fragId),de=Z(jl,C.vertId),Oe=C.program=i.createProgram();if(i.attachShader(Oe,me),i.attachShader(Oe,de),ne)for(ye=0;ye<ne.length;++ye){var Y=ne[ye];i.bindAttribLocation(Oe,Y[0],Y[1])}i.linkProgram(Oe),s.linkError(i,Oe,d.str(C.fragId),d.str(C.vertId),k);var X=i.getProgramParameter(Oe,Vl);$.profile&&(C.stats.uniformsCount=X);var xe=C.uniforms;for(ye=0;ye<X;++ye)if(K=i.getActiveUniform(Oe,ye),K){if(K.size>1)for(var le=0;le<K.size;++le){var te=K.name.replace("[0]","["+le+"]");J(xe,new z(te,d.id(te),i.getUniformLocation(Oe,te),K))}var ue=K.name;K.size>1&&(ue=ue.replace("[0]","")),J(xe,new z(ue,d.id(ue),i.getUniformLocation(Oe,ue),K))}var ve=i.getProgramParameter(Oe,Xl);$.profile&&(C.stats.attributesCount=ve);var $e=C.attributes;for(ye=0;ye<ve;++ye)K=i.getActiveAttrib(Oe,ye),K&&J($e,new z(K.name,d.id(K.name),i.getAttribLocation(Oe,K.name),K))}$.profile&&(x.getMaxUniformsCount=function(){var C=0;return se.forEach(function(k){k.stats.uniformsCount>C&&(C=k.stats.uniformsCount)}),C},x.getMaxAttributesCount=function(){var C=0;return se.forEach(function(k){k.stats.attributesCount>C&&(C=k.stats.attributesCount)}),C});function ae(){q={},N={};for(var C=0;C<se.length;++C)ee(se[C],null,se[C].attributes.map(function(k){return[k.location,k.name]}))}return{clear:function(){var C=i.deleteShader.bind(i);Lr(q).forEach(C),q={},Lr(N).forEach(C),N={},se.forEach(function(k){i.deleteProgram(k.program)}),se.length=0,ie={},x.shaderCount=0},program:function(C,k,ne,ye){s.command(C>=0,"missing vertex shader",ne),s.command(k>=0,"missing fragment shader",ne);var K=ie[k];K||(K=ie[k]={});var me=K[C];if(me&&(me.refCount++,!ye))return me;var de=new oe(k,C);return x.shaderCount++,ee(de,ne,ye),me||(K[C]=de),se.push(de),n(de,{destroy:function(){if(de.refCount--,de.refCount<=0){i.deleteProgram(de.program);var Oe=se.indexOf(de);se.splice(Oe,1),x.shaderCount--}K[de.vertId].refCount<=0&&(i.deleteShader(N[de.vertId]),delete N[de.vertId],delete ie[de.fragId][de.vertId]),Object.keys(ie[de.fragId]).length||(i.deleteShader(q[de.fragId]),delete q[de.fragId],delete ie[de.fragId])}})},restore:ae,shader:Z,frag:-1,vert:-1}}var Hl=6408,qt=5121,Yl=3333,Rn=5126;function Wl(i,d,x,$,q,N,z){function J(se){var fe;d.next===null?(s(q.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),fe=qt):(s(d.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),fe=d.next.colorAttachments[0].texture._texture.type,s.optional(function(){N.oes_texture_float?(s(fe===qt||fe===Rn,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),fe===Rn&&s(z.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):s(fe===qt,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var oe=0,ee=0,ae=$.framebufferWidth,C=$.framebufferHeight,k=null;t(se)?k=se:se&&(s.type(se,"object","invalid arguments to regl.read()"),oe=se.x|0,ee=se.y|0,s(oe>=0&&oe<$.framebufferWidth,"invalid x offset for regl.read"),s(ee>=0&&ee<$.framebufferHeight,"invalid y offset for regl.read"),ae=(se.width||$.framebufferWidth-oe)|0,C=(se.height||$.framebufferHeight-ee)|0,k=se.data||null),k&&(fe===qt?s(k instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):fe===Rn&&s(k instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),s(ae>0&&ae+oe<=$.framebufferWidth,"invalid width for read pixels"),s(C>0&&C+ee<=$.framebufferHeight,"invalid height for read pixels"),x();var ne=ae*C*4;return k||(fe===qt?k=new Uint8Array(ne):fe===Rn&&(k=k||new Float32Array(ne))),s.isTypedArray(k,"data buffer for regl.read() must be a typedarray"),s(k.byteLength>=ne,"data buffer for regl.read() too small"),i.pixelStorei(Yl,4),i.readPixels(oe,ee,ae,C,Hl,fe,k),k}function Z(se){var fe;return d.setFBO({framebuffer:se.framebuffer},function(){fe=J(se)}),fe}function ie(se){return!se||!("framebuffer"in se)?J(se):Z(se)}return ie}function Ct(i){return Array.prototype.slice.call(i)}function Pt(i){return Ct(i).join("")}function Ql(){var i=0,d=[],x=[];function $(fe){for(var oe=0;oe<x.length;++oe)if(x[oe]===fe)return d[oe];var ee="g"+i++;return d.push(ee),x.push(fe),ee}function q(){var fe=[];function oe(){fe.push.apply(fe,Ct(arguments))}var ee=[];function ae(){var C="v"+i++;return ee.push(C),arguments.length>0&&(fe.push(C,"="),fe.push.apply(fe,Ct(arguments)),fe.push(";")),C}return n(oe,{def:ae,toString:function(){return Pt([ee.length>0?"var "+ee.join(",")+";":"",Pt(fe)])}})}function N(){var fe=q(),oe=q(),ee=fe.toString,ae=oe.toString;function C(k,ne){oe(k,ne,"=",fe.def(k,ne),";")}return n(function(){fe.apply(fe,Ct(arguments))},{def:fe.def,entry:fe,exit:oe,save:C,set:function(k,ne,ye){C(k,ne),fe(k,ne,"=",ye,";")},toString:function(){return ee()+ae()}})}function z(){var fe=Pt(arguments),oe=N(),ee=N(),ae=oe.toString,C=ee.toString;return n(oe,{then:function(){return oe.apply(oe,Ct(arguments)),this},else:function(){return ee.apply(ee,Ct(arguments)),this},toString:function(){var k=C();return k&&(k="else{"+k+"}"),Pt(["if(",fe,"){",ae(),"}",k])}})}var J=q(),Z={};function ie(fe,oe){var ee=[];function ae(){var K="a"+ee.length;return ee.push(K),K}oe=oe||0;for(var C=0;C<oe;++C)ae();var k=N(),ne=k.toString,ye=Z[fe]=n(k,{arg:ae,toString:function(){return Pt(["function(",ee.join(),"){",ne(),"}"])}});return ye}function se(){var fe=['"use strict";',J,"return {"];Object.keys(Z).forEach(function(ae){fe.push('"',ae,'":',Z[ae].toString(),",")}),fe.push("}");var oe=Pt(fe).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),ee=Function.apply(null,d.concat(oe));return ee.apply(null,x)}return{global:J,link:$,block:q,proc:ie,scope:N,cond:z,compile:se}}var Ft="xyzw".split(""),Sf=5121,Gt=1,La=2,Ca=0,Pa=1,Fa=2,Ga=3,Ln=4,Mf=5,wf=6,Of="dither",Rf="blend.enable",Lf="blend.color",Da="blend.equation",Ia="blend.func",Cf="depth.enable",Pf="depth.func",Ff="depth.range",Gf="depth.mask",Na="colorMask",Df="cull.enable",If="cull.face",$a="frontFace",Ba="lineWidth",Nf="polygonOffset.enable",ka="polygonOffset.offset",$f="sample.alpha",Bf="sample.enable",za="sample.coverage",kf="stencil.enable",zf="stencil.mask",Ua="stencil.func",ja="stencil.opFront",Ht="stencil.opBack",Uf="scissor.enable",Cn="scissor.box",Xr="viewport",Yt="profile",ct="framebuffer",Wt="vert",Qt="frag",ot="elements",lt="primitive",ut="count",Pn="offset",Fn="instances",Kt="vao",Va="Width",Xa="Height",Dt=ct+Va,It=ct+Xa,Kl=Xr+Va,Zl=Xr+Xa,jf="drawingBuffer",Vf=jf+Va,Xf=jf+Xa,Jl=[Ia,Da,Ua,ja,Ht,za,Xr,Cn,ka],Nt=34962,qa=34963,eu=35632,ru=35633,qf=3553,tu=34067,nu=2884,au=3042,iu=3024,fu=2960,su=2929,cu=3089,ou=32823,lu=32926,uu=32928,Ha=5126,Gn=35664,Dn=35665,In=35666,Ya=5124,Nn=35667,$n=35668,Bn=35669,Wa=35670,kn=35671,zn=35672,Un=35673,Zt=35674,Jt=35675,en=35676,rn=35678,tn=35680,Qa=4,nn=1028,vt=1029,Hf=2304,Ka=2305,vu=32775,du=32776,hu=519,Qr=7680,Yf=0,Wf=1,Qf=32774,mu=513,Kf=36160,pu=36064,zr={"0":0,"1":1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Zf=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],$t={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Kr={"0":0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Jf={frag:eu,vert:ru},Za={cw:Hf,ccw:Ka};function jn(i){return Array.isArray(i)||t(i)||Ir(i)}function es(i){return i.sort(function(d,x){return d===Xr?-1:x===Xr?1:d<x?-1:1})}function pr(i,d,x,$){this.thisDep=i,this.contextDep=d,this.propDep=x,this.append=$}function Zr(i){return i&&!(i.thisDep||i.contextDep||i.propDep)}function ur(i){return new pr(!1,!1,!1,i)}function Mr(i,d){var x=i.type;if(x===Ca){var $=i.data.length;return new pr(!0,$>=1,$>=2,d)}else if(x===Ln){var q=i.data;return new pr(q.thisDep,q.contextDep,q.propDep,d)}else{if(x===Mf)return new pr(!1,!1,!1,d);if(x===wf){for(var N=!1,z=!1,J=!1,Z=0;Z<i.data.length;++Z){var ie=i.data[Z];if(ie.type===Pa)J=!0;else if(ie.type===Fa)z=!0;else if(ie.type===Ga)N=!0;else if(ie.type===Ca){N=!0;var se=ie.data;se>=1&&(z=!0),se>=2&&(J=!0)}else ie.type===Ln&&(N=N||ie.data.thisDep,z=z||ie.data.contextDep,J=J||ie.data.propDep)}return new pr(N,z,J,d)}else return new pr(x===Ga,x===Fa,x===Pa,d)}}var rs=new pr(!1,!1,!1,function(){});function yu(i,d,x,$,q,N,z,J,Z,ie,se,fe,oe,ee,ae){var C=ie.Record,k={add:32774,subtract:32778,"reverse subtract":32779};x.ext_blend_minmax&&(k.min=vu,k.max=du);var ne=x.angle_instanced_arrays,ye=x.webgl_draw_buffers,K=x.oes_vertex_array_object,me={dirty:!0,profile:ae.profile},de={},Oe=[],Y={},X={};function xe(m){return m.replace(".","_")}function le(m,u,A){var L=xe(m);Oe.push(m),de[L]=me[L]=!!A,Y[L]=u}function te(m,u,A){var L=xe(m);Oe.push(m),Array.isArray(A)?(me[L]=A.slice(),de[L]=A.slice()):me[L]=de[L]=A,X[L]=u}le(Of,iu),le(Rf,au),te(Lf,"blendColor",[0,0,0,0]),te(Da,"blendEquationSeparate",[Qf,Qf]),te(Ia,"blendFuncSeparate",[Wf,Yf,Wf,Yf]),le(Cf,su,!0),te(Pf,"depthFunc",mu),te(Ff,"depthRange",[0,1]),te(Gf,"depthMask",!0),te(Na,Na,[!0,!0,!0,!0]),le(Df,nu),te(If,"cullFace",vt),te($a,$a,Ka),te(Ba,Ba,1),le(Nf,ou),te(ka,"polygonOffset",[0,0]),le($f,lu),le(Bf,uu),te(za,"sampleCoverage",[1,!1]),le(kf,fu),te(zf,"stencilMask",-1),te(Ua,"stencilFunc",[hu,0,-1]),te(ja,"stencilOpSeparate",[nn,Qr,Qr,Qr]),te(Ht,"stencilOpSeparate",[vt,Qr,Qr,Qr]),le(Uf,cu),te(Cn,"scissor",[0,0,i.drawingBufferWidth,i.drawingBufferHeight]),te(Xr,Xr,[0,0,i.drawingBufferWidth,i.drawingBufferHeight]);var ue={gl:i,context:oe,strings:d,next:de,current:me,draw:fe,elements:N,buffer:q,shader:se,attributes:ie.state,vao:ie,uniforms:Z,framebuffer:J,extensions:x,timer:ee,isBufferArgs:jn},ve={primTypes:Yr,compareFuncs:$t,blendFuncs:zr,blendEquations:k,stencilOps:Kr,glTypes:nt,orientationType:Za};s.optional(function(){ue.isArrayLike=ar}),ye&&(ve.backBuffer=[vt],ve.drawBuffer=Rr($.maxDrawbuffers,function(m){return m===0?[0]:Rr(m,function(u){return pu+u})}));var $e=0;function Ne(){var m=Ql(),u=m.link,A=m.global;m.id=$e++,m.batchId="0";var L=u(ue),P=m.shared={props:"a0"};Object.keys(ue).forEach(function(_){P[_]=A.def(L,".",_)}),s.optional(function(){m.CHECK=u(s),m.commandStr=s.guessCommand(),m.command=u(m.commandStr),m.assert=function(_,y,D){_("if(!(",y,"))",this.CHECK,".commandRaise(",u(D),",",this.command,");")},ve.invalidBlendCombinations=Zf});var M=m.next={},S=m.current={};Object.keys(X).forEach(function(_){Array.isArray(me[_])&&(M[_]=A.def(P.next,".",_),S[_]=A.def(P.current,".",_))});var R=m.constants={};Object.keys(ve).forEach(function(_){R[_]=A.def(JSON.stringify(ve[_]))}),m.invoke=function(_,y){switch(y.type){case Ca:var D=["this",P.context,P.props,m.batchId];return _.def(u(y.data),".call(",D.slice(0,Math.max(y.data.length+1,4)),")");case Pa:return _.def(P.props,y.data);case Fa:return _.def(P.context,y.data);case Ga:return _.def("this",y.data);case Ln:return y.data.append(m,_),y.data.ref;case Mf:return y.data.toString();case wf:return y.data.map(function(G){return m.invoke(_,G)})}},m.attribCache={};var p={};return m.scopeAttrib=function(_){var y=d.id(_);if(y in p)return p[y];var D=ie.scope[y];D||(D=ie.scope[y]=new C);var G=p[y]=u(D);return G},m}function he(m){var u=m.static,A=m.dynamic,L;if(Yt in u){var P=!!u[Yt];L=ur(function(S,R){return P}),L.enable=P}else if(Yt in A){var M=A[Yt];L=Mr(M,function(S,R){return S.invoke(R,M)})}return L}function pe(m,u){var A=m.static,L=m.dynamic;if(ct in A){var P=A[ct];return P?(P=J.getFramebuffer(P),s.command(P,"invalid framebuffer object"),ur(function(S,R){var p=S.link(P),_=S.shared;R.set(_.framebuffer,".next",p);var y=_.context;return R.set(y,"."+Dt,p+".width"),R.set(y,"."+It,p+".height"),p})):ur(function(S,R){var p=S.shared;R.set(p.framebuffer,".next","null");var _=p.context;return R.set(_,"."+Dt,_+"."+Vf),R.set(_,"."+It,_+"."+Xf),"null"})}else if(ct in L){var M=L[ct];return Mr(M,function(S,R){var p=S.invoke(R,M),_=S.shared,y=_.framebuffer,D=R.def(y,".getFramebuffer(",p,")");s.optional(function(){S.assert(R,"!"+p+"||"+D,"invalid framebuffer object")}),R.set(y,".next",D);var G=_.context;return R.set(G,"."+Dt,D+"?"+D+".width:"+G+"."+Vf),R.set(G,"."+It,D+"?"+D+".height:"+G+"."+Xf),D})}else return null}function Fe(m,u,A){var L=m.static,P=m.dynamic;function M(p){if(p in L){var _=L[p];s.commandType(_,"object","invalid "+p,A.commandStr);var y=!0,D=_.x|0,G=_.y|0,V,W;return"width"in _?(V=_.width|0,s.command(V>=0,"invalid "+p,A.commandStr)):y=!1,"height"in _?(W=_.height|0,s.command(W>=0,"invalid "+p,A.commandStr)):y=!1,new pr(!y&&u&&u.thisDep,!y&&u&&u.contextDep,!y&&u&&u.propDep,function(we,be){var Q=we.shared.context,j=V;"width"in _||(j=be.def(Q,".",Dt,"-",D));var Ae=W;return"height"in _||(Ae=be.def(Q,".",It,"-",G)),[D,G,j,Ae]})}else if(p in P){var ce=P[p],De=Mr(ce,function(we,be){var Q=we.invoke(be,ce);s.optional(function(){we.assert(be,Q+"&&typeof "+Q+'==="object"',"invalid "+p)});var j=we.shared.context,Ae=be.def(Q,".x|0"),ge=be.def(Q,".y|0"),Ge=be.def('"width" in ',Q,"?",Q,".width|0:","(",j,".",Dt,"-",Ae,")"),Qe=be.def('"height" in ',Q,"?",Q,".height|0:","(",j,".",It,"-",ge,")");return s.optional(function(){we.assert(be,Ge+">=0&&"+Qe+">=0","invalid "+p)}),[Ae,ge,Ge,Qe]});return u&&(De.thisDep=De.thisDep||u.thisDep,De.contextDep=De.contextDep||u.contextDep,De.propDep=De.propDep||u.propDep),De}else return u?new pr(u.thisDep,u.contextDep,u.propDep,function(we,be){var Q=we.shared.context;return[0,0,be.def(Q,".",Dt),be.def(Q,".",It)]}):null}var S=M(Xr);if(S){var R=S;S=new pr(S.thisDep,S.contextDep,S.propDep,function(p,_){var y=R.append(p,_),D=p.shared.context;return _.set(D,"."+Kl,y[2]),_.set(D,"."+Zl,y[3]),y})}return{viewport:S,scissor_box:M(Cn)}}function Be(m,u){var A=m.static,L=typeof A[Qt]=="string"&&typeof A[Wt]=="string";if(L){if(Object.keys(u.dynamic).length>0)return null;var P=u.static,M=Object.keys(P);if(M.length>0&&typeof P[M[0]]=="number"){for(var S=[],R=0;R<M.length;++R)s(typeof P[M[R]]=="number","must specify all vertex attribute locations when using vaos"),S.push([P[M[R]]|0,M[R]]);return S}}return null}function je(m,u,A){var L=m.static,P=m.dynamic;function M(y){if(y in L){var D=d.id(L[y]);s.optional(function(){se.shader(Jf[y],D,s.guessCommand())});var G=ur(function(){return D});return G.id=D,G}else if(y in P){var V=P[y];return Mr(V,function(W,ce){var De=W.invoke(ce,V),we=ce.def(W.shared.strings,".id(",De,")");return s.optional(function(){ce(W.shared.shader,".shader(",Jf[y],",",we,",",W.command,");")}),we})}return null}var S=M(Qt),R=M(Wt),p=null,_;return Zr(S)&&Zr(R)?(p=se.program(R.id,S.id,null,A),_=ur(function(y,D){return y.link(p)})):_=new pr(S&&S.thisDep||R&&R.thisDep,S&&S.contextDep||R&&R.contextDep,S&&S.propDep||R&&R.propDep,function(y,D){var G=y.shared.shader,V;S?V=S.append(y,D):V=D.def(G,".",Qt);var W;R?W=R.append(y,D):W=D.def(G,".",Wt);var ce=G+".program("+W+","+V;return s.optional(function(){ce+=","+y.command}),D.def(ce+")")}),{frag:S,vert:R,progVar:_,program:p}}function ir(m,u){var A=m.static,L=m.dynamic,P={},M=!1;function S(){if(Kt in A){var be=A[Kt];return be!==null&&ie.getVAO(be)===null&&(be=ie.createVAO(be)),M=!0,P.vao=be,ur(function(j){var Ae=ie.getVAO(be);return Ae?j.link(Ae):"null"})}else if(Kt in L){M=!0;var Q=L[Kt];return Mr(Q,function(j,Ae){var ge=j.invoke(Ae,Q);return Ae.def(j.shared.vao+".getVAO("+ge+")")})}return null}var R=S(),p=!1;function _(){if(ot in A){var be=A[ot];if(P.elements=be,jn(be)){var Q=P.elements=N.create(be,!0);be=N.getElements(Q),p=!0}else be&&(be=N.getElements(be),p=!0,s.command(be,"invalid elements",u.commandStr));var j=ur(function(ge,Ge){if(be){var Qe=ge.link(be);return ge.ELEMENTS=Qe,Qe}return ge.ELEMENTS=null,null});return j.value=be,j}else if(ot in L){p=!0;var Ae=L[ot];return Mr(Ae,function(ge,Ge){var Qe=ge.shared,xr=Qe.isBufferArgs,ht=Qe.elements,qr=ge.invoke(Ge,Ae),jr=Ge.def("null"),Jr=Ge.def(xr,"(",qr,")"),mt=ge.cond(Jr).then(jr,"=",ht,".createStream(",qr,");").else(jr,"=",ht,".getElements(",qr,");");return s.optional(function(){ge.assert(mt.else,"!"+qr+"||"+jr,"invalid elements")}),Ge.entry(mt),Ge.exit(ge.cond(Jr).then(ht,".destroyStream(",jr,");")),ge.ELEMENTS=jr,jr})}else if(M)return new pr(R.thisDep,R.contextDep,R.propDep,function(ge,Ge){return Ge.def(ge.shared.vao+".currentVAO?"+ge.shared.elements+".getElements("+ge.shared.vao+".currentVAO.elements):null")});return null}var y=_();function D(){if(lt in A){var be=A[lt];return P.primitive=be,s.commandParameter(be,Yr,"invalid primitve",u.commandStr),ur(function(j,Ae){return Yr[be]})}else if(lt in L){var Q=L[lt];return Mr(Q,function(j,Ae){var ge=j.constants.primTypes,Ge=j.invoke(Ae,Q);return s.optional(function(){j.assert(Ae,Ge+" in "+ge,"invalid primitive, must be one of "+Object.keys(Yr))}),Ae.def(ge,"[",Ge,"]")})}else{if(p)return Zr(y)?y.value?ur(function(j,Ae){return Ae.def(j.ELEMENTS,".primType")}):ur(function(){return Qa}):new pr(y.thisDep,y.contextDep,y.propDep,function(j,Ae){var ge=j.ELEMENTS;return Ae.def(ge,"?",ge,".primType:",Qa)});if(M)return new pr(R.thisDep,R.contextDep,R.propDep,function(j,Ae){return Ae.def(j.shared.vao+".currentVAO?"+j.shared.vao+".currentVAO.primitive:"+Qa)})}return null}function G(be,Q){if(be in A){var j=A[be]|0;return Q?P.offset=j:P.instances=j,s.command(!Q||j>=0,"invalid "+be,u.commandStr),ur(function(ge,Ge){return Q&&(ge.OFFSET=j),j})}else if(be in L){var Ae=L[be];return Mr(Ae,function(ge,Ge){var Qe=ge.invoke(Ge,Ae);return Q&&(ge.OFFSET=Qe,s.optional(function(){ge.assert(Ge,Qe+">=0","invalid "+be)})),Qe})}else if(Q){if(p)return ur(function(ge,Ge){return ge.OFFSET=0,0});if(M)return new pr(R.thisDep,R.contextDep,R.propDep,function(ge,Ge){return Ge.def(ge.shared.vao+".currentVAO?"+ge.shared.vao+".currentVAO.offset:0")})}else if(M)return new pr(R.thisDep,R.contextDep,R.propDep,function(ge,Ge){return Ge.def(ge.shared.vao+".currentVAO?"+ge.shared.vao+".currentVAO.instances:-1")});return null}var V=G(Pn,!0);function W(){if(ut in A){var be=A[ut]|0;return P.count=be,s.command(typeof be=="number"&&be>=0,"invalid vertex count",u.commandStr),ur(function(){return be})}else if(ut in L){var Q=L[ut];return Mr(Q,function(Ge,Qe){var xr=Ge.invoke(Qe,Q);return s.optional(function(){Ge.assert(Qe,"typeof "+xr+'==="number"&&'+xr+">=0&&"+xr+"===("+xr+"|0)","invalid vertex count")}),xr})}else if(p)if(Zr(y)){if(y)return V?new pr(V.thisDep,V.contextDep,V.propDep,function(Ge,Qe){var xr=Qe.def(Ge.ELEMENTS,".vertCount-",Ge.OFFSET);return s.optional(function(){Ge.assert(Qe,xr+">=0","invalid vertex offset/element buffer too small")}),xr}):ur(function(Ge,Qe){return Qe.def(Ge.ELEMENTS,".vertCount")});var j=ur(function(){return-1});return s.optional(function(){j.MISSING=!0}),j}else{var Ae=new pr(y.thisDep||V.thisDep,y.contextDep||V.contextDep,y.propDep||V.propDep,function(Ge,Qe){var xr=Ge.ELEMENTS;return Ge.OFFSET?Qe.def(xr,"?",xr,".vertCount-",Ge.OFFSET,":-1"):Qe.def(xr,"?",xr,".vertCount:-1")});return s.optional(function(){Ae.DYNAMIC=!0}),Ae}else if(M){var ge=new pr(R.thisDep,R.contextDep,R.propDep,function(Ge,Qe){return Qe.def(Ge.shared.vao,".currentVAO?",Ge.shared.vao,".currentVAO.count:-1")});return ge}return null}var ce=D(),De=W(),we=G(Fn,!1);return{elements:y,primitive:ce,count:De,instances:we,offset:V,vao:R,vaoActive:M,elementsActive:p,static:P}}function sr(m,u){var A=m.static,L=m.dynamic,P={};return Oe.forEach(function(M){var S=xe(M);function R(p,_){if(M in A){var y=p(A[M]);P[S]=ur(function(){return y})}else if(M in L){var D=L[M];P[S]=Mr(D,function(G,V){return _(G,V,G.invoke(V,D))})}}switch(M){case Df:case Rf:case Of:case kf:case Cf:case Uf:case Nf:case $f:case Bf:case Gf:return R(function(p){return s.commandType(p,"boolean",M,u.commandStr),p},function(p,_,y){return s.optional(function(){p.assert(_,"typeof "+y+'==="boolean"',"invalid flag "+M,p.commandStr)}),y});case Pf:return R(function(p){return s.commandParameter(p,$t,"invalid "+M,u.commandStr),$t[p]},function(p,_,y){var D=p.constants.compareFuncs;return s.optional(function(){p.assert(_,y+" in "+D,"invalid "+M+", must be one of "+Object.keys($t))}),_.def(D,"[",y,"]")});case Ff:return R(function(p){return s.command(ar(p)&&p.length===2&&typeof p[0]=="number"&&typeof p[1]=="number"&&p[0]<=p[1],"depth range is 2d array",u.commandStr),p},function(p,_,y){s.optional(function(){p.assert(_,p.shared.isArrayLike+"("+y+")&&"+y+".length===2&&typeof "+y+'[0]==="number"&&typeof '+y+'[1]==="number"&&'+y+"[0]<="+y+"[1]","depth range must be a 2d array")});var D=_.def("+",y,"[0]"),G=_.def("+",y,"[1]");return[D,G]});case Ia:return R(function(p){s.commandType(p,"object","blend.func",u.commandStr);var _="srcRGB"in p?p.srcRGB:p.src,y="srcAlpha"in p?p.srcAlpha:p.src,D="dstRGB"in p?p.dstRGB:p.dst,G="dstAlpha"in p?p.dstAlpha:p.dst;return s.commandParameter(_,zr,S+".srcRGB",u.commandStr),s.commandParameter(y,zr,S+".srcAlpha",u.commandStr),s.commandParameter(D,zr,S+".dstRGB",u.commandStr),s.commandParameter(G,zr,S+".dstAlpha",u.commandStr),s.command(Zf.indexOf(_+", "+D)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+_+", "+D+")",u.commandStr),[zr[_],zr[D],zr[y],zr[G]]},function(p,_,y){var D=p.constants.blendFuncs;s.optional(function(){p.assert(_,y+"&&typeof "+y+'==="object"',"invalid blend func, must be an object")});function G(Q,j){var Ae=_.def('"',Q,j,'" in ',y,"?",y,".",Q,j,":",y,".",Q);return s.optional(function(){p.assert(_,Ae+" in "+D,"invalid "+M+"."+Q+j+", must be one of "+Object.keys(zr))}),Ae}var V=G("src","RGB"),W=G("dst","RGB");s.optional(function(){var Q=p.constants.invalidBlendCombinations;p.assert(_,Q+".indexOf("+V+'+", "+'+W+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var ce=_.def(D,"[",V,"]"),De=_.def(D,"[",G("src","Alpha"),"]"),we=_.def(D,"[",W,"]"),be=_.def(D,"[",G("dst","Alpha"),"]");return[ce,we,De,be]});case Da:return R(function(p){if(typeof p=="string")return s.commandParameter(p,k,"invalid "+M,u.commandStr),[k[p],k[p]];if(typeof p=="object")return s.commandParameter(p.rgb,k,M+".rgb",u.commandStr),s.commandParameter(p.alpha,k,M+".alpha",u.commandStr),[k[p.rgb],k[p.alpha]];s.commandRaise("invalid blend.equation",u.commandStr)},function(p,_,y){var D=p.constants.blendEquations,G=_.def(),V=_.def(),W=p.cond("typeof ",y,'==="string"');return s.optional(function(){function ce(De,we,be){p.assert(De,be+" in "+D,"invalid "+we+", must be one of "+Object.keys(k))}ce(W.then,M,y),p.assert(W.else,y+"&&typeof "+y+'==="object"',"invalid "+M),ce(W.else,M+".rgb",y+".rgb"),ce(W.else,M+".alpha",y+".alpha")}),W.then(G,"=",V,"=",D,"[",y,"];"),W.else(G,"=",D,"[",y,".rgb];",V,"=",D,"[",y,".alpha];"),_(W),[G,V]});case Lf:return R(function(p){return s.command(ar(p)&&p.length===4,"blend.color must be a 4d array",u.commandStr),Rr(4,function(_){return+p[_]})},function(p,_,y){return s.optional(function(){p.assert(_,p.shared.isArrayLike+"("+y+")&&"+y+".length===4","blend.color must be a 4d array")}),Rr(4,function(D){return _.def("+",y,"[",D,"]")})});case zf:return R(function(p){return s.commandType(p,"number",S,u.commandStr),p|0},function(p,_,y){return s.optional(function(){p.assert(_,"typeof "+y+'==="number"',"invalid stencil.mask")}),_.def(y,"|0")});case Ua:return R(function(p){s.commandType(p,"object",S,u.commandStr);var _=p.cmp||"keep",y=p.ref||0,D="mask"in p?p.mask:-1;return s.commandParameter(_,$t,M+".cmp",u.commandStr),s.commandType(y,"number",M+".ref",u.commandStr),s.commandType(D,"number",M+".mask",u.commandStr),[$t[_],y,D]},function(p,_,y){var D=p.constants.compareFuncs;s.optional(function(){function ce(){p.assert(_,Array.prototype.join.call(arguments,""),"invalid stencil.func")}ce(y+"&&typeof ",y,'==="object"'),ce('!("cmp" in ',y,")||(",y,".cmp in ",D,")")});var G=_.def('"cmp" in ',y,"?",D,"[",y,".cmp]",":",Qr),V=_.def(y,".ref|0"),W=_.def('"mask" in ',y,"?",y,".mask|0:-1");return[G,V,W]});case ja:case Ht:return R(function(p){s.commandType(p,"object",S,u.commandStr);var _=p.fail||"keep",y=p.zfail||"keep",D=p.zpass||"keep";return s.commandParameter(_,Kr,M+".fail",u.commandStr),s.commandParameter(y,Kr,M+".zfail",u.commandStr),s.commandParameter(D,Kr,M+".zpass",u.commandStr),[M===Ht?vt:nn,Kr[_],Kr[y],Kr[D]]},function(p,_,y){var D=p.constants.stencilOps;s.optional(function(){p.assert(_,y+"&&typeof "+y+'==="object"',"invalid "+M)});function G(V){return s.optional(function(){p.assert(_,'!("'+V+'" in '+y+")||("+y+"."+V+" in "+D+")","invalid "+M+"."+V+", must be one of "+Object.keys(Kr))}),_.def('"',V,'" in ',y,"?",D,"[",y,".",V,"]:",Qr)}return[M===Ht?vt:nn,G("fail"),G("zfail"),G("zpass")]});case ka:return R(function(p){s.commandType(p,"object",S,u.commandStr);var _=p.factor|0,y=p.units|0;return s.commandType(_,"number",S+".factor",u.commandStr),s.commandType(y,"number",S+".units",u.commandStr),[_,y]},function(p,_,y){s.optional(function(){p.assert(_,y+"&&typeof "+y+'==="object"',"invalid "+M)});var D=_.def(y,".factor|0"),G=_.def(y,".units|0");return[D,G]});case If:return R(function(p){var _=0;return p==="front"?_=nn:p==="back"&&(_=vt),s.command(!!_,S,u.commandStr),_},function(p,_,y){return s.optional(function(){p.assert(_,y+'==="front"||'+y+'==="back"',"invalid cull.face")}),_.def(y,'==="front"?',nn,":",vt)});case Ba:return R(function(p){return s.command(typeof p=="number"&&p>=$.lineWidthDims[0]&&p<=$.lineWidthDims[1],"invalid line width, must be a positive number between "+$.lineWidthDims[0]+" and "+$.lineWidthDims[1],u.commandStr),p},function(p,_,y){return s.optional(function(){p.assert(_,"typeof "+y+'==="number"&&'+y+">="+$.lineWidthDims[0]+"&&"+y+"<="+$.lineWidthDims[1],"invalid line width")}),y});case $a:return R(function(p){return s.commandParameter(p,Za,S,u.commandStr),Za[p]},function(p,_,y){return s.optional(function(){p.assert(_,y+'==="cw"||'+y+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),_.def(y+'==="cw"?'+Hf+":"+Ka)});case Na:return R(function(p){return s.command(ar(p)&&p.length===4,"color.mask must be length 4 array",u.commandStr),p.map(function(_){return!!_})},function(p,_,y){return s.optional(function(){p.assert(_,p.shared.isArrayLike+"("+y+")&&"+y+".length===4","invalid color.mask")}),Rr(4,function(D){return"!!"+y+"["+D+"]"})});case za:return R(function(p){s.command(typeof p=="object"&&p,S,u.commandStr);var _="value"in p?p.value:1,y=!!p.invert;return s.command(typeof _=="number"&&_>=0&&_<=1,"sample.coverage.value must be a number between 0 and 1",u.commandStr),[_,y]},function(p,_,y){s.optional(function(){p.assert(_,y+"&&typeof "+y+'==="object"',"invalid sample.coverage")});var D=_.def('"value" in ',y,"?+",y,".value:1"),G=_.def("!!",y,".invert");return[D,G]})}}),P}function Xe(m,u){var A=m.static,L=m.dynamic,P={};return Object.keys(A).forEach(function(M){var S=A[M],R;if(typeof S=="number"||typeof S=="boolean")R=ur(function(){return S});else if(typeof S=="function"){var p=S._reglType;p==="texture2d"||p==="textureCube"?R=ur(function(_){return _.link(S)}):p==="framebuffer"||p==="framebufferCube"?(s.command(S.color.length>0,'missing color attachment for framebuffer sent to uniform "'+M+'"',u.commandStr),R=ur(function(_){return _.link(S.color[0])})):s.commandRaise('invalid data for uniform "'+M+'"',u.commandStr)}else ar(S)?R=ur(function(_){var y=_.global.def("[",Rr(S.length,function(D){return s.command(typeof S[D]=="number"||typeof S[D]=="boolean","invalid uniform "+M,_.commandStr),S[D]}),"]");return y}):s.commandRaise('invalid or missing data for uniform "'+M+'"',u.commandStr);R.value=S,P[M]=R}),Object.keys(L).forEach(function(M){var S=L[M];P[M]=Mr(S,function(R,p){return R.invoke(p,S)})}),P}function dr(m,u){var A=m.static,L=m.dynamic,P={};return Object.keys(A).forEach(function(M){var S=A[M],R=d.id(M),p=new C;if(jn(S))p.state=Gt,p.buffer=q.getBuffer(q.create(S,Nt,!1,!0)),p.type=0;else{var _=q.getBuffer(S);if(_)p.state=Gt,p.buffer=_,p.type=0;else if(s.command(typeof S=="object"&&S,"invalid data for attribute "+M,u.commandStr),"constant"in S){var y=S.constant;p.buffer="null",p.state=La,typeof y=="number"?p.x=y:(s.command(ar(y)&&y.length>0&&y.length<=4,"invalid constant for attribute "+M,u.commandStr),Ft.forEach(function(we,be){be<y.length&&(p[we]=y[be])}))}else{jn(S.buffer)?_=q.getBuffer(q.create(S.buffer,Nt,!1,!0)):_=q.getBuffer(S.buffer),s.command(!!_,'missing buffer for attribute "'+M+'"',u.commandStr);var D=S.offset|0;s.command(D>=0,'invalid offset for attribute "'+M+'"',u.commandStr);var G=S.stride|0;s.command(G>=0&&G<256,'invalid stride for attribute "'+M+'", must be integer betweeen [0, 255]',u.commandStr);var V=S.size|0;s.command(!("size"in S)||V>0&&V<=4,'invalid size for attribute "'+M+'", must be 1,2,3,4',u.commandStr);var W=!!S.normalized,ce=0;"type"in S&&(s.commandParameter(S.type,nt,"invalid type for attribute "+M,u.commandStr),ce=nt[S.type]);var De=S.divisor|0;s.optional(function(){"divisor"in S&&(s.command(De===0||ne,'cannot specify divisor for attribute "'+M+'", instancing not supported',u.commandStr),s.command(De>=0,'invalid divisor for attribute "'+M+'"',u.commandStr));var we=u.commandStr,be=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(S).forEach(function(Q){s.command(be.indexOf(Q)>=0,'unknown parameter "'+Q+'" for attribute pointer "'+M+'" (valid parameters are '+be+")",we)})}),p.buffer=_,p.state=Gt,p.size=V,p.normalized=W,p.type=ce||_.dtype,p.offset=D,p.stride=G,p.divisor=De}}P[M]=ur(function(we,be){var Q=we.attribCache;if(R in Q)return Q[R];var j={isStream:!1};return Object.keys(p).forEach(function(Ae){j[Ae]=p[Ae]}),p.buffer&&(j.buffer=we.link(p.buffer),j.type=j.type||j.buffer+".dtype"),Q[R]=j,j})}),Object.keys(L).forEach(function(M){var S=L[M];function R(p,_){var y=p.invoke(_,S),D=p.shared,G=p.constants,V=D.isBufferArgs,W=D.buffer;s.optional(function(){p.assert(_,y+"&&(typeof "+y+'==="object"||typeof '+y+'==="function")&&('+V+"("+y+")||"+W+".getBuffer("+y+")||"+W+".getBuffer("+y+".buffer)||"+V+"("+y+'.buffer)||("constant" in '+y+"&&(typeof "+y+'.constant==="number"||'+D.isArrayLike+"("+y+".constant))))",'invalid dynamic attribute "'+M+'"')});var ce={isStream:_.def(!1)},De=new C;De.state=Gt,Object.keys(De).forEach(function(j){ce[j]=_.def(""+De[j])});var we=ce.buffer,be=ce.type;_("if(",V,"(",y,")){",ce.isStream,"=true;",we,"=",W,".createStream(",Nt,",",y,");",be,"=",we,".dtype;","}else{",we,"=",W,".getBuffer(",y,");","if(",we,"){",be,"=",we,".dtype;",'}else if("constant" in ',y,"){",ce.state,"=",La,";","if(typeof "+y+'.constant === "number"){',ce[Ft[0]],"=",y,".constant;",Ft.slice(1).map(function(j){return ce[j]}).join("="),"=0;","}else{",Ft.map(function(j,Ae){return ce[j]+"="+y+".constant.length>"+Ae+"?"+y+".constant["+Ae+"]:0;"}).join(""),"}}else{","if(",V,"(",y,".buffer)){",we,"=",W,".createStream(",Nt,",",y,".buffer);","}else{",we,"=",W,".getBuffer(",y,".buffer);","}",be,'="type" in ',y,"?",G.glTypes,"[",y,".type]:",we,".dtype;",ce.normalized,"=!!",y,".normalized;");function Q(j){_(ce[j],"=",y,".",j,"|0;")}return Q("size"),Q("offset"),Q("stride"),Q("divisor"),_("}}"),_.exit("if(",ce.isStream,"){",W,".destroyStream(",we,");","}"),ce}P[M]=Mr(S,R)}),P}function rr(m){var u=m.static,A=m.dynamic,L={};return Object.keys(u).forEach(function(P){var M=u[P];L[P]=ur(function(S,R){return typeof M=="number"||typeof M=="boolean"?""+M:S.link(M)})}),Object.keys(A).forEach(function(P){var M=A[P];L[P]=Mr(M,function(S,R){return S.invoke(R,M)})}),L}function vr(m,u,A,L,P){var M=m.static,S=m.dynamic;s.optional(function(){var Q=[ct,Wt,Qt,ot,lt,Pn,ut,Fn,Yt,Kt].concat(Oe);function j(Ae){Object.keys(Ae).forEach(function(ge){s.command(Q.indexOf(ge)>=0,'unknown parameter "'+ge+'"',P.commandStr)})}j(M),j(S)});var R=Be(m,u),p=pe(m),_=Fe(m,p,P),y=ir(m,P),D=sr(m,P),G=je(m,P,R);function V(Q){var j=_[Q];j&&(D[Q]=j)}V(Xr),V(xe(Cn));var W=Object.keys(D).length>0,ce={framebuffer:p,draw:y,shader:G,state:D,dirty:W,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(ce.profile=he(m),ce.uniforms=Xe(A,P),ce.drawVAO=ce.scopeVAO=y.vao,!ce.drawVAO&&G.program&&!R&&x.angle_instanced_arrays&&y.static.elements){var De=!0,we=G.program.attributes.map(function(Q){var j=u.static[Q];return De=De&&!!j,j});if(De&&we.length>0){var be=ie.getVAO(ie.createVAO({attributes:we,elements:y.static.elements}));ce.drawVAO=new pr(null,null,null,function(Q,j){return Q.link(be)}),ce.useVAO=!0}}return R?ce.useVAO=!0:ce.attributes=dr(u,P),ce.context=rr(L),ce}function hr(m,u,A){var L=m.shared,P=L.context,M=m.scope();Object.keys(A).forEach(function(S){u.save(P,"."+S);var R=A[S],p=R.append(m,u);Array.isArray(p)?M(P,".",S,"=[",p.join(),"];"):M(P,".",S,"=",p,";")}),u(M)}function mr(m,u,A,L){var P=m.shared,M=P.gl,S=P.framebuffer,R;ye&&(R=u.def(P.extensions,".webgl_draw_buffers"));var p=m.constants,_=p.drawBuffer,y=p.backBuffer,D;A?D=A.append(m,u):D=u.def(S,".next"),L||u("if(",D,"!==",S,".cur){"),u("if(",D,"){",M,".bindFramebuffer(",Kf,",",D,".framebuffer);"),ye&&u(R,".drawBuffersWEBGL(",_,"[",D,".colorAttachments.length]);"),u("}else{",M,".bindFramebuffer(",Kf,",null);"),ye&&u(R,".drawBuffersWEBGL(",y,");"),u("}",S,".cur=",D,";"),L||u("}")}function yr(m,u,A){var L=m.shared,P=L.gl,M=m.current,S=m.next,R=L.current,p=L.next,_=m.cond(R,".dirty");Oe.forEach(function(y){var D=xe(y);if(!(D in A.state)){var G,V;if(D in S){G=S[D],V=M[D];var W=Rr(me[D].length,function(De){return _.def(G,"[",De,"]")});_(m.cond(W.map(function(De,we){return De+"!=="+V+"["+we+"]"}).join("||")).then(P,".",X[D],"(",W,");",W.map(function(De,we){return V+"["+we+"]="+De}).join(";"),";"))}else{G=_.def(p,".",D);var ce=m.cond(G,"!==",R,".",D);_(ce),D in Y?ce(m.cond(G).then(P,".enable(",Y[D],");").else(P,".disable(",Y[D],");"),R,".",D,"=",G,";"):ce(P,".",X[D],"(",G,");",R,".",D,"=",G,";")}}}),Object.keys(A.state).length===0&&_(R,".dirty=false;"),u(_)}function _r(m,u,A,L){var P=m.shared,M=m.current,S=P.current,R=P.gl;es(Object.keys(A)).forEach(function(p){var _=A[p];if(!(L&&!L(_))){var y=_.append(m,u);if(Y[p]){var D=Y[p];Zr(_)?y?u(R,".enable(",D,");"):u(R,".disable(",D,");"):u(m.cond(y).then(R,".enable(",D,");").else(R,".disable(",D,");")),u(S,".",p,"=",y,";")}else if(ar(y)){var G=M[p];u(R,".",X[p],"(",y,");",y.map(function(V,W){return G+"["+W+"]="+V}).join(";"),";")}else u(R,".",X[p],"(",y,");",S,".",p,"=",y,";")}})}function cr(m,u){ne&&(m.instancing=u.def(m.shared.extensions,".angle_instanced_arrays"))}function ke(m,u,A,L,P){var M=m.shared,S=m.stats,R=M.current,p=M.timer,_=A.profile;function y(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}var D,G;function V(Q){D=u.def(),Q(D,"=",y(),";"),typeof P=="string"?Q(S,".count+=",P,";"):Q(S,".count++;"),ee&&(L?(G=u.def(),Q(G,"=",p,".getNumPendingQueries();")):Q(p,".beginQuery(",S,");"))}function W(Q){Q(S,".cpuTime+=",y(),"-",D,";"),ee&&(L?Q(p,".pushScopeStats(",G,",",p,".getNumPendingQueries(),",S,");"):Q(p,".endQuery();"))}function ce(Q){var j=u.def(R,".profile");u(R,".profile=",Q,";"),u.exit(R,".profile=",j,";")}var De;if(_){if(Zr(_)){_.enable?(V(u),W(u.exit),ce("true")):ce("false");return}De=_.append(m,u),ce(De)}else De=u.def(R,".profile");var we=m.block();V(we),u("if(",De,"){",we,"}");var be=m.block();W(be),u.exit("if(",De,"){",be,"}")}function Er(m,u,A,L,P){var M=m.shared;function S(p){switch(p){case Gn:case Nn:case kn:return 2;case Dn:case $n:case zn:return 3;case In:case Bn:case Un:return 4;default:return 1}}function R(p,_,y){var D=M.gl,G=u.def(p,".location"),V=u.def(M.attributes,"[",G,"]"),W=y.state,ce=y.buffer,De=[y.x,y.y,y.z,y.w],we=["buffer","normalized","offset","stride"];function be(){u("if(!",V,".buffer){",D,".enableVertexAttribArray(",G,");}");var j=y.type,Ae;if(y.size?Ae=u.def(y.size,"||",_):Ae=_,u("if(",V,".type!==",j,"||",V,".size!==",Ae,"||",we.map(function(Ge){return V+"."+Ge+"!=="+y[Ge]}).join("||"),"){",D,".bindBuffer(",Nt,",",ce,".buffer);",D,".vertexAttribPointer(",[G,Ae,j,y.normalized,y.stride,y.offset],");",V,".type=",j,";",V,".size=",Ae,";",we.map(function(Ge){return V+"."+Ge+"="+y[Ge]+";"}).join(""),"}"),ne){var ge=y.divisor;u("if(",V,".divisor!==",ge,"){",m.instancing,".vertexAttribDivisorANGLE(",[G,ge],");",V,".divisor=",ge,";}")}}function Q(){u("if(",V,".buffer){",D,".disableVertexAttribArray(",G,");",V,".buffer=null;","}if(",Ft.map(function(j,Ae){return V+"."+j+"!=="+De[Ae]}).join("||"),"){",D,".vertexAttrib4f(",G,",",De,");",Ft.map(function(j,Ae){return V+"."+j+"="+De[Ae]+";"}).join(""),"}")}W===Gt?be():W===La?Q():(u("if(",W,"===",Gt,"){"),be(),u("}else{"),Q(),u("}"))}L.forEach(function(p){var _=p.name,y=A.attributes[_],D;if(y){if(!P(y))return;D=y.append(m,u)}else{if(!P(rs))return;var G=m.scopeAttrib(_);s.optional(function(){m.assert(u,G+".state","missing attribute "+_)}),D={},Object.keys(new C).forEach(function(V){D[V]=u.def(G,".",V)})}R(m.link(p),S(p.info.type),D)})}function Ye(m,u,A,L,P,M){for(var S=m.shared,R=S.gl,p={},_,y=0;y<L.length;++y){var D=L[y],G=D.name,V=D.info.type,W=D.info.size,ce=A.uniforms[G];if(W>1){if(!ce)continue;var De=G.replace("[0]","");if(p[De])continue;p[De]=1}var we=m.link(D),be=we+".location",Q;if(ce){if(!P(ce))continue;if(Zr(ce)){var j=ce.value;if(s.command(j!==null&&typeof j!="undefined",'missing uniform "'+G+'"',m.commandStr),V===rn||V===tn){s.command(typeof j=="function"&&(V===rn&&(j._reglType==="texture2d"||j._reglType==="framebuffer")||V===tn&&(j._reglType==="textureCube"||j._reglType==="framebufferCube")),"invalid texture for uniform "+G,m.commandStr);var Ae=m.link(j._texture||j.color[0]._texture);u(R,".uniform1i(",be,",",Ae+".bind());"),u.exit(Ae,".unbind();")}else if(V===Zt||V===Jt||V===en){s.optional(function(){s.command(ar(j),"invalid matrix for uniform "+G,m.commandStr),s.command(V===Zt&&j.length===4||V===Jt&&j.length===9||V===en&&j.length===16,"invalid length for matrix uniform "+G,m.commandStr)});var ge=m.global.def("new Float32Array(["+Array.prototype.slice.call(j)+"])"),Ge=2;V===Jt?Ge=3:V===en&&(Ge=4),u(R,".uniformMatrix",Ge,"fv(",be,",false,",ge,");")}else{switch(V){case Ha:W===1?s.commandType(j,"number","uniform "+G,m.commandStr):s.command(ar(j)&&j.length===W,"uniform "+G,m.commandStr),_="1f";break;case Gn:s.command(ar(j)&&j.length&&j.length%2===0&&j.length<=W*2,"uniform "+G,m.commandStr),_="2f";break;case Dn:s.command(ar(j)&&j.length&&j.length%3===0&&j.length<=W*3,"uniform "+G,m.commandStr),_="3f";break;case In:s.command(ar(j)&&j.length&&j.length%4===0&&j.length<=W*4,"uniform "+G,m.commandStr),_="4f";break;case Wa:W===1?s.commandType(j,"boolean","uniform "+G,m.commandStr):s.command(ar(j)&&j.length===W,"uniform "+G,m.commandStr),_="1i";break;case Ya:W===1?s.commandType(j,"number","uniform "+G,m.commandStr):s.command(ar(j)&&j.length===W,"uniform "+G,m.commandStr),_="1i";break;case kn:s.command(ar(j)&&j.length&&j.length%2===0&&j.length<=W*2,"uniform "+G,m.commandStr),_="2i";break;case Nn:s.command(ar(j)&&j.length&&j.length%2===0&&j.length<=W*2,"uniform "+G,m.commandStr),_="2i";break;case zn:s.command(ar(j)&&j.length&&j.length%3===0&&j.length<=W*3,"uniform "+G,m.commandStr),_="3i";break;case $n:s.command(ar(j)&&j.length&&j.length%3===0&&j.length<=W*3,"uniform "+G,m.commandStr),_="3i";break;case Un:s.command(ar(j)&&j.length&&j.length%4===0&&j.length<=W*4,"uniform "+G,m.commandStr),_="4i";break;case Bn:s.command(ar(j)&&j.length&&j.length%4===0&&j.length<=W*4,"uniform "+G,m.commandStr),_="4i";break}W>1?(_+="v",j=m.global.def("["+Array.prototype.slice.call(j)+"]")):j=ar(j)?Array.prototype.slice.call(j):j,u(R,".uniform",_,"(",be,",",j,");")}continue}else Q=ce.append(m,u)}else{if(!P(rs))continue;Q=u.def(S.uniforms,"[",d.id(G),"]")}V===rn?(s(!Array.isArray(Q),"must specify a scalar prop for textures"),u("if(",Q,"&&",Q,'._reglType==="framebuffer"){',Q,"=",Q,".color[0];","}")):V===tn&&(s(!Array.isArray(Q),"must specify a scalar prop for cube maps"),u("if(",Q,"&&",Q,'._reglType==="framebufferCube"){',Q,"=",Q,".color[0];","}")),s.optional(function(){function Cr(wr,Vn){m.assert(u,wr,'bad data or missing for uniform "'+G+'".  '+Vn)}function pt(wr,Vn){Vn===1&&s(!Array.isArray(Q),"must not specify an array type for uniform"),Cr("Array.isArray("+Q+") && typeof "+Q+'[0]===" '+wr+'" || typeof '+Q+'==="'+wr+'"',"invalid type, expected "+wr)}function Fr(wr,Vn,Xn){Array.isArray(Q)?s(Q.length&&Q.length%wr===0&&Q.length<=wr*Xn,"must have length of "+(Xn===1?"":"n * ")+wr):Cr(S.isArrayLike+"("+Q+")&&"+Q+".length && "+Q+".length % "+wr+" === 0 && "+Q+".length<="+wr*Xn,"invalid vector, should have length of "+(Xn===1?"":"n * ")+wr,m.commandStr)}function cs(wr){s(!Array.isArray(Q),"must not specify a value type"),Cr("typeof "+Q+'==="function"&&'+Q+'._reglType==="texture'+(wr===qf?"2d":"Cube")+'"',"invalid texture type",m.commandStr)}switch(V){case Ya:pt("number",W);break;case Nn:Fr(2,"number",W);break;case $n:Fr(3,"number",W);break;case Bn:Fr(4,"number",W);break;case Ha:pt("number",W);break;case Gn:Fr(2,"number",W);break;case Dn:Fr(3,"number",W);break;case In:Fr(4,"number",W);break;case Wa:pt("boolean",W);break;case kn:Fr(2,"boolean",W);break;case zn:Fr(3,"boolean",W);break;case Un:Fr(4,"boolean",W);break;case Zt:Fr(4,"number",W);break;case Jt:Fr(9,"number",W);break;case en:Fr(16,"number",W);break;case rn:cs(qf);break;case tn:cs(tu);break}});var Qe=1;switch(V){case rn:case tn:var xr=u.def(Q,"._texture");u(R,".uniform1i(",be,",",xr,".bind());"),u.exit(xr,".unbind();");continue;case Ya:case Wa:_="1i";break;case Nn:case kn:_="2i",Qe=2;break;case $n:case zn:_="3i",Qe=3;break;case Bn:case Un:_="4i",Qe=4;break;case Ha:_="1f";break;case Gn:_="2f",Qe=2;break;case Dn:_="3f",Qe=3;break;case In:_="4f",Qe=4;break;case Zt:_="Matrix2fv";break;case Jt:_="Matrix3fv";break;case en:_="Matrix4fv";break}if(_.indexOf("Matrix")===-1&&W>1&&(_+="v",Qe=1),_.charAt(0)==="M"){u(R,".uniform",_,"(",be,",");var ht=Math.pow(V-Zt+2,2),qr=m.global.def("new Float32Array(",ht,")");Array.isArray(Q)?u("false,(",Rr(ht,function(Cr){return qr+"["+Cr+"]="+Q[Cr]}),",",qr,")"):u("false,(Array.isArray(",Q,")||",Q," instanceof Float32Array)?",Q,":(",Rr(ht,function(Cr){return qr+"["+Cr+"]="+Q+"["+Cr+"]"}),",",qr,")"),u(");")}else if(Qe>1){for(var jr=[],Jr=[],mt=0;mt<Qe;++mt)Array.isArray(Q)?Jr.push(Q[mt]):Jr.push(u.def(Q+"["+mt+"]")),M&&jr.push(u.def());M&&u("if(!",m.batchId,"||",jr.map(function(Cr,pt){return Cr+"!=="+Jr[pt]}).join("||"),"){",jr.map(function(Cr,pt){return Cr+"="+Jr[pt]+";"}).join("")),u(R,".uniform",_,"(",be,",",Jr.join(","),");"),M&&u("}")}else{if(s(!Array.isArray(Q),"uniform value must not be an array"),M){var ss=u.def();u("if(!",m.batchId,"||",ss,"!==",Q,"){",ss,"=",Q,";")}u(R,".uniform",_,"(",be,",",Q,");"),M&&u("}")}}}function Ce(m,u,A,L){var P=m.shared,M=P.gl,S=P.draw,R=L.draw;function p(){var Ae=R.elements,ge,Ge=u;return Ae?((Ae.contextDep&&L.contextDynamic||Ae.propDep)&&(Ge=A),ge=Ae.append(m,Ge),R.elementsActive&&Ge("if("+ge+")"+M+".bindBuffer("+qa+","+ge+".buffer.buffer);")):(ge=Ge.def(),Ge(ge,"=",S,".",ot,";","if(",ge,"){",M,".bindBuffer(",qa,",",ge,".buffer.buffer);}","else if(",P.vao,".currentVAO){",ge,"=",m.shared.elements+".getElements("+P.vao,".currentVAO.elements);",K?"":"if("+ge+")"+M+".bindBuffer("+qa+","+ge+".buffer.buffer);","}")),ge}function _(){var Ae=R.count,ge,Ge=u;return Ae?((Ae.contextDep&&L.contextDynamic||Ae.propDep)&&(Ge=A),ge=Ae.append(m,Ge),s.optional(function(){Ae.MISSING&&m.assert(u,"false","missing vertex count"),Ae.DYNAMIC&&m.assert(Ge,ge+">=0","missing vertex count")})):(ge=Ge.def(S,".",ut),s.optional(function(){m.assert(Ge,ge+">=0","missing vertex count")})),ge}var y=p();function D(Ae){var ge=R[Ae];return ge?ge.contextDep&&L.contextDynamic||ge.propDep?ge.append(m,A):ge.append(m,u):u.def(S,".",Ae)}var G=D(lt),V=D(Pn),W=_();if(typeof W=="number"){if(W===0)return}else A("if(",W,"){"),A.exit("}");var ce,De;ne&&(ce=D(Fn),De=m.instancing);var we=y+".type",be=R.elements&&Zr(R.elements)&&!R.vaoActive;function Q(){function Ae(){A(De,".drawElementsInstancedANGLE(",[G,W,we,V+"<<(("+we+"-"+Sf+")>>1)",ce],");")}function ge(){A(De,".drawArraysInstancedANGLE(",[G,V,W,ce],");")}y&&y!=="null"?be?Ae():(A("if(",y,"){"),Ae(),A("}else{"),ge(),A("}")):ge()}function j(){function Ae(){A(M+".drawElements("+[G,W,we,V+"<<(("+we+"-"+Sf+")>>1)"]+");")}function ge(){A(M+".drawArrays("+[G,V,W]+");")}y&&y!=="null"?be?Ae():(A("if(",y,"){"),Ae(),A("}else{"),ge(),A("}")):ge()}ne&&(typeof ce!="number"||ce>=0)?typeof ce=="string"?(A("if(",ce,">0){"),Q(),A("}else if(",ce,"<0){"),j(),A("}")):Q():j()}function Ve(m,u,A,L,P){var M=Ne(),S=M.proc("body",P);return s.optional(function(){M.commandStr=u.commandStr,M.command=M.link(u.commandStr)}),ne&&(M.instancing=S.def(M.shared.extensions,".angle_instanced_arrays")),m(M,S,A,L),M.compile().body}function qe(m,u,A,L){cr(m,u),A.useVAO?A.drawVAO?u(m.shared.vao,".setVAO(",A.drawVAO.append(m,u),");"):u(m.shared.vao,".setVAO(",m.shared.vao,".targetVAO);"):(u(m.shared.vao,".setVAO(null);"),Er(m,u,A,L.attributes,function(){return!0})),Ye(m,u,A,L.uniforms,function(){return!0},!1),Ce(m,u,u,A)}function or(m,u){var A=m.proc("draw",1);cr(m,A),hr(m,A,u.context),mr(m,A,u.framebuffer),yr(m,A,u),_r(m,A,u.state),ke(m,A,u,!1,!0);var L=u.shader.progVar.append(m,A);if(A(m.shared.gl,".useProgram(",L,".program);"),u.shader.program)qe(m,A,u,u.shader.program);else{A(m.shared.vao,".setVAO(null);");var P=m.global.def("{}"),M=A.def(L,".id"),S=A.def(P,"[",M,"]");A(m.cond(S).then(S,".call(this,a0);").else(S,"=",P,"[",M,"]=",m.link(function(R){return Ve(qe,m,u,R,1)}),"(",L,");",S,".call(this,a0);"))}Object.keys(u.state).length>0&&A(m.shared.current,".dirty=true;"),m.shared.vao&&A(m.shared.vao,".setVAO(null);")}function Ur(m,u,A,L){m.batchId="a1",cr(m,u);function P(){return!0}Er(m,u,A,L.attributes,P),Ye(m,u,A,L.uniforms,P,!1),Ce(m,u,u,A)}function dt(m,u,A,L){cr(m,u);var P=A.contextDep,M=u.def(),S="a0",R="a1",p=u.def();m.shared.props=p,m.batchId=M;var _=m.scope(),y=m.scope();u(_.entry,"for(",M,"=0;",M,"<",R,";++",M,"){",p,"=",S,"[",M,"];",y,"}",_.exit);function D(we){return we.contextDep&&P||we.propDep}function G(we){return!D(we)}if(A.needsContext&&hr(m,y,A.context),A.needsFramebuffer&&mr(m,y,A.framebuffer),_r(m,y,A.state,D),A.profile&&D(A.profile)&&ke(m,y,A,!1,!0),L)A.useVAO?A.drawVAO?D(A.drawVAO)?y(m.shared.vao,".setVAO(",A.drawVAO.append(m,y),");"):_(m.shared.vao,".setVAO(",A.drawVAO.append(m,_),");"):_(m.shared.vao,".setVAO(",m.shared.vao,".targetVAO);"):(_(m.shared.vao,".setVAO(null);"),Er(m,_,A,L.attributes,G),Er(m,y,A,L.attributes,D)),Ye(m,_,A,L.uniforms,G,!1),Ye(m,y,A,L.uniforms,D,!0),Ce(m,_,y,A);else{var V=m.global.def("{}"),W=A.shader.progVar.append(m,y),ce=y.def(W,".id"),De=y.def(V,"[",ce,"]");y(m.shared.gl,".useProgram(",W,".program);","if(!",De,"){",De,"=",V,"[",ce,"]=",m.link(function(we){return Ve(Ur,m,A,we,2)}),"(",W,");}",De,".call(this,a0[",M,"],",M,");")}}function b(m,u){var A=m.proc("batch",2);m.batchId="0",cr(m,A);var L=!1,P=!0;Object.keys(u.context).forEach(function(V){L=L||u.context[V].propDep}),L||(hr(m,A,u.context),P=!1);var M=u.framebuffer,S=!1;M?(M.propDep?L=S=!0:M.contextDep&&L&&(S=!0),S||mr(m,A,M)):mr(m,A,null),u.state.viewport&&u.state.viewport.propDep&&(L=!0);function R(V){return V.contextDep&&L||V.propDep}yr(m,A,u),_r(m,A,u.state,function(V){return!R(V)}),(!u.profile||!R(u.profile))&&ke(m,A,u,!1,"a1"),u.contextDep=L,u.needsContext=P,u.needsFramebuffer=S;var p=u.shader.progVar;if(p.contextDep&&L||p.propDep)dt(m,A,u,null);else{var _=p.append(m,A);if(A(m.shared.gl,".useProgram(",_,".program);"),u.shader.program)dt(m,A,u,u.shader.program);else{A(m.shared.vao,".setVAO(null);");var y=m.global.def("{}"),D=A.def(_,".id"),G=A.def(y,"[",D,"]");A(m.cond(G).then(G,".call(this,a0,a1);").else(G,"=",y,"[",D,"]=",m.link(function(V){return Ve(dt,m,u,V,2)}),"(",_,");",G,".call(this,a0,a1);"))}}Object.keys(u.state).length>0&&A(m.shared.current,".dirty=true;"),m.shared.vao&&A(m.shared.vao,".setVAO(null);")}function B(m,u){var A=m.proc("scope",3);m.batchId="a2";var L=m.shared,P=L.current;hr(m,A,u.context),u.framebuffer&&u.framebuffer.append(m,A),es(Object.keys(u.state)).forEach(function(S){var R=u.state[S],p=R.append(m,A);ar(p)?p.forEach(function(_,y){A.set(m.next[S],"["+y+"]",_)}):A.set(L.next,"."+S,p)}),ke(m,A,u,!0,!0),[ot,Pn,ut,Fn,lt].forEach(function(S){var R=u.draw[S];!R||A.set(L.draw,"."+S,""+R.append(m,A))}),Object.keys(u.uniforms).forEach(function(S){var R=u.uniforms[S].append(m,A);Array.isArray(R)&&(R="["+R.join()+"]"),A.set(L.uniforms,"["+d.id(S)+"]",R)}),Object.keys(u.attributes).forEach(function(S){var R=u.attributes[S].append(m,A),p=m.scopeAttrib(S);Object.keys(new C).forEach(function(_){A.set(p,"."+_,R[_])})}),u.scopeVAO&&A.set(L.vao,".targetVAO",u.scopeVAO.append(m,A));function M(S){var R=u.shader[S];R&&A.set(L.shader,"."+S,R.append(m,A))}M(Wt),M(Qt),Object.keys(u.state).length>0&&(A(P,".dirty=true;"),A.exit(P,".dirty=true;")),A("a1(",m.shared.context,",a0,",m.batchId,");")}function I(m){if(!(typeof m!="object"||ar(m))){for(var u=Object.keys(m),A=0;A<u.length;++A)if(Or.isDynamic(m[u[A]]))return!0;return!1}}function _e(m,u,A){var L=u.static[A];if(!L||!I(L))return;var P=m.global,M=Object.keys(L),S=!1,R=!1,p=!1,_=m.global.def("{}");M.forEach(function(D){var G=L[D];if(Or.isDynamic(G)){typeof G=="function"&&(G=L[D]=Or.unbox(G));var V=Mr(G,null);S=S||V.thisDep,p=p||V.propDep,R=R||V.contextDep}else{switch(P(_,".",D,"="),typeof G){case"number":P(G);break;case"string":P('"',G,'"');break;case"object":Array.isArray(G)&&P("[",G.join(),"]");break;default:P(m.link(G));break}P(";")}});function y(D,G){M.forEach(function(V){var W=L[V];if(!!Or.isDynamic(W)){var ce=D.invoke(G,W);G(_,".",V,"=",ce,";")}})}u.dynamic[A]=new Or.DynamicVariable(Ln,{thisDep:S,contextDep:R,propDep:p,ref:_,append:y}),delete u.static[A]}function Ue(m,u,A,L,P){var M=Ne();M.stats=M.link(P),Object.keys(u.static).forEach(function(R){_e(M,u,R)}),Jl.forEach(function(R){_e(M,m,R)});var S=vr(m,u,A,L,M);return or(M,S),B(M,S),b(M,S),n(M.compile(),{destroy:function(){S.shader.program.destroy()}})}return{next:de,current:me,procs:function(){var m=Ne(),u=m.proc("poll"),A=m.proc("refresh"),L=m.block();u(L),A(L);var P=m.shared,M=P.gl,S=P.next,R=P.current;L(R,".dirty=false;"),mr(m,u),mr(m,A,null,!0);var p;ne&&(p=m.link(ne)),x.oes_vertex_array_object&&A(m.link(x.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var _=0;_<$.maxAttributes;++_){var y=A.def(P.attributes,"[",_,"]"),D=m.cond(y,".buffer");D.then(M,".enableVertexAttribArray(",_,");",M,".bindBuffer(",Nt,",",y,".buffer.buffer);",M,".vertexAttribPointer(",_,",",y,".size,",y,".type,",y,".normalized,",y,".stride,",y,".offset);").else(M,".disableVertexAttribArray(",_,");",M,".vertexAttrib4f(",_,",",y,".x,",y,".y,",y,".z,",y,".w);",y,".buffer=null;"),A(D),ne&&A(p,".vertexAttribDivisorANGLE(",_,",",y,".divisor);")}return A(m.shared.vao,".currentVAO=null;",m.shared.vao,".setVAO(",m.shared.vao,".targetVAO);"),Object.keys(Y).forEach(function(G){var V=Y[G],W=L.def(S,".",G),ce=m.block();ce("if(",W,"){",M,".enable(",V,")}else{",M,".disable(",V,")}",R,".",G,"=",W,";"),A(ce),u("if(",W,"!==",R,".",G,"){",ce,"}")}),Object.keys(X).forEach(function(G){var V=X[G],W=me[G],ce,De,we=m.block();if(we(M,".",V,"("),ar(W)){var be=W.length;ce=m.global.def(S,".",G),De=m.global.def(R,".",G),we(Rr(be,function(Q){return ce+"["+Q+"]"}),");",Rr(be,function(Q){return De+"["+Q+"]="+ce+"["+Q+"];"}).join("")),u("if(",Rr(be,function(Q){return ce+"["+Q+"]!=="+De+"["+Q+"]"}).join("||"),"){",we,"}")}else ce=L.def(S,".",G),De=L.def(R,".",G),we(ce,");",R,".",G,"=",ce,";"),u("if(",ce,"!==",De,"){",we,"}");A(we)}),m.compile()}(),compile:Ue}}function bu(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var _u=34918,Eu=34919,ts=35007,xu=function(i,d){if(!d.ext_disjoint_timer_query)return null;var x=[];function $(){return x.pop()||d.ext_disjoint_timer_query.createQueryEXT()}function q(ne){x.push(ne)}var N=[];function z(ne){var ye=$();d.ext_disjoint_timer_query.beginQueryEXT(ts,ye),N.push(ye),ee(N.length-1,N.length,ne)}function J(){d.ext_disjoint_timer_query.endQueryEXT(ts)}function Z(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var ie=[];function se(){return ie.pop()||new Z}function fe(ne){ie.push(ne)}var oe=[];function ee(ne,ye,K){var me=se();me.startQueryIndex=ne,me.endQueryIndex=ye,me.sum=0,me.stats=K,oe.push(me)}var ae=[],C=[];function k(){var ne,ye,K=N.length;if(K!==0){C.length=Math.max(C.length,K+1),ae.length=Math.max(ae.length,K+1),ae[0]=0,C[0]=0;var me=0;for(ne=0,ye=0;ye<N.length;++ye){var de=N[ye];d.ext_disjoint_timer_query.getQueryObjectEXT(de,Eu)?(me+=d.ext_disjoint_timer_query.getQueryObjectEXT(de,_u),q(de)):N[ne++]=de,ae[ye+1]=me,C[ye+1]=ne}for(N.length=ne,ne=0,ye=0;ye<oe.length;++ye){var Oe=oe[ye],Y=Oe.startQueryIndex,X=Oe.endQueryIndex;Oe.sum+=ae[X]-ae[Y];var xe=C[Y],le=C[X];le===xe?(Oe.stats.gpuTime+=Oe.sum/1e6,fe(Oe)):(Oe.startQueryIndex=xe,Oe.endQueryIndex=le,oe[ne++]=Oe)}oe.length=ne}}return{beginQuery:z,endQuery:J,pushScopeStats:ee,update:k,getNumPendingQueries:function(){return N.length},clear:function(){x.push.apply(x,N);for(var ne=0;ne<x.length;ne++)d.ext_disjoint_timer_query.deleteQueryEXT(x[ne]);N.length=0,x.length=0},restore:function(){N.length=0,x.length=0}}},Tu=16384,gu=256,Au=1024,Su=34962,ns="webglcontextlost",as="webglcontextrestored",is=1,Mu=2,wu=3;function fs(i,d){for(var x=0;x<i.length;++x)if(i[x]===d)return x;return-1}function Ou(i){var d=Sc(i);if(!d)return null;var x=d.gl,$=x.getContextAttributes(),q=x.isContextLost(),N=Mc(x,d);if(!N)return null;var z=Ec(),J=bu(),Z=N.extensions,ie=xu(x,Z),se=di(),fe=x.drawingBufferWidth,oe=x.drawingBufferHeight,ee={tick:0,time:0,viewportWidth:fe,viewportHeight:oe,framebufferWidth:fe,framebufferHeight:oe,drawingBufferWidth:fe,drawingBufferHeight:oe,pixelRatio:d.pixelRatio},ae={},C={elements:null,primitive:4,count:-1,offset:0,instances:-1},k=ho(x,Z),ne=Lo(x,J,d,me),ye=Uo(x,Z,ne,J),K=Ul(x,Z,k,J,ne,ye,C);function me(Ce){return K.destroyBuffer(Ce)}var de=ql(x,z,J,d),Oe=_l(x,Z,k,function(){xe.procs.poll()},ee,J,d),Y=El(x,Z,k,J,d),X=kl(x,Z,k,Oe,Y,J),xe=yu(x,z,Z,k,ne,ye,Oe,X,ae,K,de,C,ee,ie,d),le=Wl(x,X,xe.procs.poll,ee,$,Z,k),te=xe.next,ue=x.canvas,ve=[],$e=[],Ne=[],he=[d.onDestroy],pe=null;function Fe(){if(ve.length===0){ie&&ie.update(),pe=null;return}pe=ta.next(Fe),_r();for(var Ce=ve.length-1;Ce>=0;--Ce){var Ve=ve[Ce];Ve&&Ve(ee,null,0)}x.flush(),ie&&ie.update()}function Be(){!pe&&ve.length>0&&(pe=ta.next(Fe))}function je(){pe&&(ta.cancel(Fe),pe=null)}function ir(Ce){Ce.preventDefault(),q=!0,je(),$e.forEach(function(Ve){Ve()})}function sr(Ce){x.getError(),q=!1,N.restore(),de.restore(),ne.restore(),Oe.restore(),Y.restore(),X.restore(),K.restore(),ie&&ie.restore(),xe.procs.refresh(),Be(),Ne.forEach(function(Ve){Ve()})}ue&&(ue.addEventListener(ns,ir,!1),ue.addEventListener(as,sr,!1));function Xe(){ve.length=0,je(),ue&&(ue.removeEventListener(ns,ir),ue.removeEventListener(as,sr)),de.clear(),X.clear(),Y.clear(),K.clear(),Oe.clear(),ye.clear(),ne.clear(),ie&&ie.clear(),he.forEach(function(Ce){Ce()})}function dr(Ce){s(!!Ce,"invalid args to regl({...})"),s.type(Ce,"object","invalid args to regl({...})");function Ve(P){var M=n({},P);delete M.uniforms,delete M.attributes,delete M.context,delete M.vao,"stencil"in M&&M.stencil.op&&(M.stencil.opBack=M.stencil.opFront=M.stencil.op,delete M.stencil.op);function S(R){if(R in M){var p=M[R];delete M[R],Object.keys(p).forEach(function(_){M[R+"."+_]=p[_]})}}return S("blend"),S("depth"),S("cull"),S("stencil"),S("polygonOffset"),S("scissor"),S("sample"),"vao"in P&&(M.vao=P.vao),M}function qe(P,M){var S={},R={};return Object.keys(P).forEach(function(p){var _=P[p];if(Or.isDynamic(_)){R[p]=Or.unbox(_,p);return}else if(M&&Array.isArray(_)){for(var y=0;y<_.length;++y)if(Or.isDynamic(_[y])){R[p]=Or.unbox(_,p);return}}S[p]=_}),{dynamic:R,static:S}}var or=qe(Ce.context||{},!0),Ur=qe(Ce.uniforms||{},!0),dt=qe(Ce.attributes||{},!1),b=qe(Ve(Ce),!1),B={gpuTime:0,cpuTime:0,count:0},I=xe.compile(b,dt,Ur,or,B),_e=I.draw,Ue=I.batch,m=I.scope,u=[];function A(P){for(;u.length<P;)u.push(null);return u}function L(P,M){var S;if(q&&s.raise("context lost"),typeof P=="function")return m.call(this,null,P,0);if(typeof M=="function")if(typeof P=="number")for(S=0;S<P;++S)m.call(this,null,M,S);else if(Array.isArray(P))for(S=0;S<P.length;++S)m.call(this,P[S],M,S);else return m.call(this,P,M,0);else if(typeof P=="number"){if(P>0)return Ue.call(this,A(P|0),P|0)}else if(Array.isArray(P)){if(P.length)return Ue.call(this,P,P.length)}else return _e.call(this,P)}return n(L,{stats:B,destroy:function(){I.destroy()}})}var rr=X.setFBO=dr({framebuffer:Or.define.call(null,is,"framebuffer")});function vr(Ce,Ve){var qe=0;xe.procs.poll();var or=Ve.color;or&&(x.clearColor(+or[0]||0,+or[1]||0,+or[2]||0,+or[3]||0),qe|=Tu),"depth"in Ve&&(x.clearDepth(+Ve.depth),qe|=gu),"stencil"in Ve&&(x.clearStencil(Ve.stencil|0),qe|=Au),s(!!qe,"called regl.clear with no buffer specified"),x.clear(qe)}function hr(Ce){if(s(typeof Ce=="object"&&Ce,"regl.clear() takes an object as input"),"framebuffer"in Ce)if(Ce.framebuffer&&Ce.framebuffer_reglType==="framebufferCube")for(var Ve=0;Ve<6;++Ve)rr(n({framebuffer:Ce.framebuffer.faces[Ve]},Ce),vr);else rr(Ce,vr);else vr(null,Ce)}function mr(Ce){s.type(Ce,"function","regl.frame() callback must be a function"),ve.push(Ce);function Ve(){var qe=fs(ve,Ce);s(qe>=0,"cannot cancel a frame twice");function or(){var Ur=fs(ve,or);ve[Ur]=ve[ve.length-1],ve.length-=1,ve.length<=0&&je()}ve[qe]=or}return Be(),{cancel:Ve}}function yr(){var Ce=te.viewport,Ve=te.scissor_box;Ce[0]=Ce[1]=Ve[0]=Ve[1]=0,ee.viewportWidth=ee.framebufferWidth=ee.drawingBufferWidth=Ce[2]=Ve[2]=x.drawingBufferWidth,ee.viewportHeight=ee.framebufferHeight=ee.drawingBufferHeight=Ce[3]=Ve[3]=x.drawingBufferHeight}function _r(){ee.tick+=1,ee.time=ke(),yr(),xe.procs.poll()}function cr(){Oe.refresh(),yr(),xe.procs.refresh(),ie&&ie.update()}function ke(){return(di()-se)/1e3}cr();function Er(Ce,Ve){s.type(Ve,"function","listener callback must be a function");var qe;switch(Ce){case"frame":return mr(Ve);case"lost":qe=$e;break;case"restore":qe=Ne;break;case"destroy":qe=he;break;default:s.raise("invalid event, must be one of frame,lost,restore,destroy")}return qe.push(Ve),{cancel:function(){for(var or=0;or<qe.length;++or)if(qe[or]===Ve){qe[or]=qe[qe.length-1],qe.pop();return}}}}var Ye=n(dr,{clear:hr,prop:Or.define.bind(null,is),context:Or.define.bind(null,Mu),this:Or.define.bind(null,wu),draw:dr({}),buffer:function(Ce){return ne.create(Ce,Su,!1,!1)},elements:function(Ce){return ye.create(Ce,!1)},texture:Oe.create2D,cube:Oe.createCube,renderbuffer:Y.create,framebuffer:X.create,framebufferCube:X.createCube,vao:K.createVAO,attributes:$,frame:mr,on:Er,limits:k,hasExtension:function(Ce){return k.extensions.indexOf(Ce.toLowerCase())>=0},read:le,destroy:Xe,_gl:x,_refresh:cr,poll:function(){_r(),ie&&ie.update()},now:ke,stats:J});return d.onDone(null,Ye),Ye}return Ou})})(vs);var Cu=vs.exports,Pu={exports:{}};/*!
 * PEP v0.4.3 | https://github.com/jquery/PEP
 * Copyright jQuery Foundation and other contributors | http://jquery.org/license
 */(function(e,r){(function(t,n){e.exports=n()})(us,function(){var t=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],n=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0];function a(v,g){g=g||Object.create(null);var s=document.createEvent("Event");s.initEvent(v,g.bubbles||!1,g.cancelable||!1);for(var Ee=2,ze;Ee<t.length;Ee++)ze=t[Ee],s[ze]=g[ze]||n[Ee];s.buttons=g.buttons||0;var fr=0;return g.pressure&&s.buttons?fr=g.pressure:fr=s.buttons?.5:0,s.x=s.clientX,s.y=s.clientY,s.pointerId=g.pointerId||0,s.width=g.width||0,s.height=g.height||0,s.pressure=fr,s.tiltX=g.tiltX||0,s.tiltY=g.tiltY||0,s.twist=g.twist||0,s.tangentialPressure=g.tangentialPressure||0,s.pointerType=g.pointerType||"",s.hwTimestamp=g.hwTimestamp||0,s.isPrimary=g.isPrimary||!1,s}var f=window.Map&&window.Map.prototype.forEach,o=f?Map:c;function c(){this.array=[],this.size=0}c.prototype={set:function(v,g){if(g===void 0)return this.delete(v);this.has(v)||this.size++,this.array[v]=g},has:function(v){return this.array[v]!==void 0},delete:function(v){this.has(v)&&(delete this.array[v],this.size--)},get:function(v){return this.array[v]},clear:function(){this.array.length=0,this.size=0},forEach:function(v,g){return this.array.forEach(function(s,Ee){v.call(g,s,Ee,this)},this)}};var l=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],h=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],E={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},O=typeof SVGElementInstance!="undefined",T={pointermap:new o,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(v,g){var s=g,Ee=s.events;Ee&&(Ee.forEach(function(ze){s[ze]&&(this.eventMap[ze]=s[ze].bind(s))},this),this.eventSources[v]=s,this.eventSourceList.push(s))},register:function(v){for(var g=this.eventSourceList.length,s=0,Ee;s<g&&(Ee=this.eventSourceList[s]);s++)Ee.register.call(Ee,v)},unregister:function(v){for(var g=this.eventSourceList.length,s=0,Ee;s<g&&(Ee=this.eventSourceList[s]);s++)Ee.unregister.call(Ee,v)},contains:function(v,g){try{return v.contains(g)}catch{return!1}},down:function(v){v.bubbles=!0,this.fireEvent("pointerdown",v)},move:function(v){v.bubbles=!0,this.fireEvent("pointermove",v)},up:function(v){v.bubbles=!0,this.fireEvent("pointerup",v)},enter:function(v){v.bubbles=!1,this.fireEvent("pointerenter",v)},leave:function(v){v.bubbles=!1,this.fireEvent("pointerleave",v)},over:function(v){v.bubbles=!0,this.fireEvent("pointerover",v)},out:function(v){v.bubbles=!0,this.fireEvent("pointerout",v)},cancel:function(v){v.bubbles=!0,this.fireEvent("pointercancel",v)},leaveOut:function(v){this.out(v),this.propagate(v,this.leave,!1)},enterOver:function(v){this.over(v),this.propagate(v,this.enter,!0)},eventHandler:function(v){if(!v._handledByPE){var g=v.type,s=this.eventMap&&this.eventMap[g];s&&s(v),v._handledByPE=!0}},listen:function(v,g){g.forEach(function(s){this.addEvent(v,s)},this)},unlisten:function(v,g){g.forEach(function(s){this.removeEvent(v,s)},this)},addEvent:function(v,g){v.addEventListener(g,this.boundHandler)},removeEvent:function(v,g){v.removeEventListener(g,this.boundHandler)},makeEvent:function(v,g){this.captureInfo[g.pointerId]&&(g.relatedTarget=null);var s=new a(v,g);return g.preventDefault&&(s.preventDefault=g.preventDefault),s._target=s._target||g.target,s},fireEvent:function(v,g){var s=this.makeEvent(v,g);return this.dispatchEvent(s)},cloneEvent:function(v){for(var g=Object.create(null),s,Ee=0;Ee<l.length;Ee++)s=l[Ee],g[s]=v[s]||h[Ee],O&&(s==="target"||s==="relatedTarget")&&g[s]instanceof SVGElementInstance&&(g[s]=g[s].correspondingUseElement);return v.preventDefault&&(g.preventDefault=function(){v.preventDefault()}),g},getTarget:function(v){var g=this.captureInfo[v.pointerId];if(!g)return v._target;if(v._target===g||!(v.type in E))return g},propagate:function(v,g,s){for(var Ee=v.target,ze=[];Ee!==document&&!Ee.contains(v.relatedTarget);)if(ze.push(Ee),Ee=Ee.parentNode,!Ee)return;s&&ze.reverse(),ze.forEach(function(fr){v.target=fr,g.call(this,v)},this)},setCapture:function(v,g,s){this.captureInfo[v]&&this.releaseCapture(v,s),this.captureInfo[v]=g,this.implicitRelease=this.releaseCapture.bind(this,v,s),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var Ee=new a("gotpointercapture");Ee.pointerId=v,Ee._target=g,s||this.asyncDispatchEvent(Ee)},releaseCapture:function(v,g){var s=this.captureInfo[v];if(!!s){this.captureInfo[v]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var Ee=new a("lostpointercapture");Ee.pointerId=v,Ee._target=s,g||this.asyncDispatchEvent(Ee)}},dispatchEvent:function(v){var g=this.getTarget(v);if(g)return g.dispatchEvent(v)},asyncDispatchEvent:function(v){requestAnimationFrame(this.dispatchEvent.bind(this,v))}};T.boundHandler=T.eventHandler.bind(T);var w={shadow:function(v){if(v)return v.shadowRoot||v.webkitShadowRoot},canTarget:function(v){return v&&Boolean(v.elementFromPoint)},targetingShadow:function(v){var g=this.shadow(v);if(this.canTarget(g))return g},olderShadow:function(v){var g=v.olderShadowRoot;if(!g){var s=v.querySelector("shadow");s&&(g=s.olderShadowRoot)}return g},allShadows:function(v){for(var g=[],s=this.shadow(v);s;)g.push(s),s=this.olderShadow(s);return g},searchRoot:function(v,g,s){if(v){var Ee=v.elementFromPoint(g,s),ze,fr;for(fr=this.targetingShadow(Ee);fr;)if(ze=fr.elementFromPoint(g,s),!ze)fr=this.olderShadow(fr);else{var Dr=this.targetingShadow(ze);return this.searchRoot(Dr,g,s)||ze}return Ee}},owner:function(v){for(var g=v;g.parentNode;)g=g.parentNode;return g.nodeType!==Node.DOCUMENT_NODE&&g.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(g=document),g},findTarget:function(v){var g=v.clientX,s=v.clientY,Ee=this.owner(v.target);return Ee.elementFromPoint(g,s)||(Ee=document),this.searchRoot(Ee,g,s)}},U=Array.prototype.forEach.call.bind(Array.prototype.forEach),H=Array.prototype.map.call.bind(Array.prototype.map),F=Array.prototype.slice.call.bind(Array.prototype.slice),re=Array.prototype.filter.call.bind(Array.prototype.filter),Te=window.MutationObserver||window.WebKitMutationObserver,Se="[touch-action]",Re={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};function Me(v,g,s,Ee){this.addCallback=v.bind(Ee),this.removeCallback=g.bind(Ee),this.changedCallback=s.bind(Ee),Te&&(this.observer=new Te(this.mutationWatcher.bind(this)))}Me.prototype={watchSubtree:function(v){this.observer&&w.canTarget(v)&&this.observer.observe(v,Re)},enableOnSubtree:function(v){this.watchSubtree(v),v===document&&document.readyState!=="complete"?this.installOnLoad():this.installNewSubtree(v)},installNewSubtree:function(v){U(this.findElements(v),this.addElement,this)},findElements:function(v){return v.querySelectorAll?v.querySelectorAll(Se):[]},removeElement:function(v){this.removeCallback(v)},addElement:function(v){this.addCallback(v)},elementChanged:function(v,g){this.changedCallback(v,g)},concatLists:function(v,g){return v.concat(F(g))},installOnLoad:function(){document.addEventListener("readystatechange",function(){document.readyState==="complete"&&this.installNewSubtree(document)}.bind(this))},isElement:function(v){return v.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(v){var g=H(v,this.findElements,this);return g.push(re(v,this.isElement)),g.reduce(this.concatLists,[])},mutationWatcher:function(v){v.forEach(this.mutationHandler,this)},mutationHandler:function(v){if(v.type==="childList"){var g=this.flattenMutationTree(v.addedNodes);g.forEach(this.addElement,this);var s=this.flattenMutationTree(v.removedNodes);s.forEach(this.removeElement,this)}else v.type==="attributes"&&this.elementChanged(v.target,v.oldValue)}};function Le(v){return"body /shadow-deep/ "+Ke(v)}function Ke(v){return'[touch-action="'+v+'"]'}function Ze(v){return"{ -ms-touch-action: "+v+"; touch-action: "+v+"; }"}var er=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],We="",tr=window.PointerEvent||window.MSPointerEvent,Je=!window.ShadowDOMPolyfill&&document.head.createShadowRoot;function nr(){if(tr){er.forEach(function(g){String(g)===g?(We+=Ke(g)+Ze(g)+`
`,Je&&(We+=Le(g)+Ze(g)+`
`)):(We+=g.selectors.map(Ke)+Ze(g.rule)+`
`,Je&&(We+=g.selectors.map(Le)+Ze(g.rule)+`
`))});var v=document.createElement("style");v.textContent=We,document.head.appendChild(v)}}var Ie=T.pointermap,Tr=25,Gr=[1,4,2,8,16],Ar=!1;try{Ar=new MouseEvent("test",{buttons:1}).buttons===1}catch{}var et={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(v){T.listen(v,this.events)},unregister:function(v){T.unlisten(v,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(v){for(var g=this.lastTouches,s=v.clientX,Ee=v.clientY,ze=0,fr=g.length,Dr;ze<fr&&(Dr=g[ze]);ze++){var Sr=Math.abs(s-Dr.x),dn=Math.abs(Ee-Dr.y);if(Sr<=Tr&&dn<=Tr)return!0}},prepareEvent:function(v){var g=T.cloneEvent(v),s=g.preventDefault;return g.preventDefault=function(){v.preventDefault(),s()},g.pointerId=this.POINTER_ID,g.isPrimary=!0,g.pointerType=this.POINTER_TYPE,g},prepareButtonsForMove:function(v,g){var s=Ie.get(this.POINTER_ID);g.which===0||!s?v.buttons=0:v.buttons=s.buttons,g.buttons=v.buttons},mousedown:function(v){if(!this.isEventSimulatedFromTouch(v)){var g=Ie.get(this.POINTER_ID),s=this.prepareEvent(v);Ar||(s.buttons=Gr[s.button],g&&(s.buttons|=g.buttons),v.buttons=s.buttons),Ie.set(this.POINTER_ID,v),!g||g.buttons===0?T.down(s):T.move(s)}},mousemove:function(v){if(!this.isEventSimulatedFromTouch(v)){var g=this.prepareEvent(v);Ar||this.prepareButtonsForMove(g,v),g.button=-1,Ie.set(this.POINTER_ID,v),T.move(g)}},mouseup:function(v){if(!this.isEventSimulatedFromTouch(v)){var g=Ie.get(this.POINTER_ID),s=this.prepareEvent(v);if(!Ar){var Ee=Gr[s.button];s.buttons=g?g.buttons&~Ee:0,v.buttons=s.buttons}Ie.set(this.POINTER_ID,v),s.buttons&=~Gr[s.button],s.buttons===0?T.up(s):T.move(s)}},mouseover:function(v){if(!this.isEventSimulatedFromTouch(v)){var g=this.prepareEvent(v);Ar||this.prepareButtonsForMove(g,v),g.button=-1,Ie.set(this.POINTER_ID,v),T.enterOver(g)}},mouseout:function(v){if(!this.isEventSimulatedFromTouch(v)){var g=this.prepareEvent(v);Ar||this.prepareButtonsForMove(g,v),g.button=-1,T.leaveOut(g)}},cancel:function(v){var g=this.prepareEvent(v);T.cancel(g),this.deactivateMouse()},deactivateMouse:function(){Ie.delete(this.POINTER_ID)}},bt=T.captureInfo,_t=w.findTarget.bind(w),Et=w.allShadows.bind(w),Br=T.pointermap,Kn=2500,Zn=200,sn="touch-action",cn,rt={events:["touchstart","touchmove","touchend","touchcancel"],register:function(v){cn.enableOnSubtree(v)},unregister:function(){},elementAdded:function(v){var g=v.getAttribute(sn),s=this.touchActionToScrollType(g);s&&(v._scrollType=s,T.listen(v,this.events),Et(v).forEach(function(Ee){Ee._scrollType=s,T.listen(Ee,this.events)},this))},elementRemoved:function(v){v._scrollType=void 0,T.unlisten(v,this.events),Et(v).forEach(function(g){g._scrollType=void 0,T.unlisten(g,this.events)},this)},elementChanged:function(v,g){var s=v.getAttribute(sn),Ee=this.touchActionToScrollType(s),ze=this.touchActionToScrollType(g);Ee&&ze?(v._scrollType=Ee,Et(v).forEach(function(fr){fr._scrollType=Ee},this)):ze?this.elementRemoved(v):Ee&&this.elementAdded(v)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(v){var g=v,s=this.scrollTypes;if(g==="none")return"none";if(g===s.XSCROLLER)return"X";if(g===s.YSCROLLER)return"Y";if(s.SCROLLER.exec(g))return"XY"},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(v){return this.firstTouch===v.identifier},setPrimaryTouch:function(v){(Br.size===0||Br.size===1&&Br.has(1))&&(this.firstTouch=v.identifier,this.firstXY={X:v.clientX,Y:v.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(v){v.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var v=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(v,Zn)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(v){var g=0;return(v==="touchstart"||v==="touchmove")&&(g=1),g},touchToPointer:function(v){var g=this.currentTouchEvent,s=T.cloneEvent(v),Ee=s.pointerId=v.identifier+2;s.target=bt[Ee]||_t(s),s.bubbles=!0,s.cancelable=!0,s.detail=this.clickCount,s.button=0,s.buttons=this.typeToButtons(g.type),s.width=(v.radiusX||v.webkitRadiusX||0)*2,s.height=(v.radiusY||v.webkitRadiusY||0)*2,s.pressure=v.force||v.webkitForce||.5,s.isPrimary=this.isPrimaryTouch(v),s.pointerType=this.POINTER_TYPE,s.altKey=g.altKey,s.ctrlKey=g.ctrlKey,s.metaKey=g.metaKey,s.shiftKey=g.shiftKey;var ze=this;return s.preventDefault=function(){ze.scrolling=!1,ze.firstXY=null,g.preventDefault()},s},processTouches:function(v,g){var s=v.changedTouches;this.currentTouchEvent=v;for(var Ee=0,ze;Ee<s.length;Ee++)ze=s[Ee],g.call(this,this.touchToPointer(ze))},shouldScroll:function(v){if(this.firstXY){var g,s=v.currentTarget._scrollType;if(s==="none")g=!1;else if(s==="XY")g=!0;else{var Ee=v.changedTouches[0],ze=s,fr=s==="Y"?"X":"Y",Dr=Math.abs(Ee["client"+ze]-this.firstXY[ze]),Sr=Math.abs(Ee["client"+fr]-this.firstXY[fr]);g=Dr>=Sr}return this.firstXY=null,g}},findTouch:function(v,g){for(var s=0,Ee=v.length,ze;s<Ee&&(ze=v[s]);s++)if(ze.identifier===g)return!0},vacuumTouches:function(v){var g=v.touches;if(Br.size>=g.length){var s=[];Br.forEach(function(Ee,ze){if(ze!==1&&!this.findTouch(g,ze-2)){var fr=Ee.out;s.push(fr)}},this),s.forEach(this.cancelOut,this)}},touchstart:function(v){this.vacuumTouches(v),this.setPrimaryTouch(v.changedTouches[0]),this.dedupSynthMouse(v),this.scrolling||(this.clickCount++,this.processTouches(v,this.overDown))},overDown:function(v){Br.set(v.pointerId,{target:v.target,out:v,outTarget:v.target}),T.enterOver(v),T.down(v)},touchmove:function(v){this.scrolling||(this.shouldScroll(v)?(this.scrolling=!0,this.touchcancel(v)):(v.preventDefault(),this.processTouches(v,this.moveOverOut)))},moveOverOut:function(v){var g=v,s=Br.get(g.pointerId);if(!!s){var Ee=s.out,ze=s.outTarget;T.move(g),Ee&&ze!==g.target&&(Ee.relatedTarget=g.target,g.relatedTarget=ze,Ee.target=ze,g.target?(T.leaveOut(Ee),T.enterOver(g)):(g.target=ze,g.relatedTarget=null,this.cancelOut(g))),s.out=g,s.outTarget=g.target}},touchend:function(v){this.dedupSynthMouse(v),this.processTouches(v,this.upOut)},upOut:function(v){this.scrolling||(T.up(v),T.leaveOut(v)),this.cleanUpPointer(v)},touchcancel:function(v){this.processTouches(v,this.cancelOut)},cancelOut:function(v){T.cancel(v),T.leaveOut(v),this.cleanUpPointer(v)},cleanUpPointer:function(v){Br.delete(v.pointerId),this.removePrimaryPointer(v)},dedupSynthMouse:function(v){var g=et.lastTouches,s=v.changedTouches[0];if(this.isPrimaryTouch(s)){var Ee={x:s.clientX,y:s.clientY};g.push(Ee);var ze=function(fr,Dr){var Sr=fr.indexOf(Dr);Sr>-1&&fr.splice(Sr,1)}.bind(null,g,Ee);setTimeout(ze,Kn)}}};cn=new Me(rt.elementAdded,rt.elementRemoved,rt.elementChanged,rt);var on=T.pointermap,Jn=window.MSPointerEvent&&typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE=="number",ea={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(v){T.listen(v,this.events)},unregister:function(v){T.unlisten(v,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(v){var g=v;return Jn&&(g=T.cloneEvent(v),g.pointerType=this.POINTER_TYPES[v.pointerType]),g},cleanup:function(v){on.delete(v)},MSPointerDown:function(v){on.set(v.pointerId,v);var g=this.prepareEvent(v);T.down(g)},MSPointerMove:function(v){var g=this.prepareEvent(v);T.move(g)},MSPointerUp:function(v){var g=this.prepareEvent(v);T.up(g),this.cleanup(v.pointerId)},MSPointerOut:function(v){var g=this.prepareEvent(v);T.leaveOut(g)},MSPointerOver:function(v){var g=this.prepareEvent(v);T.enterOver(g)},MSPointerCancel:function(v){var g=this.prepareEvent(v);T.cancel(g),this.cleanup(v.pointerId)},MSLostPointerCapture:function(v){var g=T.makeEvent("lostpointercapture",v);T.dispatchEvent(g)},MSGotPointerCapture:function(v){var g=T.makeEvent("gotpointercapture",v);T.dispatchEvent(g)}};function ra(){if(!window.PointerEvent){if(window.PointerEvent=a,window.navigator.msPointerEnabled){var v=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:v,enumerable:!0}),T.registerSource("ms",ea)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),T.registerSource("mouse",et),window.ontouchstart!==void 0&&T.registerSource("touch",rt);T.register(document)}}var ln=window.navigator,xt,Tt,Bt;function tt(v){if(!T.pointermap.has(v)){var g=new Error("InvalidPointerId");throw g.name="InvalidPointerId",g}}function un(v){for(var g=v.parentNode;g&&g!==v.ownerDocument;)g=g.parentNode;if(!g){var s=new Error("InvalidStateError");throw s.name="InvalidStateError",s}}function gr(v){var g=T.pointermap.get(v);return g.buttons!==0}ln.msPointerEnabled?(xt=function(v){tt(v),un(this),gr(v)&&(T.setCapture(v,this,!0),this.msSetPointerCapture(v))},Tt=function(v){tt(v),T.releaseCapture(v,!0),this.msReleasePointerCapture(v)}):(xt=function(g){tt(g),un(this),gr(g)&&T.setCapture(g,this)},Tt=function(g){tt(g),T.releaseCapture(g)}),Bt=function(g){return!!T.captureInfo[g]};function vn(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:xt},releasePointerCapture:{value:Tt},hasPointerCapture:{value:Bt}})}nr(),ra(),vn();var gt={dispatcher:T,Installer:Me,PointerEvent:a,PointerMap:o,targetFinding:w};return gt})})(Pu);var Pe=1e-6,He=typeof Float32Array!="undefined"?Float32Array:Array,$r=Math.random;function Fu(e){He=e}var Gu=Math.PI/180;function Du(e){return e*Gu}function Iu(e,r){return Math.abs(e-r)<=Pe*Math.max(1,Math.abs(e),Math.abs(r))}var Nu=Object.freeze(Object.defineProperty({__proto__:null,EPSILON:Pe,get ARRAY_TYPE(){return He},RANDOM:$r,setMatrixArrayType:Fu,toRadian:Du,equals:Iu},Symbol.toStringTag,{value:"Module"}));function $u(){var e=new He(4);return He!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function Bu(e){var r=new He(4);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function ku(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function zu(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function Uu(e,r,t,n){var a=new He(4);return a[0]=e,a[1]=r,a[2]=t,a[3]=n,a}function ju(e,r,t,n,a){return e[0]=r,e[1]=t,e[2]=n,e[3]=a,e}function Vu(e,r){if(e===r){var t=r[1];e[1]=r[2],e[2]=t}else e[0]=r[0],e[1]=r[2],e[2]=r[1],e[3]=r[3];return e}function Xu(e,r){var t=r[0],n=r[1],a=r[2],f=r[3],o=t*f-a*n;return o?(o=1/o,e[0]=f*o,e[1]=-n*o,e[2]=-a*o,e[3]=t*o,e):null}function qu(e,r){var t=r[0];return e[0]=r[3],e[1]=-r[1],e[2]=-r[2],e[3]=t,e}function Hu(e){return e[0]*e[3]-e[2]*e[1]}function ds(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=t[0],l=t[1],h=t[2],E=t[3];return e[0]=n*c+f*l,e[1]=a*c+o*l,e[2]=n*h+f*E,e[3]=a*h+o*E,e}function Yu(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=Math.sin(t),l=Math.cos(t);return e[0]=n*l+f*c,e[1]=a*l+o*c,e[2]=n*-c+f*l,e[3]=a*-c+o*l,e}function Wu(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=t[0],l=t[1];return e[0]=n*c,e[1]=a*c,e[2]=f*l,e[3]=o*l,e}function Qu(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=-t,e[3]=n,e}function Ku(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=r[1],e}function Zu(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Ju(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))}function e0(e,r,t,n){return e[2]=n[2]/n[0],t[0]=n[0],t[1]=n[1],t[3]=n[3]-e[2]*t[1],[e,r,t]}function r0(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e}function hs(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e}function t0(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]}function n0(e,r){var t=e[0],n=e[1],a=e[2],f=e[3],o=r[0],c=r[1],l=r[2],h=r[3];return Math.abs(t-o)<=Pe*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(n-c)<=Pe*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-l)<=Pe*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(f-h)<=Pe*Math.max(1,Math.abs(f),Math.abs(h))}function a0(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e}function i0(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e}var f0=ds,s0=hs,c0=Object.freeze(Object.defineProperty({__proto__:null,create:$u,clone:Bu,copy:ku,identity:zu,fromValues:Uu,set:ju,transpose:Vu,invert:Xu,adjoint:qu,determinant:Hu,multiply:ds,rotate:Yu,scale:Wu,fromRotation:Qu,fromScaling:Ku,str:Zu,frob:Ju,LDU:e0,add:r0,subtract:hs,exactEquals:t0,equals:n0,multiplyScalar:a0,multiplyScalarAndAdd:i0,mul:f0,sub:s0},Symbol.toStringTag,{value:"Module"}));function o0(){var e=new He(6);return He!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function l0(e){var r=new He(6);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r}function u0(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e}function v0(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function d0(e,r,t,n,a,f){var o=new He(6);return o[0]=e,o[1]=r,o[2]=t,o[3]=n,o[4]=a,o[5]=f,o}function h0(e,r,t,n,a,f,o){return e[0]=r,e[1]=t,e[2]=n,e[3]=a,e[4]=f,e[5]=o,e}function m0(e,r){var t=r[0],n=r[1],a=r[2],f=r[3],o=r[4],c=r[5],l=t*f-n*a;return l?(l=1/l,e[0]=f*l,e[1]=-n*l,e[2]=-a*l,e[3]=t*l,e[4]=(a*c-f*o)*l,e[5]=(n*o-t*c)*l,e):null}function p0(e){return e[0]*e[3]-e[1]*e[2]}function ms(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=r[4],l=r[5],h=t[0],E=t[1],O=t[2],T=t[3],w=t[4],U=t[5];return e[0]=n*h+f*E,e[1]=a*h+o*E,e[2]=n*O+f*T,e[3]=a*O+o*T,e[4]=n*w+f*U+c,e[5]=a*w+o*U+l,e}function y0(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=r[4],l=r[5],h=Math.sin(t),E=Math.cos(t);return e[0]=n*E+f*h,e[1]=a*E+o*h,e[2]=n*-h+f*E,e[3]=a*-h+o*E,e[4]=c,e[5]=l,e}function b0(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=r[4],l=r[5],h=t[0],E=t[1];return e[0]=n*h,e[1]=a*h,e[2]=f*E,e[3]=o*E,e[4]=c,e[5]=l,e}function _0(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=r[4],l=r[5],h=t[0],E=t[1];return e[0]=n,e[1]=a,e[2]=f,e[3]=o,e[4]=n*h+f*E+c,e[5]=a*h+o*E+l,e}function E0(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=-t,e[3]=n,e[4]=0,e[5]=0,e}function x0(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=r[1],e[4]=0,e[5]=0,e}function T0(e,r){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=r[0],e[5]=r[1],e}function g0(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function A0(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)}function S0(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e[4]=r[4]+t[4],e[5]=r[5]+t[5],e}function ps(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e[4]=r[4]-t[4],e[5]=r[5]-t[5],e}function M0(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e[4]=r[4]*t,e[5]=r[5]*t,e}function w0(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e[4]=r[4]+t[4]*n,e[5]=r[5]+t[5]*n,e}function O0(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]}function R0(e,r){var t=e[0],n=e[1],a=e[2],f=e[3],o=e[4],c=e[5],l=r[0],h=r[1],E=r[2],O=r[3],T=r[4],w=r[5];return Math.abs(t-l)<=Pe*Math.max(1,Math.abs(t),Math.abs(l))&&Math.abs(n-h)<=Pe*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(a-E)<=Pe*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(f-O)<=Pe*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(o-T)<=Pe*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(c-w)<=Pe*Math.max(1,Math.abs(c),Math.abs(w))}var L0=ms,C0=ps,P0=Object.freeze(Object.defineProperty({__proto__:null,create:o0,clone:l0,copy:u0,identity:v0,fromValues:d0,set:h0,invert:m0,determinant:p0,multiply:ms,rotate:y0,scale:b0,translate:_0,fromRotation:E0,fromScaling:x0,fromTranslation:T0,str:g0,frob:A0,add:S0,subtract:ps,multiplyScalar:M0,multiplyScalarAndAdd:w0,exactEquals:O0,equals:R0,mul:L0,sub:C0},Symbol.toStringTag,{value:"Module"}));function ys(){var e=new He(9);return He!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function F0(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[4],e[4]=r[5],e[5]=r[6],e[6]=r[8],e[7]=r[9],e[8]=r[10],e}function G0(e){var r=new He(9);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function D0(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e}function I0(e,r,t,n,a,f,o,c,l){var h=new He(9);return h[0]=e,h[1]=r,h[2]=t,h[3]=n,h[4]=a,h[5]=f,h[6]=o,h[7]=c,h[8]=l,h}function N0(e,r,t,n,a,f,o,c,l,h){return e[0]=r,e[1]=t,e[2]=n,e[3]=a,e[4]=f,e[5]=o,e[6]=c,e[7]=l,e[8]=h,e}function $0(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function B0(e,r){if(e===r){var t=r[1],n=r[2],a=r[5];e[1]=r[3],e[2]=r[6],e[3]=t,e[5]=r[7],e[6]=n,e[7]=a}else e[0]=r[0],e[1]=r[3],e[2]=r[6],e[3]=r[1],e[4]=r[4],e[5]=r[7],e[6]=r[2],e[7]=r[5],e[8]=r[8];return e}function k0(e,r){var t=r[0],n=r[1],a=r[2],f=r[3],o=r[4],c=r[5],l=r[6],h=r[7],E=r[8],O=E*o-c*h,T=-E*f+c*l,w=h*f-o*l,U=t*O+n*T+a*w;return U?(U=1/U,e[0]=O*U,e[1]=(-E*n+a*h)*U,e[2]=(c*n-a*o)*U,e[3]=T*U,e[4]=(E*t-a*l)*U,e[5]=(-c*t+a*f)*U,e[6]=w*U,e[7]=(-h*t+n*l)*U,e[8]=(o*t-n*f)*U,e):null}function z0(e,r){var t=r[0],n=r[1],a=r[2],f=r[3],o=r[4],c=r[5],l=r[6],h=r[7],E=r[8];return e[0]=o*E-c*h,e[1]=a*h-n*E,e[2]=n*c-a*o,e[3]=c*l-f*E,e[4]=t*E-a*l,e[5]=a*f-t*c,e[6]=f*h-o*l,e[7]=n*l-t*h,e[8]=t*o-n*f,e}function U0(e){var r=e[0],t=e[1],n=e[2],a=e[3],f=e[4],o=e[5],c=e[6],l=e[7],h=e[8];return r*(h*f-o*l)+t*(-h*a+o*c)+n*(l*a-f*c)}function bs(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=r[4],l=r[5],h=r[6],E=r[7],O=r[8],T=t[0],w=t[1],U=t[2],H=t[3],F=t[4],re=t[5],Te=t[6],Se=t[7],Re=t[8];return e[0]=T*n+w*o+U*h,e[1]=T*a+w*c+U*E,e[2]=T*f+w*l+U*O,e[3]=H*n+F*o+re*h,e[4]=H*a+F*c+re*E,e[5]=H*f+F*l+re*O,e[6]=Te*n+Se*o+Re*h,e[7]=Te*a+Se*c+Re*E,e[8]=Te*f+Se*l+Re*O,e}function j0(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=r[4],l=r[5],h=r[6],E=r[7],O=r[8],T=t[0],w=t[1];return e[0]=n,e[1]=a,e[2]=f,e[3]=o,e[4]=c,e[5]=l,e[6]=T*n+w*o+h,e[7]=T*a+w*c+E,e[8]=T*f+w*l+O,e}function V0(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=r[4],l=r[5],h=r[6],E=r[7],O=r[8],T=Math.sin(t),w=Math.cos(t);return e[0]=w*n+T*o,e[1]=w*a+T*c,e[2]=w*f+T*l,e[3]=w*o-T*n,e[4]=w*c-T*a,e[5]=w*l-T*f,e[6]=h,e[7]=E,e[8]=O,e}function X0(e,r,t){var n=t[0],a=t[1];return e[0]=n*r[0],e[1]=n*r[1],e[2]=n*r[2],e[3]=a*r[3],e[4]=a*r[4],e[5]=a*r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e}function q0(e,r){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=r[0],e[7]=r[1],e[8]=1,e}function H0(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=0,e[3]=-t,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Y0(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=0,e[4]=r[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function W0(e,r){return e[0]=r[0],e[1]=r[1],e[2]=0,e[3]=r[2],e[4]=r[3],e[5]=0,e[6]=r[4],e[7]=r[5],e[8]=1,e}function Q0(e,r){var t=r[0],n=r[1],a=r[2],f=r[3],o=t+t,c=n+n,l=a+a,h=t*o,E=n*o,O=n*c,T=a*o,w=a*c,U=a*l,H=f*o,F=f*c,re=f*l;return e[0]=1-O-U,e[3]=E-re,e[6]=T+F,e[1]=E+re,e[4]=1-h-U,e[7]=w-H,e[2]=T-F,e[5]=w+H,e[8]=1-h-O,e}function K0(e,r){var t=r[0],n=r[1],a=r[2],f=r[3],o=r[4],c=r[5],l=r[6],h=r[7],E=r[8],O=r[9],T=r[10],w=r[11],U=r[12],H=r[13],F=r[14],re=r[15],Te=t*c-n*o,Se=t*l-a*o,Re=t*h-f*o,Me=n*l-a*c,Le=n*h-f*c,Ke=a*h-f*l,Ze=E*H-O*U,er=E*F-T*U,We=E*re-w*U,tr=O*F-T*H,Je=O*re-w*H,nr=T*re-w*F,Ie=Te*nr-Se*Je+Re*tr+Me*We-Le*er+Ke*Ze;return Ie?(Ie=1/Ie,e[0]=(c*nr-l*Je+h*tr)*Ie,e[1]=(l*We-o*nr-h*er)*Ie,e[2]=(o*Je-c*We+h*Ze)*Ie,e[3]=(a*Je-n*nr-f*tr)*Ie,e[4]=(t*nr-a*We+f*er)*Ie,e[5]=(n*We-t*Je-f*Ze)*Ie,e[6]=(H*Ke-F*Le+re*Me)*Ie,e[7]=(F*Re-U*Ke-re*Se)*Ie,e[8]=(U*Le-H*Re+re*Te)*Ie,e):null}function Z0(e,r,t){return e[0]=2/r,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/t,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function J0(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function ev(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))}function rv(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e[4]=r[4]+t[4],e[5]=r[5]+t[5],e[6]=r[6]+t[6],e[7]=r[7]+t[7],e[8]=r[8]+t[8],e}function _s(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e[4]=r[4]-t[4],e[5]=r[5]-t[5],e[6]=r[6]-t[6],e[7]=r[7]-t[7],e[8]=r[8]-t[8],e}function tv(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e[4]=r[4]*t,e[5]=r[5]*t,e[6]=r[6]*t,e[7]=r[7]*t,e[8]=r[8]*t,e}function nv(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e[4]=r[4]+t[4]*n,e[5]=r[5]+t[5]*n,e[6]=r[6]+t[6]*n,e[7]=r[7]+t[7]*n,e[8]=r[8]+t[8]*n,e}function av(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]&&e[6]===r[6]&&e[7]===r[7]&&e[8]===r[8]}function iv(e,r){var t=e[0],n=e[1],a=e[2],f=e[3],o=e[4],c=e[5],l=e[6],h=e[7],E=e[8],O=r[0],T=r[1],w=r[2],U=r[3],H=r[4],F=r[5],re=r[6],Te=r[7],Se=r[8];return Math.abs(t-O)<=Pe*Math.max(1,Math.abs(t),Math.abs(O))&&Math.abs(n-T)<=Pe*Math.max(1,Math.abs(n),Math.abs(T))&&Math.abs(a-w)<=Pe*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(f-U)<=Pe*Math.max(1,Math.abs(f),Math.abs(U))&&Math.abs(o-H)<=Pe*Math.max(1,Math.abs(o),Math.abs(H))&&Math.abs(c-F)<=Pe*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(l-re)<=Pe*Math.max(1,Math.abs(l),Math.abs(re))&&Math.abs(h-Te)<=Pe*Math.max(1,Math.abs(h),Math.abs(Te))&&Math.abs(E-Se)<=Pe*Math.max(1,Math.abs(E),Math.abs(Se))}var fv=bs,sv=_s,cv=Object.freeze(Object.defineProperty({__proto__:null,create:ys,fromMat4:F0,clone:G0,copy:D0,fromValues:I0,set:N0,identity:$0,transpose:B0,invert:k0,adjoint:z0,determinant:U0,multiply:bs,translate:j0,rotate:V0,scale:X0,fromTranslation:q0,fromRotation:H0,fromScaling:Y0,fromMat2d:W0,fromQuat:Q0,normalFromMat4:K0,projection:Z0,str:J0,frob:ev,add:rv,subtract:_s,multiplyScalar:tv,multiplyScalarAndAdd:nv,exactEquals:av,equals:iv,mul:fv,sub:sv},Symbol.toStringTag,{value:"Module"}));function ov(){var e=new He(16);return He!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function lv(e){var r=new He(16);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function uv(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function vv(e,r,t,n,a,f,o,c,l,h,E,O,T,w,U,H){var F=new He(16);return F[0]=e,F[1]=r,F[2]=t,F[3]=n,F[4]=a,F[5]=f,F[6]=o,F[7]=c,F[8]=l,F[9]=h,F[10]=E,F[11]=O,F[12]=T,F[13]=w,F[14]=U,F[15]=H,F}function dv(e,r,t,n,a,f,o,c,l,h,E,O,T,w,U,H,F){return e[0]=r,e[1]=t,e[2]=n,e[3]=a,e[4]=f,e[5]=o,e[6]=c,e[7]=l,e[8]=h,e[9]=E,e[10]=O,e[11]=T,e[12]=w,e[13]=U,e[14]=H,e[15]=F,e}function Es(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function hv(e,r){if(e===r){var t=r[1],n=r[2],a=r[3],f=r[6],o=r[7],c=r[11];e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=t,e[6]=r[9],e[7]=r[13],e[8]=n,e[9]=f,e[11]=r[14],e[12]=a,e[13]=o,e[14]=c}else e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=r[1],e[5]=r[5],e[6]=r[9],e[7]=r[13],e[8]=r[2],e[9]=r[6],e[10]=r[10],e[11]=r[14],e[12]=r[3],e[13]=r[7],e[14]=r[11],e[15]=r[15];return e}function mv(e,r){var t=r[0],n=r[1],a=r[2],f=r[3],o=r[4],c=r[5],l=r[6],h=r[7],E=r[8],O=r[9],T=r[10],w=r[11],U=r[12],H=r[13],F=r[14],re=r[15],Te=t*c-n*o,Se=t*l-a*o,Re=t*h-f*o,Me=n*l-a*c,Le=n*h-f*c,Ke=a*h-f*l,Ze=E*H-O*U,er=E*F-T*U,We=E*re-w*U,tr=O*F-T*H,Je=O*re-w*H,nr=T*re-w*F,Ie=Te*nr-Se*Je+Re*tr+Me*We-Le*er+Ke*Ze;return Ie?(Ie=1/Ie,e[0]=(c*nr-l*Je+h*tr)*Ie,e[1]=(a*Je-n*nr-f*tr)*Ie,e[2]=(H*Ke-F*Le+re*Me)*Ie,e[3]=(T*Le-O*Ke-w*Me)*Ie,e[4]=(l*We-o*nr-h*er)*Ie,e[5]=(t*nr-a*We+f*er)*Ie,e[6]=(F*Re-U*Ke-re*Se)*Ie,e[7]=(E*Ke-T*Re+w*Se)*Ie,e[8]=(o*Je-c*We+h*Ze)*Ie,e[9]=(n*We-t*Je-f*Ze)*Ie,e[10]=(U*Le-H*Re+re*Te)*Ie,e[11]=(O*Re-E*Le-w*Te)*Ie,e[12]=(c*er-o*tr-l*Ze)*Ie,e[13]=(t*tr-n*er+a*Ze)*Ie,e[14]=(H*Se-U*Me-F*Te)*Ie,e[15]=(E*Me-O*Se+T*Te)*Ie,e):null}function pv(e,r){var t=r[0],n=r[1],a=r[2],f=r[3],o=r[4],c=r[5],l=r[6],h=r[7],E=r[8],O=r[9],T=r[10],w=r[11],U=r[12],H=r[13],F=r[14],re=r[15];return e[0]=c*(T*re-w*F)-O*(l*re-h*F)+H*(l*w-h*T),e[1]=-(n*(T*re-w*F)-O*(a*re-f*F)+H*(a*w-f*T)),e[2]=n*(l*re-h*F)-c*(a*re-f*F)+H*(a*h-f*l),e[3]=-(n*(l*w-h*T)-c*(a*w-f*T)+O*(a*h-f*l)),e[4]=-(o*(T*re-w*F)-E*(l*re-h*F)+U*(l*w-h*T)),e[5]=t*(T*re-w*F)-E*(a*re-f*F)+U*(a*w-f*T),e[6]=-(t*(l*re-h*F)-o*(a*re-f*F)+U*(a*h-f*l)),e[7]=t*(l*w-h*T)-o*(a*w-f*T)+E*(a*h-f*l),e[8]=o*(O*re-w*H)-E*(c*re-h*H)+U*(c*w-h*O),e[9]=-(t*(O*re-w*H)-E*(n*re-f*H)+U*(n*w-f*O)),e[10]=t*(c*re-h*H)-o*(n*re-f*H)+U*(n*h-f*c),e[11]=-(t*(c*w-h*O)-o*(n*w-f*O)+E*(n*h-f*c)),e[12]=-(o*(O*F-T*H)-E*(c*F-l*H)+U*(c*T-l*O)),e[13]=t*(O*F-T*H)-E*(n*F-a*H)+U*(n*T-a*O),e[14]=-(t*(c*F-l*H)-o*(n*F-a*H)+U*(n*l-a*c)),e[15]=t*(c*T-l*O)-o*(n*T-a*O)+E*(n*l-a*c),e}function yv(e){var r=e[0],t=e[1],n=e[2],a=e[3],f=e[4],o=e[5],c=e[6],l=e[7],h=e[8],E=e[9],O=e[10],T=e[11],w=e[12],U=e[13],H=e[14],F=e[15],re=r*o-t*f,Te=r*c-n*f,Se=r*l-a*f,Re=t*c-n*o,Me=t*l-a*o,Le=n*l-a*c,Ke=h*U-E*w,Ze=h*H-O*w,er=h*F-T*w,We=E*H-O*U,tr=E*F-T*U,Je=O*F-T*H;return re*Je-Te*tr+Se*We+Re*er-Me*Ze+Le*Ke}function xs(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=r[4],l=r[5],h=r[6],E=r[7],O=r[8],T=r[9],w=r[10],U=r[11],H=r[12],F=r[13],re=r[14],Te=r[15],Se=t[0],Re=t[1],Me=t[2],Le=t[3];return e[0]=Se*n+Re*c+Me*O+Le*H,e[1]=Se*a+Re*l+Me*T+Le*F,e[2]=Se*f+Re*h+Me*w+Le*re,e[3]=Se*o+Re*E+Me*U+Le*Te,Se=t[4],Re=t[5],Me=t[6],Le=t[7],e[4]=Se*n+Re*c+Me*O+Le*H,e[5]=Se*a+Re*l+Me*T+Le*F,e[6]=Se*f+Re*h+Me*w+Le*re,e[7]=Se*o+Re*E+Me*U+Le*Te,Se=t[8],Re=t[9],Me=t[10],Le=t[11],e[8]=Se*n+Re*c+Me*O+Le*H,e[9]=Se*a+Re*l+Me*T+Le*F,e[10]=Se*f+Re*h+Me*w+Le*re,e[11]=Se*o+Re*E+Me*U+Le*Te,Se=t[12],Re=t[13],Me=t[14],Le=t[15],e[12]=Se*n+Re*c+Me*O+Le*H,e[13]=Se*a+Re*l+Me*T+Le*F,e[14]=Se*f+Re*h+Me*w+Le*re,e[15]=Se*o+Re*E+Me*U+Le*Te,e}function bv(e,r,t){var n=t[0],a=t[1],f=t[2],o=void 0,c=void 0,l=void 0,h=void 0,E=void 0,O=void 0,T=void 0,w=void 0,U=void 0,H=void 0,F=void 0,re=void 0;return r===e?(e[12]=r[0]*n+r[4]*a+r[8]*f+r[12],e[13]=r[1]*n+r[5]*a+r[9]*f+r[13],e[14]=r[2]*n+r[6]*a+r[10]*f+r[14],e[15]=r[3]*n+r[7]*a+r[11]*f+r[15]):(o=r[0],c=r[1],l=r[2],h=r[3],E=r[4],O=r[5],T=r[6],w=r[7],U=r[8],H=r[9],F=r[10],re=r[11],e[0]=o,e[1]=c,e[2]=l,e[3]=h,e[4]=E,e[5]=O,e[6]=T,e[7]=w,e[8]=U,e[9]=H,e[10]=F,e[11]=re,e[12]=o*n+E*a+U*f+r[12],e[13]=c*n+O*a+H*f+r[13],e[14]=l*n+T*a+F*f+r[14],e[15]=h*n+w*a+re*f+r[15]),e}function _v(e,r,t){var n=t[0],a=t[1],f=t[2];return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e[4]=r[4]*a,e[5]=r[5]*a,e[6]=r[6]*a,e[7]=r[7]*a,e[8]=r[8]*f,e[9]=r[9]*f,e[10]=r[10]*f,e[11]=r[11]*f,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function Ev(e,r,t,n){var a=n[0],f=n[1],o=n[2],c=Math.sqrt(a*a+f*f+o*o),l=void 0,h=void 0,E=void 0,O=void 0,T=void 0,w=void 0,U=void 0,H=void 0,F=void 0,re=void 0,Te=void 0,Se=void 0,Re=void 0,Me=void 0,Le=void 0,Ke=void 0,Ze=void 0,er=void 0,We=void 0,tr=void 0,Je=void 0,nr=void 0,Ie=void 0,Tr=void 0;return c<Pe?null:(c=1/c,a*=c,f*=c,o*=c,l=Math.sin(t),h=Math.cos(t),E=1-h,O=r[0],T=r[1],w=r[2],U=r[3],H=r[4],F=r[5],re=r[6],Te=r[7],Se=r[8],Re=r[9],Me=r[10],Le=r[11],Ke=a*a*E+h,Ze=f*a*E+o*l,er=o*a*E-f*l,We=a*f*E-o*l,tr=f*f*E+h,Je=o*f*E+a*l,nr=a*o*E+f*l,Ie=f*o*E-a*l,Tr=o*o*E+h,e[0]=O*Ke+H*Ze+Se*er,e[1]=T*Ke+F*Ze+Re*er,e[2]=w*Ke+re*Ze+Me*er,e[3]=U*Ke+Te*Ze+Le*er,e[4]=O*We+H*tr+Se*Je,e[5]=T*We+F*tr+Re*Je,e[6]=w*We+re*tr+Me*Je,e[7]=U*We+Te*tr+Le*Je,e[8]=O*nr+H*Ie+Se*Tr,e[9]=T*nr+F*Ie+Re*Tr,e[10]=w*nr+re*Ie+Me*Tr,e[11]=U*nr+Te*Ie+Le*Tr,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)}function xv(e,r,t){var n=Math.sin(t),a=Math.cos(t),f=r[4],o=r[5],c=r[6],l=r[7],h=r[8],E=r[9],O=r[10],T=r[11];return r!==e&&(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[4]=f*a+h*n,e[5]=o*a+E*n,e[6]=c*a+O*n,e[7]=l*a+T*n,e[8]=h*a-f*n,e[9]=E*a-o*n,e[10]=O*a-c*n,e[11]=T*a-l*n,e}function Tv(e,r,t){var n=Math.sin(t),a=Math.cos(t),f=r[0],o=r[1],c=r[2],l=r[3],h=r[8],E=r[9],O=r[10],T=r[11];return r!==e&&(e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=f*a-h*n,e[1]=o*a-E*n,e[2]=c*a-O*n,e[3]=l*a-T*n,e[8]=f*n+h*a,e[9]=o*n+E*a,e[10]=c*n+O*a,e[11]=l*n+T*a,e}function gv(e,r,t){var n=Math.sin(t),a=Math.cos(t),f=r[0],o=r[1],c=r[2],l=r[3],h=r[4],E=r[5],O=r[6],T=r[7];return r!==e&&(e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=f*a+h*n,e[1]=o*a+E*n,e[2]=c*a+O*n,e[3]=l*a+T*n,e[4]=h*a-f*n,e[5]=E*a-o*n,e[6]=O*a-c*n,e[7]=T*a-l*n,e}function Av(e,r){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Sv(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=r[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Mv(e,r,t){var n=t[0],a=t[1],f=t[2],o=Math.sqrt(n*n+a*a+f*f),c=void 0,l=void 0,h=void 0;return o<Pe?null:(o=1/o,n*=o,a*=o,f*=o,c=Math.sin(r),l=Math.cos(r),h=1-l,e[0]=n*n*h+l,e[1]=a*n*h+f*c,e[2]=f*n*h-a*c,e[3]=0,e[4]=n*a*h-f*c,e[5]=a*a*h+l,e[6]=f*a*h+n*c,e[7]=0,e[8]=n*f*h+a*c,e[9]=a*f*h-n*c,e[10]=f*f*h+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function wv(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=t,e[7]=0,e[8]=0,e[9]=-t,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ov(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=0,e[2]=-t,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=t,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Rv(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=0,e[3]=0,e[4]=-t,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ts(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=n+n,l=a+a,h=f+f,E=n*c,O=n*l,T=n*h,w=a*l,U=a*h,H=f*h,F=o*c,re=o*l,Te=o*h;return e[0]=1-(w+H),e[1]=O+Te,e[2]=T-re,e[3]=0,e[4]=O-Te,e[5]=1-(E+H),e[6]=U+F,e[7]=0,e[8]=T+re,e[9]=U-F,e[10]=1-(E+w),e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Lv(e,r){var t=new He(3),n=-r[0],a=-r[1],f=-r[2],o=r[3],c=r[4],l=r[5],h=r[6],E=r[7],O=n*n+a*a+f*f+o*o;return O>0?(t[0]=(c*o+E*n+l*f-h*a)*2/O,t[1]=(l*o+E*a+h*n-c*f)*2/O,t[2]=(h*o+E*f+c*a-l*n)*2/O):(t[0]=(c*o+E*n+l*f-h*a)*2,t[1]=(l*o+E*a+h*n-c*f)*2,t[2]=(h*o+E*f+c*a-l*n)*2),Ts(e,r,t),e}function gs(e,r){return e[0]=r[12],e[1]=r[13],e[2]=r[14],e}function Cv(e,r){var t=r[0],n=r[1],a=r[2],f=r[4],o=r[5],c=r[6],l=r[8],h=r[9],E=r[10];return e[0]=Math.sqrt(t*t+n*n+a*a),e[1]=Math.sqrt(f*f+o*o+c*c),e[2]=Math.sqrt(l*l+h*h+E*E),e}function As(e,r){var t=r[0]+r[5]+r[10],n=0;return t>0?(n=Math.sqrt(t+1)*2,e[3]=.25*n,e[0]=(r[6]-r[9])/n,e[1]=(r[8]-r[2])/n,e[2]=(r[1]-r[4])/n):r[0]>r[5]&&r[0]>r[10]?(n=Math.sqrt(1+r[0]-r[5]-r[10])*2,e[3]=(r[6]-r[9])/n,e[0]=.25*n,e[1]=(r[1]+r[4])/n,e[2]=(r[8]+r[2])/n):r[5]>r[10]?(n=Math.sqrt(1+r[5]-r[0]-r[10])*2,e[3]=(r[8]-r[2])/n,e[0]=(r[1]+r[4])/n,e[1]=.25*n,e[2]=(r[6]+r[9])/n):(n=Math.sqrt(1+r[10]-r[0]-r[5])*2,e[3]=(r[1]-r[4])/n,e[0]=(r[8]+r[2])/n,e[1]=(r[6]+r[9])/n,e[2]=.25*n),e}function Pv(e,r,t,n){var a=r[0],f=r[1],o=r[2],c=r[3],l=a+a,h=f+f,E=o+o,O=a*l,T=a*h,w=a*E,U=f*h,H=f*E,F=o*E,re=c*l,Te=c*h,Se=c*E,Re=n[0],Me=n[1],Le=n[2];return e[0]=(1-(U+F))*Re,e[1]=(T+Se)*Re,e[2]=(w-Te)*Re,e[3]=0,e[4]=(T-Se)*Me,e[5]=(1-(O+F))*Me,e[6]=(H+re)*Me,e[7]=0,e[8]=(w+Te)*Le,e[9]=(H-re)*Le,e[10]=(1-(O+U))*Le,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Fv(e,r,t,n,a){var f=r[0],o=r[1],c=r[2],l=r[3],h=f+f,E=o+o,O=c+c,T=f*h,w=f*E,U=f*O,H=o*E,F=o*O,re=c*O,Te=l*h,Se=l*E,Re=l*O,Me=n[0],Le=n[1],Ke=n[2],Ze=a[0],er=a[1],We=a[2],tr=(1-(H+re))*Me,Je=(w+Re)*Me,nr=(U-Se)*Me,Ie=(w-Re)*Le,Tr=(1-(T+re))*Le,Gr=(F+Te)*Le,Ar=(U+Se)*Ke,et=(F-Te)*Ke,bt=(1-(T+H))*Ke;return e[0]=tr,e[1]=Je,e[2]=nr,e[3]=0,e[4]=Ie,e[5]=Tr,e[6]=Gr,e[7]=0,e[8]=Ar,e[9]=et,e[10]=bt,e[11]=0,e[12]=t[0]+Ze-(tr*Ze+Ie*er+Ar*We),e[13]=t[1]+er-(Je*Ze+Tr*er+et*We),e[14]=t[2]+We-(nr*Ze+Gr*er+bt*We),e[15]=1,e}function Gv(e,r){var t=r[0],n=r[1],a=r[2],f=r[3],o=t+t,c=n+n,l=a+a,h=t*o,E=n*o,O=n*c,T=a*o,w=a*c,U=a*l,H=f*o,F=f*c,re=f*l;return e[0]=1-O-U,e[1]=E+re,e[2]=T-F,e[3]=0,e[4]=E-re,e[5]=1-h-U,e[6]=w+H,e[7]=0,e[8]=T+F,e[9]=w-H,e[10]=1-h-O,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Dv(e,r,t,n,a,f,o){var c=1/(t-r),l=1/(a-n),h=1/(f-o);return e[0]=f*2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f*2*l,e[6]=0,e[7]=0,e[8]=(t+r)*c,e[9]=(a+n)*l,e[10]=(o+f)*h,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*f*2*h,e[15]=0,e}function Iv(e,r,t,n,a){var f=1/Math.tan(r/2),o=void 0;return e[0]=f/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,a!=null&&a!==1/0?(o=1/(n-a),e[10]=(a+n)*o,e[14]=2*a*n*o):(e[10]=-1,e[14]=-2*n),e}function Nv(e,r,t,n){var a=Math.tan(r.upDegrees*Math.PI/180),f=Math.tan(r.downDegrees*Math.PI/180),o=Math.tan(r.leftDegrees*Math.PI/180),c=Math.tan(r.rightDegrees*Math.PI/180),l=2/(o+c),h=2/(a+f);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=h,e[6]=0,e[7]=0,e[8]=-((o-c)*l*.5),e[9]=(a-f)*h*.5,e[10]=n/(t-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*t/(t-n),e[15]=0,e}function $v(e,r,t,n,a,f,o){var c=1/(r-t),l=1/(n-a),h=1/(f-o);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*h,e[11]=0,e[12]=(r+t)*c,e[13]=(a+n)*l,e[14]=(o+f)*h,e[15]=1,e}function Bv(e,r,t,n){var a=void 0,f=void 0,o=void 0,c=void 0,l=void 0,h=void 0,E=void 0,O=void 0,T=void 0,w=void 0,U=r[0],H=r[1],F=r[2],re=n[0],Te=n[1],Se=n[2],Re=t[0],Me=t[1],Le=t[2];return Math.abs(U-Re)<Pe&&Math.abs(H-Me)<Pe&&Math.abs(F-Le)<Pe?Es(e):(E=U-Re,O=H-Me,T=F-Le,w=1/Math.sqrt(E*E+O*O+T*T),E*=w,O*=w,T*=w,a=Te*T-Se*O,f=Se*E-re*T,o=re*O-Te*E,w=Math.sqrt(a*a+f*f+o*o),w?(w=1/w,a*=w,f*=w,o*=w):(a=0,f=0,o=0),c=O*o-T*f,l=T*a-E*o,h=E*f-O*a,w=Math.sqrt(c*c+l*l+h*h),w?(w=1/w,c*=w,l*=w,h*=w):(c=0,l=0,h=0),e[0]=a,e[1]=c,e[2]=E,e[3]=0,e[4]=f,e[5]=l,e[6]=O,e[7]=0,e[8]=o,e[9]=h,e[10]=T,e[11]=0,e[12]=-(a*U+f*H+o*F),e[13]=-(c*U+l*H+h*F),e[14]=-(E*U+O*H+T*F),e[15]=1,e)}function kv(e,r,t,n){var a=r[0],f=r[1],o=r[2],c=n[0],l=n[1],h=n[2],E=a-t[0],O=f-t[1],T=o-t[2],w=E*E+O*O+T*T;w>0&&(w=1/Math.sqrt(w),E*=w,O*=w,T*=w);var U=l*T-h*O,H=h*E-c*T,F=c*O-l*E;return w=U*U+H*H+F*F,w>0&&(w=1/Math.sqrt(w),U*=w,H*=w,F*=w),e[0]=U,e[1]=H,e[2]=F,e[3]=0,e[4]=O*F-T*H,e[5]=T*U-E*F,e[6]=E*H-O*U,e[7]=0,e[8]=E,e[9]=O,e[10]=T,e[11]=0,e[12]=a,e[13]=f,e[14]=o,e[15]=1,e}function zv(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Uv(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))}function jv(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e[4]=r[4]+t[4],e[5]=r[5]+t[5],e[6]=r[6]+t[6],e[7]=r[7]+t[7],e[8]=r[8]+t[8],e[9]=r[9]+t[9],e[10]=r[10]+t[10],e[11]=r[11]+t[11],e[12]=r[12]+t[12],e[13]=r[13]+t[13],e[14]=r[14]+t[14],e[15]=r[15]+t[15],e}function Ss(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e[4]=r[4]-t[4],e[5]=r[5]-t[5],e[6]=r[6]-t[6],e[7]=r[7]-t[7],e[8]=r[8]-t[8],e[9]=r[9]-t[9],e[10]=r[10]-t[10],e[11]=r[11]-t[11],e[12]=r[12]-t[12],e[13]=r[13]-t[13],e[14]=r[14]-t[14],e[15]=r[15]-t[15],e}function Vv(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e[4]=r[4]*t,e[5]=r[5]*t,e[6]=r[6]*t,e[7]=r[7]*t,e[8]=r[8]*t,e[9]=r[9]*t,e[10]=r[10]*t,e[11]=r[11]*t,e[12]=r[12]*t,e[13]=r[13]*t,e[14]=r[14]*t,e[15]=r[15]*t,e}function Xv(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e[4]=r[4]+t[4]*n,e[5]=r[5]+t[5]*n,e[6]=r[6]+t[6]*n,e[7]=r[7]+t[7]*n,e[8]=r[8]+t[8]*n,e[9]=r[9]+t[9]*n,e[10]=r[10]+t[10]*n,e[11]=r[11]+t[11]*n,e[12]=r[12]+t[12]*n,e[13]=r[13]+t[13]*n,e[14]=r[14]+t[14]*n,e[15]=r[15]+t[15]*n,e}function qv(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]&&e[6]===r[6]&&e[7]===r[7]&&e[8]===r[8]&&e[9]===r[9]&&e[10]===r[10]&&e[11]===r[11]&&e[12]===r[12]&&e[13]===r[13]&&e[14]===r[14]&&e[15]===r[15]}function Hv(e,r){var t=e[0],n=e[1],a=e[2],f=e[3],o=e[4],c=e[5],l=e[6],h=e[7],E=e[8],O=e[9],T=e[10],w=e[11],U=e[12],H=e[13],F=e[14],re=e[15],Te=r[0],Se=r[1],Re=r[2],Me=r[3],Le=r[4],Ke=r[5],Ze=r[6],er=r[7],We=r[8],tr=r[9],Je=r[10],nr=r[11],Ie=r[12],Tr=r[13],Gr=r[14],Ar=r[15];return Math.abs(t-Te)<=Pe*Math.max(1,Math.abs(t),Math.abs(Te))&&Math.abs(n-Se)<=Pe*Math.max(1,Math.abs(n),Math.abs(Se))&&Math.abs(a-Re)<=Pe*Math.max(1,Math.abs(a),Math.abs(Re))&&Math.abs(f-Me)<=Pe*Math.max(1,Math.abs(f),Math.abs(Me))&&Math.abs(o-Le)<=Pe*Math.max(1,Math.abs(o),Math.abs(Le))&&Math.abs(c-Ke)<=Pe*Math.max(1,Math.abs(c),Math.abs(Ke))&&Math.abs(l-Ze)<=Pe*Math.max(1,Math.abs(l),Math.abs(Ze))&&Math.abs(h-er)<=Pe*Math.max(1,Math.abs(h),Math.abs(er))&&Math.abs(E-We)<=Pe*Math.max(1,Math.abs(E),Math.abs(We))&&Math.abs(O-tr)<=Pe*Math.max(1,Math.abs(O),Math.abs(tr))&&Math.abs(T-Je)<=Pe*Math.max(1,Math.abs(T),Math.abs(Je))&&Math.abs(w-nr)<=Pe*Math.max(1,Math.abs(w),Math.abs(nr))&&Math.abs(U-Ie)<=Pe*Math.max(1,Math.abs(U),Math.abs(Ie))&&Math.abs(H-Tr)<=Pe*Math.max(1,Math.abs(H),Math.abs(Tr))&&Math.abs(F-Gr)<=Pe*Math.max(1,Math.abs(F),Math.abs(Gr))&&Math.abs(re-Ar)<=Pe*Math.max(1,Math.abs(re),Math.abs(Ar))}var Yv=xs,Wv=Ss,Qv=Object.freeze(Object.defineProperty({__proto__:null,create:ov,clone:lv,copy:uv,fromValues:vv,set:dv,identity:Es,transpose:hv,invert:mv,adjoint:pv,determinant:yv,multiply:xs,translate:bv,scale:_v,rotate:Ev,rotateX:xv,rotateY:Tv,rotateZ:gv,fromTranslation:Av,fromScaling:Sv,fromRotation:Mv,fromXRotation:wv,fromYRotation:Ov,fromZRotation:Rv,fromRotationTranslation:Ts,fromQuat2:Lv,getTranslation:gs,getScaling:Cv,getRotation:As,fromRotationTranslationScale:Pv,fromRotationTranslationScaleOrigin:Fv,fromQuat:Gv,frustum:Dv,perspective:Iv,perspectiveFromFieldOfView:Nv,ortho:$v,lookAt:Bv,targetTo:kv,str:zv,frob:Uv,add:jv,subtract:Ss,multiplyScalar:Vv,multiplyScalarAndAdd:Xv,exactEquals:qv,equals:Hv,mul:Yv,sub:Wv},Symbol.toStringTag,{value:"Module"}));function ni(){var e=new He(3);return He!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Kv(e){var r=new He(3);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function Ms(e){var r=e[0],t=e[1],n=e[2];return Math.sqrt(r*r+t*t+n*n)}function fn(e,r,t){var n=new He(3);return n[0]=e,n[1]=r,n[2]=t,n}function Zv(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function Jv(e,r,t,n){return e[0]=r,e[1]=t,e[2]=n,e}function ed(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e}function ws(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e}function Os(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e[2]=r[2]*t[2],e}function Rs(e,r,t){return e[0]=r[0]/t[0],e[1]=r[1]/t[1],e[2]=r[2]/t[2],e}function rd(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e[2]=Math.ceil(r[2]),e}function td(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e[2]=Math.floor(r[2]),e}function nd(e,r,t){return e[0]=Math.min(r[0],t[0]),e[1]=Math.min(r[1],t[1]),e[2]=Math.min(r[2],t[2]),e}function ad(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e[2]=Math.max(r[2],t[2]),e}function id(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e[2]=Math.round(r[2]),e}function fd(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e}function sd(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e}function Ls(e,r){var t=r[0]-e[0],n=r[1]-e[1],a=r[2]-e[2];return Math.sqrt(t*t+n*n+a*a)}function Cs(e,r){var t=r[0]-e[0],n=r[1]-e[1],a=r[2]-e[2];return t*t+n*n+a*a}function Ps(e){var r=e[0],t=e[1],n=e[2];return r*r+t*t+n*n}function cd(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e}function od(e,r){return e[0]=1/r[0],e[1]=1/r[1],e[2]=1/r[2],e}function Yn(e,r){var t=r[0],n=r[1],a=r[2],f=t*t+n*n+a*a;return f>0&&(f=1/Math.sqrt(f),e[0]=r[0]*f,e[1]=r[1]*f,e[2]=r[2]*f),e}function ai(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}function qn(e,r,t){var n=r[0],a=r[1],f=r[2],o=t[0],c=t[1],l=t[2];return e[0]=a*l-f*c,e[1]=f*o-n*l,e[2]=n*c-a*o,e}function ld(e,r,t,n){var a=r[0],f=r[1],o=r[2];return e[0]=a+n*(t[0]-a),e[1]=f+n*(t[1]-f),e[2]=o+n*(t[2]-o),e}function ud(e,r,t,n,a,f){var o=f*f,c=o*(2*f-3)+1,l=o*(f-2)+f,h=o*(f-1),E=o*(3-2*f);return e[0]=r[0]*c+t[0]*l+n[0]*h+a[0]*E,e[1]=r[1]*c+t[1]*l+n[1]*h+a[1]*E,e[2]=r[2]*c+t[2]*l+n[2]*h+a[2]*E,e}function vd(e,r,t,n,a,f){var o=1-f,c=o*o,l=f*f,h=c*o,E=3*f*c,O=3*l*o,T=l*f;return e[0]=r[0]*h+t[0]*E+n[0]*O+a[0]*T,e[1]=r[1]*h+t[1]*E+n[1]*O+a[1]*T,e[2]=r[2]*h+t[2]*E+n[2]*O+a[2]*T,e}function dd(e,r){r=r||1;var t=$r()*2*Math.PI,n=$r()*2-1,a=Math.sqrt(1-n*n)*r;return e[0]=Math.cos(t)*a,e[1]=Math.sin(t)*a,e[2]=n*r,e}function hd(e,r,t){var n=r[0],a=r[1],f=r[2],o=t[3]*n+t[7]*a+t[11]*f+t[15];return o=o||1,e[0]=(t[0]*n+t[4]*a+t[8]*f+t[12])/o,e[1]=(t[1]*n+t[5]*a+t[9]*f+t[13])/o,e[2]=(t[2]*n+t[6]*a+t[10]*f+t[14])/o,e}function md(e,r,t){var n=r[0],a=r[1],f=r[2];return e[0]=n*t[0]+a*t[3]+f*t[6],e[1]=n*t[1]+a*t[4]+f*t[7],e[2]=n*t[2]+a*t[5]+f*t[8],e}function pd(e,r,t){var n=t[0],a=t[1],f=t[2],o=t[3],c=r[0],l=r[1],h=r[2],E=a*h-f*l,O=f*c-n*h,T=n*l-a*c,w=a*T-f*O,U=f*E-n*T,H=n*O-a*E,F=o*2;return E*=F,O*=F,T*=F,w*=2,U*=2,H*=2,e[0]=c+E+w,e[1]=l+O+U,e[2]=h+T+H,e}function yd(e,r,t,n){var a=[],f=[];return a[0]=r[0]-t[0],a[1]=r[1]-t[1],a[2]=r[2]-t[2],f[0]=a[0],f[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),f[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),e[0]=f[0]+t[0],e[1]=f[1]+t[1],e[2]=f[2]+t[2],e}function bd(e,r,t,n){var a=[],f=[];return a[0]=r[0]-t[0],a[1]=r[1]-t[1],a[2]=r[2]-t[2],f[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),f[1]=a[1],f[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),e[0]=f[0]+t[0],e[1]=f[1]+t[1],e[2]=f[2]+t[2],e}function _d(e,r,t,n){var a=[],f=[];return a[0]=r[0]-t[0],a[1]=r[1]-t[1],a[2]=r[2]-t[2],f[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),f[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),f[2]=a[2],e[0]=f[0]+t[0],e[1]=f[1]+t[1],e[2]=f[2]+t[2],e}function Ed(e,r){var t=fn(e[0],e[1],e[2]),n=fn(r[0],r[1],r[2]);Yn(t,t),Yn(n,n);var a=ai(t,n);return a>1?0:a<-1?Math.PI:Math.acos(a)}function xd(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Td(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]}function gd(e,r){var t=e[0],n=e[1],a=e[2],f=r[0],o=r[1],c=r[2];return Math.abs(t-f)<=Pe*Math.max(1,Math.abs(t),Math.abs(f))&&Math.abs(n-o)<=Pe*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(a-c)<=Pe*Math.max(1,Math.abs(a),Math.abs(c))}var Ad=ws,Sd=Os,Md=Rs,wd=Ls,Od=Cs,Fs=Ms,Rd=Ps,Ld=function(){var e=ni();return function(r,t,n,a,f,o){var c=void 0,l=void 0;for(t||(t=3),n||(n=0),a?l=Math.min(a*t+n,r.length):l=r.length,c=n;c<l;c+=t)e[0]=r[c],e[1]=r[c+1],e[2]=r[c+2],f(e,e,o),r[c]=e[0],r[c+1]=e[1],r[c+2]=e[2];return r}}(),Cd=Object.freeze(Object.defineProperty({__proto__:null,create:ni,clone:Kv,length:Ms,fromValues:fn,copy:Zv,set:Jv,add:ed,subtract:ws,multiply:Os,divide:Rs,ceil:rd,floor:td,min:nd,max:ad,round:id,scale:fd,scaleAndAdd:sd,distance:Ls,squaredDistance:Cs,squaredLength:Ps,negate:cd,inverse:od,normalize:Yn,dot:ai,cross:qn,lerp:ld,hermite:ud,bezier:vd,random:dd,transformMat4:hd,transformMat3:md,transformQuat:pd,rotateX:yd,rotateY:bd,rotateZ:_d,angle:Ed,str:xd,exactEquals:Td,equals:gd,sub:Ad,mul:Sd,div:Md,dist:wd,sqrDist:Od,len:Fs,sqrLen:Rd,forEach:Ld},Symbol.toStringTag,{value:"Module"}));function Gs(){var e=new He(4);return He!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Ds(e){var r=new He(4);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function Is(e,r,t,n){var a=new He(4);return a[0]=e,a[1]=r,a[2]=t,a[3]=n,a}function Ns(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function $s(e,r,t,n,a){return e[0]=r,e[1]=t,e[2]=n,e[3]=a,e}function Bs(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e}function ks(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e}function zs(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e[2]=r[2]*t[2],e[3]=r[3]*t[3],e}function Us(e,r,t){return e[0]=r[0]/t[0],e[1]=r[1]/t[1],e[2]=r[2]/t[2],e[3]=r[3]/t[3],e}function Pd(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e[2]=Math.ceil(r[2]),e[3]=Math.ceil(r[3]),e}function Fd(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e[2]=Math.floor(r[2]),e[3]=Math.floor(r[3]),e}function Gd(e,r,t){return e[0]=Math.min(r[0],t[0]),e[1]=Math.min(r[1],t[1]),e[2]=Math.min(r[2],t[2]),e[3]=Math.min(r[3],t[3]),e}function Dd(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e[2]=Math.max(r[2],t[2]),e[3]=Math.max(r[3],t[3]),e}function Id(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e[2]=Math.round(r[2]),e[3]=Math.round(r[3]),e}function js(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e}function Nd(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e}function Vs(e,r){var t=r[0]-e[0],n=r[1]-e[1],a=r[2]-e[2],f=r[3]-e[3];return Math.sqrt(t*t+n*n+a*a+f*f)}function Xs(e,r){var t=r[0]-e[0],n=r[1]-e[1],a=r[2]-e[2],f=r[3]-e[3];return t*t+n*n+a*a+f*f}function ii(e){var r=e[0],t=e[1],n=e[2],a=e[3];return Math.sqrt(r*r+t*t+n*n+a*a)}function fi(e){var r=e[0],t=e[1],n=e[2],a=e[3];return r*r+t*t+n*n+a*a}function $d(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e[3]=-r[3],e}function Bd(e,r){return e[0]=1/r[0],e[1]=1/r[1],e[2]=1/r[2],e[3]=1/r[3],e}function qs(e,r){var t=r[0],n=r[1],a=r[2],f=r[3],o=t*t+n*n+a*a+f*f;return o>0&&(o=1/Math.sqrt(o),e[0]=t*o,e[1]=n*o,e[2]=a*o,e[3]=f*o),e}function Hs(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3]}function Ys(e,r,t,n){var a=r[0],f=r[1],o=r[2],c=r[3];return e[0]=a+n*(t[0]-a),e[1]=f+n*(t[1]-f),e[2]=o+n*(t[2]-o),e[3]=c+n*(t[3]-c),e}function kd(e,r){r=r||1;var t,n,a,f,o,c;do t=$r()*2-1,n=$r()*2-1,o=t*t+n*n;while(o>=1);do a=$r()*2-1,f=$r()*2-1,c=a*a+f*f;while(c>=1);var l=Math.sqrt((1-o)/c);return e[0]=r*t,e[1]=r*n,e[2]=r*a*l,e[3]=r*f*l,e}function zd(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3];return e[0]=t[0]*n+t[4]*a+t[8]*f+t[12]*o,e[1]=t[1]*n+t[5]*a+t[9]*f+t[13]*o,e[2]=t[2]*n+t[6]*a+t[10]*f+t[14]*o,e[3]=t[3]*n+t[7]*a+t[11]*f+t[15]*o,e}function Ud(e,r,t){var n=r[0],a=r[1],f=r[2],o=t[0],c=t[1],l=t[2],h=t[3],E=h*n+c*f-l*a,O=h*a+l*n-o*f,T=h*f+o*a-c*n,w=-o*n-c*a-l*f;return e[0]=E*h+w*-o+O*-l-T*-c,e[1]=O*h+w*-c+T*-o-E*-l,e[2]=T*h+w*-l+E*-c-O*-o,e[3]=r[3],e}function jd(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Ws(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]}function Qs(e,r){var t=e[0],n=e[1],a=e[2],f=e[3],o=r[0],c=r[1],l=r[2],h=r[3];return Math.abs(t-o)<=Pe*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(n-c)<=Pe*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-l)<=Pe*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(f-h)<=Pe*Math.max(1,Math.abs(f),Math.abs(h))}var Vd=ks,Xd=zs,qd=Us,Hd=Vs,Yd=Xs,Wd=ii,Qd=fi,Kd=function(){var e=Gs();return function(r,t,n,a,f,o){var c=void 0,l=void 0;for(t||(t=4),n||(n=0),a?l=Math.min(a*t+n,r.length):l=r.length,c=n;c<l;c+=t)e[0]=r[c],e[1]=r[c+1],e[2]=r[c+2],e[3]=r[c+3],f(e,e,o),r[c]=e[0],r[c+1]=e[1],r[c+2]=e[2],r[c+3]=e[3];return r}}(),Zd=Object.freeze(Object.defineProperty({__proto__:null,create:Gs,clone:Ds,fromValues:Is,copy:Ns,set:$s,add:Bs,subtract:ks,multiply:zs,divide:Us,ceil:Pd,floor:Fd,min:Gd,max:Dd,round:Id,scale:js,scaleAndAdd:Nd,distance:Vs,squaredDistance:Xs,length:ii,squaredLength:fi,negate:$d,inverse:Bd,normalize:qs,dot:Hs,lerp:Ys,random:kd,transformMat4:zd,transformQuat:Ud,str:jd,exactEquals:Ws,equals:Qs,sub:Vd,mul:Xd,div:qd,dist:Hd,sqrDist:Yd,len:Wd,sqrLen:Qd,forEach:Kd},Symbol.toStringTag,{value:"Module"}));function Wn(){var e=new He(4);return He!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Jd(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Ks(e,r,t){t=t*.5;var n=Math.sin(t);return e[0]=n*r[0],e[1]=n*r[1],e[2]=n*r[2],e[3]=Math.cos(t),e}function eh(e,r){var t=Math.acos(r[3])*2,n=Math.sin(t/2);return n>Pe?(e[0]=r[0]/n,e[1]=r[1]/n,e[2]=r[2]/n):(e[0]=1,e[1]=0,e[2]=0),t}function Zs(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=t[0],l=t[1],h=t[2],E=t[3];return e[0]=n*E+o*c+a*h-f*l,e[1]=a*E+o*l+f*c-n*h,e[2]=f*E+o*h+n*l-a*c,e[3]=o*E-n*c-a*l-f*h,e}function Js(e,r,t){t*=.5;var n=r[0],a=r[1],f=r[2],o=r[3],c=Math.sin(t),l=Math.cos(t);return e[0]=n*l+o*c,e[1]=a*l+f*c,e[2]=f*l-a*c,e[3]=o*l-n*c,e}function ec(e,r,t){t*=.5;var n=r[0],a=r[1],f=r[2],o=r[3],c=Math.sin(t),l=Math.cos(t);return e[0]=n*l-f*c,e[1]=a*l+o*c,e[2]=f*l+n*c,e[3]=o*l-a*c,e}function rc(e,r,t){t*=.5;var n=r[0],a=r[1],f=r[2],o=r[3],c=Math.sin(t),l=Math.cos(t);return e[0]=n*l+a*c,e[1]=a*l-n*c,e[2]=f*l+o*c,e[3]=o*l-f*c,e}function rh(e,r){var t=r[0],n=r[1],a=r[2];return e[0]=t,e[1]=n,e[2]=a,e[3]=Math.sqrt(Math.abs(1-t*t-n*n-a*a)),e}function Hn(e,r,t,n){var a=r[0],f=r[1],o=r[2],c=r[3],l=t[0],h=t[1],E=t[2],O=t[3],T=void 0,w=void 0,U=void 0,H=void 0,F=void 0;return w=a*l+f*h+o*E+c*O,w<0&&(w=-w,l=-l,h=-h,E=-E,O=-O),1-w>Pe?(T=Math.acos(w),U=Math.sin(T),H=Math.sin((1-n)*T)/U,F=Math.sin(n*T)/U):(H=1-n,F=n),e[0]=H*a+F*l,e[1]=H*f+F*h,e[2]=H*o+F*E,e[3]=H*c+F*O,e}function th(e){var r=$r(),t=$r(),n=$r(),a=Math.sqrt(1-r),f=Math.sqrt(r);return e[0]=a*Math.sin(2*Math.PI*t),e[1]=a*Math.cos(2*Math.PI*t),e[2]=f*Math.sin(2*Math.PI*n),e[3]=f*Math.cos(2*Math.PI*n),e}function nh(e,r){var t=r[0],n=r[1],a=r[2],f=r[3],o=t*t+n*n+a*a+f*f,c=o?1/o:0;return e[0]=-t*c,e[1]=-n*c,e[2]=-a*c,e[3]=f*c,e}function ah(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e[3]=r[3],e}function tc(e,r){var t=r[0]+r[4]+r[8],n=void 0;if(t>0)n=Math.sqrt(t+1),e[3]=.5*n,n=.5/n,e[0]=(r[5]-r[7])*n,e[1]=(r[6]-r[2])*n,e[2]=(r[1]-r[3])*n;else{var a=0;r[4]>r[0]&&(a=1),r[8]>r[a*3+a]&&(a=2);var f=(a+1)%3,o=(a+2)%3;n=Math.sqrt(r[a*3+a]-r[f*3+f]-r[o*3+o]+1),e[a]=.5*n,n=.5/n,e[3]=(r[f*3+o]-r[o*3+f])*n,e[f]=(r[f*3+a]+r[a*3+f])*n,e[o]=(r[o*3+a]+r[a*3+o])*n}return e}function ih(e,r,t,n){var a=.5*Math.PI/180;r*=a,t*=a,n*=a;var f=Math.sin(r),o=Math.cos(r),c=Math.sin(t),l=Math.cos(t),h=Math.sin(n),E=Math.cos(n);return e[0]=f*l*E-o*c*h,e[1]=o*c*E+f*l*h,e[2]=o*l*h-f*c*E,e[3]=o*l*E+f*c*h,e}function fh(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var sh=Ds,ch=Is,si=Ns,oh=$s,lh=Bs,uh=Zs,vh=js,nc=Hs,dh=Ys,ci=ii,hh=ci,oi=fi,mh=oi,li=qs,ph=Ws,yh=Qs,bh=function(){var e=ni(),r=fn(1,0,0),t=fn(0,1,0);return function(n,a,f){var o=ai(a,f);return o<-.999999?(qn(e,r,a),Fs(e)<1e-6&&qn(e,t,a),Yn(e,e),Ks(n,e,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(qn(e,a,f),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+o,li(n,n))}}(),_h=function(){var e=Wn(),r=Wn();return function(t,n,a,f,o,c){return Hn(e,n,o,c),Hn(r,a,f,c),Hn(t,e,r,2*c*(1-c)),t}}(),Eh=function(){var e=ys();return function(r,t,n,a){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-t[0],e[5]=-t[1],e[8]=-t[2],li(r,tc(r,e))}}(),xh=Object.freeze(Object.defineProperty({__proto__:null,create:Wn,identity:Jd,setAxisAngle:Ks,getAxisAngle:eh,multiply:Zs,rotateX:Js,rotateY:ec,rotateZ:rc,calculateW:rh,slerp:Hn,random:th,invert:nh,conjugate:ah,fromMat3:tc,fromEuler:ih,str:fh,clone:sh,fromValues:ch,copy:si,set:oh,add:lh,mul:uh,scale:vh,dot:nc,lerp:dh,length:ci,len:hh,squaredLength:oi,sqrLen:mh,normalize:li,exactEquals:ph,equals:yh,rotationTo:bh,sqlerp:_h,setAxes:Eh},Symbol.toStringTag,{value:"Module"}));function Th(){var e=new He(8);return He!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function gh(e){var r=new He(8);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r}function Ah(e,r,t,n,a,f,o,c){var l=new He(8);return l[0]=e,l[1]=r,l[2]=t,l[3]=n,l[4]=a,l[5]=f,l[6]=o,l[7]=c,l}function Sh(e,r,t,n,a,f,o){var c=new He(8);c[0]=e,c[1]=r,c[2]=t,c[3]=n;var l=a*.5,h=f*.5,E=o*.5;return c[4]=l*n+h*t-E*r,c[5]=h*n+E*e-l*t,c[6]=E*n+l*r-h*e,c[7]=-l*e-h*r-E*t,c}function ac(e,r,t){var n=t[0]*.5,a=t[1]*.5,f=t[2]*.5,o=r[0],c=r[1],l=r[2],h=r[3];return e[0]=o,e[1]=c,e[2]=l,e[3]=h,e[4]=n*h+a*l-f*c,e[5]=a*h+f*o-n*l,e[6]=f*h+n*c-a*o,e[7]=-n*o-a*c-f*l,e}function Mh(e,r){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=r[0]*.5,e[5]=r[1]*.5,e[6]=r[2]*.5,e[7]=0,e}function wh(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Oh(e,r){var t=Wn();As(t,r);var n=new He(3);return gs(n,r),ac(e,t,n),e}function ic(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e}function Rh(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Lh(e,r,t,n,a,f,o,c,l){return e[0]=r,e[1]=t,e[2]=n,e[3]=a,e[4]=f,e[5]=o,e[6]=c,e[7]=l,e}var Ch=si;function Ph(e,r){return e[0]=r[4],e[1]=r[5],e[2]=r[6],e[3]=r[7],e}var Fh=si;function Gh(e,r){return e[4]=r[0],e[5]=r[1],e[6]=r[2],e[7]=r[3],e}function Dh(e,r){var t=r[4],n=r[5],a=r[6],f=r[7],o=-r[0],c=-r[1],l=-r[2],h=r[3];return e[0]=(t*h+f*o+n*l-a*c)*2,e[1]=(n*h+f*c+a*o-t*l)*2,e[2]=(a*h+f*l+t*c-n*o)*2,e}function Ih(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=t[0]*.5,l=t[1]*.5,h=t[2]*.5,E=r[4],O=r[5],T=r[6],w=r[7];return e[0]=n,e[1]=a,e[2]=f,e[3]=o,e[4]=o*c+a*h-f*l+E,e[5]=o*l+f*c-n*h+O,e[6]=o*h+n*l-a*c+T,e[7]=-n*c-a*l-f*h+w,e}function Nh(e,r,t){var n=-r[0],a=-r[1],f=-r[2],o=r[3],c=r[4],l=r[5],h=r[6],E=r[7],O=c*o+E*n+l*f-h*a,T=l*o+E*a+h*n-c*f,w=h*o+E*f+c*a-l*n,U=E*o-c*n-l*a-h*f;return Js(e,r,t),n=e[0],a=e[1],f=e[2],o=e[3],e[4]=O*o+U*n+T*f-w*a,e[5]=T*o+U*a+w*n-O*f,e[6]=w*o+U*f+O*a-T*n,e[7]=U*o-O*n-T*a-w*f,e}function $h(e,r,t){var n=-r[0],a=-r[1],f=-r[2],o=r[3],c=r[4],l=r[5],h=r[6],E=r[7],O=c*o+E*n+l*f-h*a,T=l*o+E*a+h*n-c*f,w=h*o+E*f+c*a-l*n,U=E*o-c*n-l*a-h*f;return ec(e,r,t),n=e[0],a=e[1],f=e[2],o=e[3],e[4]=O*o+U*n+T*f-w*a,e[5]=T*o+U*a+w*n-O*f,e[6]=w*o+U*f+O*a-T*n,e[7]=U*o-O*n-T*a-w*f,e}function Bh(e,r,t){var n=-r[0],a=-r[1],f=-r[2],o=r[3],c=r[4],l=r[5],h=r[6],E=r[7],O=c*o+E*n+l*f-h*a,T=l*o+E*a+h*n-c*f,w=h*o+E*f+c*a-l*n,U=E*o-c*n-l*a-h*f;return rc(e,r,t),n=e[0],a=e[1],f=e[2],o=e[3],e[4]=O*o+U*n+T*f-w*a,e[5]=T*o+U*a+w*n-O*f,e[6]=w*o+U*f+O*a-T*n,e[7]=U*o-O*n-T*a-w*f,e}function kh(e,r,t){var n=t[0],a=t[1],f=t[2],o=t[3],c=r[0],l=r[1],h=r[2],E=r[3];return e[0]=c*o+E*n+l*f-h*a,e[1]=l*o+E*a+h*n-c*f,e[2]=h*o+E*f+c*a-l*n,e[3]=E*o-c*n-l*a-h*f,c=r[4],l=r[5],h=r[6],E=r[7],e[4]=c*o+E*n+l*f-h*a,e[5]=l*o+E*a+h*n-c*f,e[6]=h*o+E*f+c*a-l*n,e[7]=E*o-c*n-l*a-h*f,e}function zh(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=t[0],l=t[1],h=t[2],E=t[3];return e[0]=n*E+o*c+a*h-f*l,e[1]=a*E+o*l+f*c-n*h,e[2]=f*E+o*h+n*l-a*c,e[3]=o*E-n*c-a*l-f*h,c=t[4],l=t[5],h=t[6],E=t[7],e[4]=n*E+o*c+a*h-f*l,e[5]=a*E+o*l+f*c-n*h,e[6]=f*E+o*h+n*l-a*c,e[7]=o*E-n*c-a*l-f*h,e}function Uh(e,r,t,n){if(Math.abs(n)<Pe)return ic(e,r);var a=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);n=n*.5;var f=Math.sin(n),o=f*t[0]/a,c=f*t[1]/a,l=f*t[2]/a,h=Math.cos(n),E=r[0],O=r[1],T=r[2],w=r[3];e[0]=E*h+w*o+O*l-T*c,e[1]=O*h+w*c+T*o-E*l,e[2]=T*h+w*l+E*c-O*o,e[3]=w*h-E*o-O*c-T*l;var U=r[4],H=r[5],F=r[6],re=r[7];return e[4]=U*h+re*o+H*l-F*c,e[5]=H*h+re*c+F*o-U*l,e[6]=F*h+re*l+U*c-H*o,e[7]=re*h-U*o-H*c-F*l,e}function jh(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e[4]=r[4]+t[4],e[5]=r[5]+t[5],e[6]=r[6]+t[6],e[7]=r[7]+t[7],e}function fc(e,r,t){var n=r[0],a=r[1],f=r[2],o=r[3],c=t[4],l=t[5],h=t[6],E=t[7],O=r[4],T=r[5],w=r[6],U=r[7],H=t[0],F=t[1],re=t[2],Te=t[3];return e[0]=n*Te+o*H+a*re-f*F,e[1]=a*Te+o*F+f*H-n*re,e[2]=f*Te+o*re+n*F-a*H,e[3]=o*Te-n*H-a*F-f*re,e[4]=n*E+o*c+a*h-f*l+O*Te+U*H+T*re-w*F,e[5]=a*E+o*l+f*c-n*h+T*Te+U*F+w*H-O*re,e[6]=f*E+o*h+n*l-a*c+w*Te+U*re+O*F-T*H,e[7]=o*E-n*c-a*l-f*h+U*Te-O*H-T*F-w*re,e}var Vh=fc;function Xh(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e[4]=r[4]*t,e[5]=r[5]*t,e[6]=r[6]*t,e[7]=r[7]*t,e}var sc=nc;function qh(e,r,t,n){var a=1-n;return sc(r,t)<0&&(n=-n),e[0]=r[0]*a+t[0]*n,e[1]=r[1]*a+t[1]*n,e[2]=r[2]*a+t[2]*n,e[3]=r[3]*a+t[3]*n,e[4]=r[4]*a+t[4]*n,e[5]=r[5]*a+t[5]*n,e[6]=r[6]*a+t[6]*n,e[7]=r[7]*a+t[7]*n,e}function Hh(e,r){var t=Qn(r);return e[0]=-r[0]/t,e[1]=-r[1]/t,e[2]=-r[2]/t,e[3]=r[3]/t,e[4]=-r[4]/t,e[5]=-r[5]/t,e[6]=-r[6]/t,e[7]=r[7]/t,e}function Yh(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e[3]=r[3],e[4]=-r[4],e[5]=-r[5],e[6]=-r[6],e[7]=r[7],e}var cc=ci,Wh=cc,Qn=oi,Qh=Qn;function Kh(e,r){var t=Qn(r);if(t>0){t=Math.sqrt(t);var n=r[0]/t,a=r[1]/t,f=r[2]/t,o=r[3]/t,c=r[4],l=r[5],h=r[6],E=r[7],O=n*c+a*l+f*h+o*E;e[0]=n,e[1]=a,e[2]=f,e[3]=o,e[4]=(c-n*O)/t,e[5]=(l-a*O)/t,e[6]=(h-f*O)/t,e[7]=(E-o*O)/t}return e}function Zh(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function Jh(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]&&e[6]===r[6]&&e[7]===r[7]}function e1(e,r){var t=e[0],n=e[1],a=e[2],f=e[3],o=e[4],c=e[5],l=e[6],h=e[7],E=r[0],O=r[1],T=r[2],w=r[3],U=r[4],H=r[5],F=r[6],re=r[7];return Math.abs(t-E)<=Pe*Math.max(1,Math.abs(t),Math.abs(E))&&Math.abs(n-O)<=Pe*Math.max(1,Math.abs(n),Math.abs(O))&&Math.abs(a-T)<=Pe*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(f-w)<=Pe*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(o-U)<=Pe*Math.max(1,Math.abs(o),Math.abs(U))&&Math.abs(c-H)<=Pe*Math.max(1,Math.abs(c),Math.abs(H))&&Math.abs(l-F)<=Pe*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(h-re)<=Pe*Math.max(1,Math.abs(h),Math.abs(re))}var r1=Object.freeze(Object.defineProperty({__proto__:null,create:Th,clone:gh,fromValues:Ah,fromRotationTranslationValues:Sh,fromRotationTranslation:ac,fromTranslation:Mh,fromRotation:wh,fromMat4:Oh,copy:ic,identity:Rh,set:Lh,getReal:Ch,getDual:Ph,setReal:Fh,setDual:Gh,getTranslation:Dh,translate:Ih,rotateX:Nh,rotateY:$h,rotateZ:Bh,rotateByQuatAppend:kh,rotateByQuatPrepend:zh,rotateAroundAxis:Uh,add:jh,multiply:fc,mul:Vh,scale:Xh,dot:sc,lerp:qh,invert:Hh,conjugate:Yh,length:cc,len:Wh,squaredLength:Qn,sqrLen:Qh,normalize:Kh,str:Zh,exactEquals:Jh,equals:e1},Symbol.toStringTag,{value:"Module"}));function oc(){var e=new He(2);return He!=Float32Array&&(e[0]=0,e[1]=0),e}function t1(e){var r=new He(2);return r[0]=e[0],r[1]=e[1],r}function n1(e,r){var t=new He(2);return t[0]=e,t[1]=r,t}function a1(e,r){return e[0]=r[0],e[1]=r[1],e}function i1(e,r,t){return e[0]=r,e[1]=t,e}function f1(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e}function lc(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e}function uc(e,r,t){return e[0]=r[0]*t[0],e[1]=r[1]*t[1],e}function vc(e,r,t){return e[0]=r[0]/t[0],e[1]=r[1]/t[1],e}function s1(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e}function c1(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e}function o1(e,r,t){return e[0]=Math.min(r[0],t[0]),e[1]=Math.min(r[1],t[1]),e}function l1(e,r,t){return e[0]=Math.max(r[0],t[0]),e[1]=Math.max(r[1],t[1]),e}function u1(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e}function v1(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e}function d1(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e}function dc(e,r){var t=r[0]-e[0],n=r[1]-e[1];return Math.sqrt(t*t+n*n)}function hc(e,r){var t=r[0]-e[0],n=r[1]-e[1];return t*t+n*n}function mc(e){var r=e[0],t=e[1];return Math.sqrt(r*r+t*t)}function pc(e){var r=e[0],t=e[1];return r*r+t*t}function h1(e,r){return e[0]=-r[0],e[1]=-r[1],e}function m1(e,r){return e[0]=1/r[0],e[1]=1/r[1],e}function p1(e,r){var t=r[0],n=r[1],a=t*t+n*n;return a>0&&(a=1/Math.sqrt(a),e[0]=r[0]*a,e[1]=r[1]*a),e}function y1(e,r){return e[0]*r[0]+e[1]*r[1]}function b1(e,r,t){var n=r[0]*t[1]-r[1]*t[0];return e[0]=e[1]=0,e[2]=n,e}function _1(e,r,t,n){var a=r[0],f=r[1];return e[0]=a+n*(t[0]-a),e[1]=f+n*(t[1]-f),e}function E1(e,r){r=r||1;var t=$r()*2*Math.PI;return e[0]=Math.cos(t)*r,e[1]=Math.sin(t)*r,e}function x1(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[2]*a,e[1]=t[1]*n+t[3]*a,e}function T1(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[2]*a+t[4],e[1]=t[1]*n+t[3]*a+t[5],e}function g1(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[3]*a+t[6],e[1]=t[1]*n+t[4]*a+t[7],e}function A1(e,r,t){var n=r[0],a=r[1];return e[0]=t[0]*n+t[4]*a+t[12],e[1]=t[1]*n+t[5]*a+t[13],e}function S1(e,r,t,n){var a=r[0]-t[0],f=r[1]-t[1],o=Math.sin(n),c=Math.cos(n);return e[0]=a*c-f*o+t[0],e[1]=a*o+f*c+t[1],e}function M1(e,r){var t=e[0],n=e[1],a=r[0],f=r[1],o=t*t+n*n;o>0&&(o=1/Math.sqrt(o));var c=a*a+f*f;c>0&&(c=1/Math.sqrt(c));var l=(t*a+n*f)*o*c;return l>1?0:l<-1?Math.PI:Math.acos(l)}function w1(e){return"vec2("+e[0]+", "+e[1]+")"}function O1(e,r){return e[0]===r[0]&&e[1]===r[1]}function R1(e,r){var t=e[0],n=e[1],a=r[0],f=r[1];return Math.abs(t-a)<=Pe*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(n-f)<=Pe*Math.max(1,Math.abs(n),Math.abs(f))}var L1=mc,C1=lc,P1=uc,F1=vc,G1=dc,D1=hc,I1=pc,N1=function(){var e=oc();return function(r,t,n,a,f,o){var c=void 0,l=void 0;for(t||(t=2),n||(n=0),a?l=Math.min(a*t+n,r.length):l=r.length,c=n;c<l;c+=t)e[0]=r[c],e[1]=r[c+1],f(e,e,o),r[c]=e[0],r[c+1]=e[1];return r}}(),$1=Object.freeze(Object.defineProperty({__proto__:null,create:oc,clone:t1,fromValues:n1,copy:a1,set:i1,add:f1,subtract:lc,multiply:uc,divide:vc,ceil:s1,floor:c1,min:o1,max:l1,round:u1,scale:v1,scaleAndAdd:d1,distance:dc,squaredDistance:hc,length:mc,squaredLength:pc,negate:h1,inverse:m1,normalize:p1,dot:y1,cross:b1,lerp:_1,random:E1,transformMat2:x1,transformMat2d:T1,transformMat3:g1,transformMat4:A1,rotate:S1,angle:M1,str:w1,exactEquals:O1,equals:R1,len:L1,sub:C1,mul:P1,div:F1,dist:G1,sqrDist:D1,sqrLen:I1,forEach:N1},Symbol.toStringTag,{value:"Module"})),B1=Object.freeze(Object.defineProperty({__proto__:null,glMatrix:Nu,mat2:c0,mat2d:P0,mat3:cv,mat4:Qv,quat:xh,quat2:r1,vec2:$1,vec3:Cd,vec4:Zd},Symbol.toStringTag,{value:"Module"})),k1=Lu(B1),yc={exports:{}};(function(e){var r=function(){function t(l,h,E,O){typeof h=="object"&&(E=h.depth,O=h.prototype,h=h.circular);var T=[],w=[],U=typeof Buffer!="undefined";typeof h=="undefined"&&(h=!0),typeof E=="undefined"&&(E=1/0);function H(F,re){if(F===null)return null;if(re==0)return F;var Te,Se;if(typeof F!="object")return F;if(t.__isArray(F))Te=[];else if(t.__isRegExp(F))Te=new RegExp(F.source,c(F)),F.lastIndex&&(Te.lastIndex=F.lastIndex);else if(t.__isDate(F))Te=new Date(F.getTime());else{if(U&&Buffer.isBuffer(F))return Buffer.allocUnsafe?Te=Buffer.allocUnsafe(F.length):Te=new Buffer(F.length),F.copy(Te),Te;typeof O=="undefined"?(Se=Object.getPrototypeOf(F),Te=Object.create(Se)):(Te=Object.create(O),Se=O)}if(h){var Re=T.indexOf(F);if(Re!=-1)return w[Re];T.push(F),w.push(Te)}for(var Me in F){var Le;Se&&(Le=Object.getOwnPropertyDescriptor(Se,Me)),!(Le&&Le.set==null)&&(Te[Me]=H(F[Me],re-1))}return Te}return H(l,E)}t.clonePrototype=function(h){if(h===null)return null;var E=function(){};return E.prototype=h,new E};function n(l){return Object.prototype.toString.call(l)}t.__objToStr=n;function a(l){return typeof l=="object"&&n(l)==="[object Date]"}t.__isDate=a;function f(l){return typeof l=="object"&&n(l)==="[object Array]"}t.__isArray=f;function o(l){return typeof l=="object"&&n(l)==="[object RegExp]"}t.__isRegExp=o;function c(l){var h="";return l.global&&(h+="g"),l.ignoreCase&&(h+="i"),l.multiline&&(h+="m"),h}return t.__getRegExpFlags=c,t}();e.exports&&(e.exports=r)})(yc);var z1=yc.exports,U1=function(e,r){return e=e||{},Object.keys(r).forEach(function(t){typeof e[t]=="undefined"&&(e[t]=z1(r[t]))}),e};const an=k1.mat4,j1=U1;var V1=function(r,t={}){t=j1(t,{speed:.005,onRotate:function(){},drag:0,invert:!1,hideCursor:!1});const n=t.invert?-1:1,a=an.create();let f=!1,o=r.style.cursor;const c={x:0,y:0,dx:0,dy:0,down:!1};function l(F,re){const Te=an.create();an.rotateY(Te,Te,F*t.speed),an.rotateX(Te,Te,re*t.speed),an.multiply(a,Te,a),t.onRotate()}function h(F,re){c.dx=F,c.dy=re}function E(){f||(requestAnimationFrame(E),c.down&&(c.dx=0,c.dy=0),Math.abs(c.dx*t.speed)<1e-4&&Math.abs(c.dy*t.speed)<1e-4&&(c.dx=0,c.dy=0),!(c.dx===0&&c.dy===0)&&(c.dx-=c.dx*t.drag,c.dy-=c.dy*t.drag,l(c.dx,c.dy)))}E();function O(F){c.x=F.clientX,c.y=F.clientY,c.dx=0,c.dy=0,c.down=!0,r.setPointerCapture(F.pointerId),t.hideCursor&&(o=r.style.cursor,r.style.cursor="none"),F.preventDefault()}function T(){c.down=!1,r.style.cursor=o}function w(F){!c.down||(c.dx=n*(F.clientX-c.x),c.dy=n*(F.clientY-c.y),c.x=F.clientX,c.y=F.clientY,l(c.dx,c.dy))}function U(F){r.releasePointerCapture(F.pointerId)}r.addEventListener("pointerdown",O),r.addEventListener("pointerup",T),r.addEventListener("pointermove",w),r.addEventListener("pointercancel",U);function H(){r.removeEventListener("pointerdown",O),r.removeEventListener("pointerup",T),r.removeEventListener("pointermove",w),r.removeEventListener("pointercancel",U),f=!0}return{spin:h,rotation:a,dispose:H}},Ja=1e-6,os=typeof Float32Array!="undefined"?Float32Array:Array,ls=Math.random;Math.hypot||(Math.hypot=function(){for(var e=0,r=arguments.length;r--;)e+=arguments[r]*arguments[r];return Math.sqrt(e)});function X1(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function q1(e,r,t,n,a){var f=1/Math.tan(r/2),o;return e[0]=f/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,a!=null&&a!==1/0?(o=1/(n-a),e[10]=(a+n)*o,e[14]=2*a*n*o):(e[10]=-1,e[14]=-2*n),e}var H1=q1;function Y1(e,r,t,n){var a,f,o,c,l,h,E,O,T,w,U=r[0],H=r[1],F=r[2],re=n[0],Te=n[1],Se=n[2],Re=t[0],Me=t[1],Le=t[2];return Math.abs(U-Re)<Ja&&Math.abs(H-Me)<Ja&&Math.abs(F-Le)<Ja?X1(e):(E=U-Re,O=H-Me,T=F-Le,w=1/Math.hypot(E,O,T),E*=w,O*=w,T*=w,a=Te*T-Se*O,f=Se*E-re*T,o=re*O-Te*E,w=Math.hypot(a,f,o),w?(w=1/w,a*=w,f*=w,o*=w):(a=0,f=0,o=0),c=O*o-T*f,l=T*a-E*o,h=E*f-O*a,w=Math.hypot(c,l,h),w?(w=1/w,c*=w,l*=w,h*=w):(c=0,l=0,h=0),e[0]=a,e[1]=c,e[2]=E,e[3]=0,e[4]=f,e[5]=l,e[6]=O,e[7]=0,e[8]=o,e[9]=h,e[10]=T,e[11]=0,e[12]=-(a*U+f*H+o*F),e[13]=-(c*U+l*H+h*F),e[14]=-(E*U+O*H+T*F),e[15]=1,e)}function W1(){var e=new os(3);return os!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Q1(e){var r=e[0],t=e[1],n=e[2];return Math.hypot(r,t,n)}function ei(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e}function ri(e,r){r=r||1;var t=ls()*2*Math.PI,n=ls()*2-1,a=Math.sqrt(1-n*n)*r;return e[0]=Math.cos(t)*a,e[1]=Math.sin(t)*a,e[2]=n*r,e}(function(){var e=W1();return function(r,t,n,a,f,o){var c,l;for(t||(t=3),n||(n=0),a?l=Math.min(a*t+n,r.length):l=r.length,c=n;c<l;c+=t)e[0]=r[c],e[1]=r[c+1],e[2]=r[c+2],f(e,e,o),r[c]=e[0],r[c+1]=e[1],r[c+2]=e[2];return r}})();const K1=2e4,yt=1,ti=.03;async function Z1(){const e=[],r=[],t=[];let n=0;for(;n<K1;){const O=[Math.random()*2*yt-yt,Math.random()*2*yt-yt,Math.random()*2*yt-yt];if(Q1(O)>yt)continue;const T=ei([],O,ri([],ti)),w=ei([],O,ri([],ti)),U=ei([],O,ri([],ti)),H=Math.random(),F=Math.random(),re=Math.random()*.5+.5;e.push(T,w,U),r.push([H,F,re],[H,F,re],[H,F,re]),t.push([0,0,1],[0,1,0],[1,0,0]),n++}const a=Cu({extensions:["OES_element_index_uint"]}),f=a({vert:`
      precision highp float;
      attribute vec3 position, color, bary;
      uniform mat4 model, view, projection;
      varying vec3 vColor, vBary, vPos;
  
      void main() {
        gl_Position = projection * view * model * vec4(position, 1);
        vColor = color;
        vBary = bary;
        vPos = gl_Position.xyz;
      }
    `,frag:`
      precision highp float;
      varying vec3 vNormal, vColor, vBary, vPos;
  
      void main() {
        float b = pow(1.0 - min(vBary.x, min(vBary.y, vBary.z)), 4.0);
        gl_FragColor = vec4(0.5 * b * vColor, b);
      }
    `,attributes:{position:e,color:r,bary:t},uniforms:{model:a.prop("model"),view:a.prop("view"),projection:a.prop("projection")},viewport:a.prop("viewport"),count:e.length,blend:{enable:!0,func:{src:"one",dst:"one"}},depth:{enable:!1}}),o=document.getElementsByTagName("canvas")[0];var c=new V1(o,{onRotate:E,drag:0});c.spin(1,0);let l=!1,h=!1;o.addEventListener("mouseenter",()=>{l=!0}),o.addEventListener("mouseleave",()=>{l=!1});function E(){if(!l&&h)return;h=!0,a.clear({color:[0,0,0,1],depth:1});const O=Y1([],[0,0,3],[0,0,0],[0,1,0]),T=H1([],Math.PI/4,o.width/o.height,1,100),w={x:0,y:0,width:o.width,height:o.height};f({model:c.rotation,view:O,projection:T,viewport:w})}requestAnimationFrame(E)}Z1();
